# ç½‘ç»œä½“ç³»ç»“æ„

å¼ºçƒˆæ¨èé˜…è¯»ä¸¤ç¯‡æ–‡ç« ï¼š

- [ã€Šè®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„ç»¼è¿°ï¼ˆä¸Šï¼‰ã€‹](https://blog.csdn.net/justloveyou_/article/details/69611328)
- [ã€Šè®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„ç»¼è¿°ï¼ˆä¸‹ï¼‰ã€‹](https://blog.csdn.net/justloveyou_/article/details/69612153)

- **OSI ä¸ƒå±‚ä½“ç³»ç»“æ„**å…·æœ‰æ¦‚å¿µæ¸…æ¥šã€ç†è®ºå®Œæ•´çš„ç‰¹ç‚¹ï¼Œæ˜¯ä¸€ä¸ªç†è®ºä¸Šçš„å›½é™…æ ‡å‡†ï¼Œä½†å´ä¸æ˜¯äº‹å®ä¸Šçš„å›½é™…æ ‡å‡†ã€‚
- å…·æœ‰ç®€å•æ˜“ç”¨ç‰¹ç‚¹çš„ **TCP/IP å››å±‚ä½“ç³»ç»“æ„**åˆ™æ˜¯äº‹å®ä¸Šçš„æ ‡å‡†ã€‚

#### ç®€è¿° OSI ä¸ƒå±‚ä½“ç³»ç»“æ„

è‡ªä¸Šè€Œä¸‹æ˜¯ï¼š

- åº”ç”¨å±‚ï¼ˆæ•°æ®ï¼‰ï¼š
- è¡¨ç¤ºå±‚ï¼ˆæ•°æ®ï¼‰ï¼š
- ä¼šè¯å±‚ï¼ˆæ•°æ®ï¼‰ï¼š
- ä¼ è¾“å±‚ï¼ˆæ®µï¼‰ï¼š
- ç½‘ç»œå±‚ï¼ˆåŒ…ï¼‰ï¼š
- æ•°æ®é“¾è·¯å±‚ï¼ˆå¸§ï¼‰ï¼šå°†ä¸Šå±‚æ•°æ®å°è£…æˆå¸§ï¼Œç”¨MACåœ°å€è®¿é—®åª’ä»‹ï¼Œé”™è¯¯æ£€æµ‹ä¸ä¿®æ­£
- ç‰©ç†å±‚ï¼ˆæ¯”ç‰¹æµï¼‰ï¼š

#### ç®€è¿° TCP/IP å››å±‚ä½“ç³»ç»“æ„

è‡ªä¸Šè€Œä¸‹æ˜¯ï¼š

- åº”ç”¨å±‚ï¼š

  > HTTPã€TELNETã€FTPã€SMTP

- ä¼ è¾“å±‚

  > TCPã€UDP

- ç½‘ç»œå±‚

  > IPï¼ˆIPV4/IPV6ï¼‰ã€ARPåè®®ã€ICMPåè®®ï¼ˆPing/Tracerouteå‘½ä»¤ï¼‰

- æ•°æ®æ¥å£

  > PPP

#### çŸ¥é“å„ä¸ªå±‚ä½¿ç”¨çš„æ˜¯å“ªä¸ªæ•°æ®äº¤æ¢è®¾å¤‡ï¼Ÿ

- ç½‘å…³ï¼šåº”ç”¨å±‚ã€ä¼ è¾“å±‚ã€‚

- **ã€é‡ç‚¹ã€‘è·¯ç”±å™¨ï¼šç½‘ç»œå±‚**

  > è·¯ç”±é€‰æ‹©ã€å­˜å‚¨è½¬å‘

- **ã€é‡ç‚¹ã€‘äº¤æ¢æœºï¼šæ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚**

  > è¯†åˆ«æ•°æ®åŒ…ä¸­çš„ **MAC åœ°å€ä¿¡æ¯**ï¼Œæ ¹æ® MAC åœ°å€è¿›è¡Œè½¬å‘ï¼Œå¹¶å°†è¿™äº› **MAC åœ°å€ä¸å¯¹åº”çš„ç«¯å£è®°å½•åœ¨è‡ªå·±å†…éƒ¨çš„ä¸€ä¸ªåœ°å€è¡¨**ä¸­ã€‚

- ç½‘æ¡¥ï¼šæ•°æ®é“¾è·¯å±‚

  > å°†ä¸¤ä¸ª LAN è¿èµ·æ¥ï¼Œæ ¹æ® MAC åœ°å€æ¥è½¬å‘å¸§ã€‚

- é›†çº¿å™¨ï¼ˆHubï¼‰ï¼šç‰©ç†å±‚

  > çº¯ç¡¬ä»¶è®¾å¤‡ï¼Œä¸»è¦ç”¨æ¥è¿æ¥è®¡ç®—æœºç­‰ç½‘ç»œç»ˆç«¯ã€‚

- ä¸­ç»§å™¨ï¼šç‰©ç†å±‚

  > åœ¨æ¯”ç‰¹çº§åˆ«å¯¹ç½‘ç»œä¿¡å·è¿›è¡Œå†ç”Ÿå’Œé‡å®šæ—¶ï¼Œä»è€Œä½¿å¾—å®ƒä»¬èƒ½å¤Ÿåœ¨ç½‘ç»œä¸Šä¼ è¾“æ›´é•¿çš„è·ç¦»ã€‚

ğŸ¦… **äº¤æ¢æœºæ˜¯ä»€ä¹ˆï¼Ÿ**

ğŸ¦… **è·¯ç”±å™¨æ˜¯ä»€ä¹ˆï¼Ÿ**

ğŸ¦… **å¸¸è§çš„è·¯ç”±é€‰æ‹©åè®®ï¼Œä»¥åŠå®ƒä»¬çš„åŒºåˆ«ï¼Ÿ**

ğŸ¦… **ä»€ä¹ˆæ˜¯ç½‘å…³è®¾å¤‡ï¼Ÿ**

####  **è¯¦ç»†è¯´æ˜ Keepalived çš„æ•…éšœåˆ‡æ¢å·¥ä½œåŸç†ï¼Ÿ**

è¿™ç§æ•…éšœåˆ‡æ¢ï¼Œæ˜¯é€šè¿‡ **VRRP** åè®®æ¥å®ç°çš„ã€‚

- ä¸»èŠ‚ç‚¹ä¼šæŒ‰ä¸€å®šçš„æ—¶é—´é—´éš”å‘é€**å¿ƒè·³**ä¿¡æ¯çš„å¹¿æ’­åŒ…ï¼Œå‘Šè¯‰å¤‡èŠ‚ç‚¹è‡ªå·±çš„å­˜æ´»çŠ¶æ€ä¿¡æ¯ã€‚
- å½“ä¸»èŠ‚ç‚¹å‘ç”Ÿæ•…éšœæ—¶ï¼Œ**å¤‡èŠ‚ç‚¹**åœ¨ä¸€æ®µæ—¶é—´å†…å°±**æ”¶åˆ°å¹¿æ’­åŒ…**ï¼Œä»è€Œåˆ¤æ–­ä¸»èŠ‚ç‚¹å‡ºç°æ•…éšœï¼Œå› æ­¤ä¼šè°ƒç”¨è‡ªèº«çš„**æ¥ç®¡**ç¨‹åºæ¥æ¥ç®¡ä¸»èŠ‚ç‚¹çš„ IP èµ„æºåŠæœåŠ¡ã€‚
- å½“ä¸»èŠ‚ç‚¹**æ¢å¤**æ—¶ï¼Œå¤‡èŠ‚ç‚¹ä¼š**ä¸»åŠ¨é‡Šæ”¾èµ„æº**ï¼Œæ¢å¤åˆ°æ¥ç®¡å‰çš„çŠ¶æ€ï¼Œä»è€Œæ¥å®ç°ä¸»å¤‡æ•…éšœåˆ‡æ¢

ä¾‹å¦‚ï¼ŒMySQL åŸºäº Keepalived å®ç°é«˜å¯ç”¨ã€‚è¯¦ç»†çš„ï¼Œå¯ä»¥çœ‹çœ‹ [ã€ŠKeepalived + MySQLå®ç°é«˜å¯ç”¨ã€‹](https://www.cnblogs.com/gomysql/p/3856484.html) ã€‚

### IP

#### IP åœ°å€çš„åˆ†ç±»ï¼Ÿ

IP åœ°å€æ˜¯æŒ‡**äº’è”ç½‘åè®®åœ°å€**ï¼Œæ˜¯ IP åè®®æä¾›çš„ä¸€ç§ç»Ÿä¸€çš„åœ°å€æ ¼å¼ï¼Œå®ƒä¸ºäº’è”ç½‘ä¸Šçš„æ¯ä¸€ä¸ªç½‘ç»œå’Œæ¯ä¸€å°ä¸»æœºåˆ†é…ä¸€ä¸ª**é€»è¾‘åœ°å€**ï¼Œä»¥æ­¤æ¥**å±è”½ç‰©ç†åœ°å€çš„**å·®å¼‚ã€‚

ğŸ¦… **IP åœ°å€ä¸ç‰©ç†åœ°å€çš„åŒºåˆ«ï¼Ÿ**

- **ç‰©ç†åœ°å€(MAC åœ°å€)ï¼Œæ˜¯æ•°æ®é“¾è·¯å±‚å’Œç‰©ç†å±‚ä½¿ç”¨çš„åœ°å€**ã€‚
- IP åœ°å€æ˜¯**ç½‘ç»œå±‚**å’Œä»¥ä¸Šå„å±‚ä½¿ç”¨çš„åœ°å€ï¼Œæ˜¯ä¸€ç§**é€»è¾‘åœ°å€**ã€‚
- å…¶ä¸­ **ARP åè®®**ç”¨äº IP åœ°å€ä¸ç‰©ç†åœ°å€çš„å¯¹åº”ã€‚

è¯¦ç»†çš„ï¼Œå¯ä»¥çœ‹çœ‹ [ã€Šå³ç”Ÿç‘œï¼Œä½•ç”Ÿäº® â€”â€” MAC åœ°å€ä¸ IP åœ°å€ã€‹](http://blog.sciencenet.cn/blog-411071-1037673.html) æ–‡ç« ã€‚

### ç½‘ç»œå±‚çš„ ARP åè®®å·¥ä½œåŸç†ï¼Ÿ

**ç½‘ç»œå±‚**çš„ **ARP åè®®**å®Œæˆäº† **IP åœ°å€ä¸ç‰©ç†åœ°å€çš„æ˜ å°„**ã€‚

- é¦–å…ˆï¼Œ**æ¯å°ä¸»æœº**éƒ½ä¼šåœ¨è‡ªå·±çš„ ARP ç¼“å†²åŒºä¸­å»ºç«‹ä¸€ä¸ª **ARP åˆ—è¡¨**ï¼Œä»¥è¡¨ç¤º IP åœ°å€å’Œ MAC åœ°å€çš„å¯¹åº”å…³ç³»ã€‚
- å½“æºä¸»æœºéœ€è¦å°†ä¸€ä¸ªæ•°æ®åŒ…è¦**å‘é€**åˆ°ç›®çš„ä¸»æœºæ—¶ï¼Œä¼šé¦–å…ˆ**æ£€æŸ¥**è‡ªå·± **ARP åˆ—è¡¨**ä¸­æ˜¯å¦å­˜åœ¨è¯¥ IP åœ°å€**å¯¹åº”çš„ MAC åœ°å€**ï¼š
  - å¦‚æœ**æœ‰**ï¼Œå°±ç›´æ¥å°†æ•°æ®åŒ…**å‘é€**åˆ°è¿™ä¸ª **MAC åœ°å€**ã€‚
  - å¦‚æœ**æ²¡æœ‰**ï¼Œå°±å‘æœ¬åœ°ç½‘æ®µå‘èµ·ä¸€ä¸ª**ARPè¯·æ±‚çš„å¹¿æ’­åŒ…**ï¼ŒæŸ¥è¯¢æ­¤ç›®çš„ä¸»æœºå¯¹åº”çš„ MAC åœ°å€ã€‚æ­¤ ARP è¯·æ±‚æ•°æ®åŒ…é‡ŒåŒ…æ‹¬æºä¸»æœºçš„ IP åœ°å€ã€ç¡¬ä»¶åœ°å€ã€ä»¥åŠç›®çš„ä¸»æœºçš„ IP åœ°å€ã€‚**ç½‘ç»œä¸­æ‰€æœ‰çš„ä¸»æœº**æ”¶åˆ°è¿™ä¸ª ARP è¯·æ±‚åï¼Œ**ä¼šæ£€æŸ¥æ•°æ®åŒ…ä¸­çš„ç›®çš„ IP æ˜¯å¦å’Œè‡ªå·±çš„ IPåœ°å€ä¸€è‡´ã€‚**
    - å¦‚æœä¸ç›¸åŒï¼Œå°±å¿½ç•¥æ­¤æ•°æ®åŒ…ã€‚
    - å¦‚æœç›¸åŒï¼Œè¯¥ä¸»æœºé¦–å…ˆå°†å‘é€ç«¯çš„ MAC åœ°å€å’Œ IP åœ°å€æ·»åŠ åˆ°è‡ªå·±çš„ ARP åˆ—è¡¨ä¸­(å¦‚æœ ARP è¡¨ä¸­å·²ç»å­˜åœ¨è¯¥ IP çš„ä¿¡æ¯ï¼Œåˆ™å°†å…¶è¦†ç›–)ï¼Œç„¶åç»™æºä¸»æœºå‘é€ä¸€ä¸ª ARP å“åº”æ•°æ®åŒ…ï¼Œå‘Šè¯‰å¯¹æ–¹è‡ªå·±æ˜¯å®ƒéœ€è¦æŸ¥æ‰¾çš„ MAC åœ°å€ã€‚
      - æºä¸»æœºæ”¶åˆ°è¿™ä¸ª ARP å“åº”æ•°æ®åŒ…åï¼Œå°†å¾—åˆ°çš„ç›®çš„ä¸»æœºçš„ IP åœ°å€å’Œ MAC åœ°å€æ·»åŠ åˆ°è‡ªå·±çš„ ARP åˆ—è¡¨ä¸­ï¼Œå¹¶åˆ©ç”¨æ­¤ä¿¡æ¯å¼€å§‹æ•°æ®çš„ä¼ è¾“ã€‚
      - å¦‚æœæºä¸»æœºä¸€ç›´æ²¡æœ‰æ”¶åˆ° ARP å“åº”æ•°æ®åŒ…ï¼Œè¡¨ç¤º ARP æŸ¥è¯¢å¤±è´¥ã€‚

> æ³¨æ„ï¼Œåœ¨ OSI æ¨¡å‹ä¸­ ARP åè®®å±äºé“¾è·¯å±‚ï¼›è€Œåœ¨ TCP/IP æ¨¡å‹ä¸­ï¼ŒARP åè®®å±äºç½‘ç»œå±‚ã€‚

### å¦‚ä½•åˆ’åˆ†å­ç½‘ã€è¶…ç½‘ï¼Ÿ

ğŸ¦… **ä»€ä¹ˆæ˜¯å­ç½‘ï¼Œå¦‚ä½•åˆ’åˆ†å­ç½‘ï¼Ÿ**

ğŸ¦… **è¶…ç½‘å¹²ä»€ä¹ˆçš„ï¼Ÿå¦‚ä½•åˆ’åˆ†è¶…ç½‘ï¼Ÿ**

ğŸ¦… **å­ç½‘æ©ç çš„ä½œç”¨ï¼Ÿ**

å­ç½‘æ©ç åªæœ‰ä¸€ä¸ªä½œç”¨ï¼Œå°±æ˜¯**å°†æŸä¸ª IP åœ°å€**åˆ’åˆ†æˆ**ç½‘ç»œåœ°å€**å’Œ**ä¸»æœºåœ°å€**ä¸¤éƒ¨åˆ†ã€‚

ç”¨äºå­ç½‘æ©ç çš„ä½æ•°ï¼Œå†³å®šäºå¯èƒ½çš„å­ç½‘æ•°ç›®å’Œæ¯ä¸ªå­ç½‘çš„ä¸»æœºæ•°ç›®ã€‚

## ä»€ä¹ˆæ˜¯å•æ’­ã€ç»„æ’­(å¤šæ’­)ã€å¹¿æ’­ã€ä»»æ’­ï¼Ÿ

- **å•æ’­**(unicast): æ˜¯æŒ‡å°åŒ…åœ¨è®¡ç®—æœºç½‘ç»œçš„ä¼ è¾“ä¸­ï¼Œç›®çš„åœ°å€ä¸º**å•ä¸€ç›®æ ‡çš„ä¸€ç§**ä¼ è¾“æ–¹å¼ã€‚å®ƒæ˜¯ç°ä»Šç½‘ç»œåº”ç”¨æœ€ä¸ºå¹¿æ³›ï¼Œé€šå¸¸æ‰€ä½¿ç”¨çš„ç½‘ç»œåè®®æˆ–æœåŠ¡å¤§å¤šé‡‡ç”¨å•æ’­ä¼ è¾“ï¼Œä¾‹å¦‚**ä¸€åˆ‡åŸºäºTCPçš„åè®®**ã€‚
- **ç»„æ’­**(multicast): ä¹Ÿå«å¤šæ’­ï¼Œ å¤šç‚¹å¹¿æ’­æˆ–ç¾¤æ’­ã€‚ æŒ‡æŠŠä¿¡æ¯åŒæ—¶ä¼ é€’ç»™ä¸€ç»„ç›®çš„åœ°å€ã€‚å®ƒä½¿ç”¨ç­–ç•¥æ˜¯æœ€é«˜æ•ˆçš„ï¼Œå› ä¸ºæ¶ˆæ¯åœ¨æ¯æ¡ç½‘ç»œé“¾è·¯ä¸Šåªéœ€ä¼ é€’ä¸€æ¬¡ï¼Œè€Œä¸”åªæœ‰åœ¨é“¾è·¯åˆ†å‰çš„æ—¶å€™ï¼Œæ¶ˆæ¯æ‰ä¼šè¢«å¤åˆ¶ã€‚
- **å¹¿æ’­**(broadcast):æ˜¯æŒ‡å°åŒ…åœ¨è®¡ç®—æœºç½‘ç»œä¸­ä¼ è¾“æ—¶ï¼Œç›®çš„åœ°å€ä¸ºç½‘ç»œä¸­æ‰€æœ‰è®¾å¤‡çš„ä¸€ç§ä¼ è¾“æ–¹å¼ã€‚å®é™…ä¸Šï¼Œè¿™é‡Œæ‰€è¯´çš„â€œæ‰€æœ‰è®¾å¤‡â€ä¹Ÿæ˜¯é™å®šåœ¨ä¸€ä¸ªèŒƒå›´ä¹‹ä¸­ï¼Œç§°ä¸ºâ€œå¹¿æ’­åŸŸâ€ã€‚
- **ä»»æ’­**(anycast):æ˜¯ä¸€ç§ç½‘ç»œå¯»å€å’Œè·¯ç”±çš„ç­–ç•¥ï¼Œä½¿å¾—èµ„æ–™å¯ä»¥æ ¹æ®è·¯ç”±æ‹“æœ´æ¥å†³å®šé€åˆ°â€œæœ€è¿‘â€æˆ–â€œæœ€å¥½â€çš„ç›®çš„åœ°ã€‚

æ„Ÿå…´è¶£çš„èƒ–å‹ï¼Œå¯ä»¥è¯¦ç»†çœ‹ [ã€Šå•æ’­ï¼Œç»„æ’­(å¤šæ’­)ï¼Œå¹¿æ’­ä»¥åŠä»»æ’­ã€‹](https://colobu.com/2014/10/21/udp-and-unicast-multicast-broadcast-anycast/) æ–‡ç« ã€‚

## åŒºåˆ« IPv4 å’Œ IPv6 ï¼Ÿ

**IPåœ°å€ç¼–å€æ ‡å‡†**

- æˆ‘ä»¬å¤§å¤šæ•°äººä½¿ç”¨çš„æ˜¯**ç¬¬äºŒä»£äº’è”ç½‘ IPv4 æŠ€æœ¯ï¼Œåœ°å€é•¿åº¦32ä½**ï¼Œå®ƒçš„æœ€å¤§é—®é¢˜æ˜¯**ç½‘ç»œåœ°å€èµ„**æºæœ‰é™ï¼Œä»**ç†è®º**ä¸Šè®²èƒ½ç¼–å€ 1600 ä¸‡ä¸ªç½‘ç»œã€é“¾æ¥ 40 äº¿å°ä¸»æœºã€‚è€Œæ ¹æ®ç›¸å…³æ•°æ®ï¼Œå…¨çƒ IPv4 çš„ IP åœ°å€å·²ç»**å³å°†ç”¨å®Œ**ã€‚
- è€Œ IPv6 æ˜¯ä½œä¸º IETF è®¾è®¡çš„ç”¨äº**æ›¿ä»£**ç°è¡Œç‰ˆæœ¬ IP åè®®(IPv4)çš„ä¸‹ä¸€ä»£ IP åè®®ï¼Œå…¶ IPV6 **åœ°å€é•¿åº¦ä¸º 128ä½**ï¼Œåœ°å€ç©ºé—´å¢å¤§äº† 2^98 æ¬¡æ–¹å€ï¼Œå‡ ä¹å¯ä»¥è¯´æ˜¯ç”¨ä¹‹ä¸ç«­çš„ã€‚æ‰€ä»¥éšç€ IPv4 ä¸è¶³ï¼Œæ”¯æŒ IPv6 çš„ç½‘ç»œåŠ¿å¿…ä¼šå¢é•¿ã€‚

# ICMP

## ICMP åè®®çš„ä¸»è¦åŠŸèƒ½ï¼Ÿ

ç”¨äºåœ¨ **IP ä¸»æœºã€è·¯ç”±å™¨ä¹‹é—´ä¼ é€’æ§åˆ¶æ¶ˆæ¯**ã€‚

## ç®€è¿°ä¸€ä¸‹ ping çš„åŸç†ï¼Ÿ

ä¸€èˆ¬åœ¨ç½‘ç»œä¸é€šçš„æ—¶å€™ï¼Œå¤§å®¶ä¼šç”¨ ping æµ‹ä¸€ä¸‹ç½‘ç»œæ˜¯å¦é€šç•…ã€‚

**ping æ˜¯åŸºäº ICMP åè®®å·¥ä½œçš„**ã€‚ICMP å…¨ç§° Internet Control Message Protocol ï¼Œå°±æ˜¯äº’è”ç½‘**æ§åˆ¶**æŠ¥æ–‡åè®®ã€‚

## ä»€ä¹ˆæ˜¯ Traceroute ï¼Ÿ

> Traceroute æ˜¯æ„å»ºåœ¨ ICMP åè®®ä¹‹ä¸Šçš„åº”ç”¨ã€‚

Traceroute ï¼Œæ˜¯ç”¨æ¥ä¾¦æµ‹ä¸»æœºåˆ°ç›®çš„ä¸»æœºä¹‹é—´æ‰€ç»è·¯ç”±æƒ…å†µçš„é‡è¦å·¥å…·ï¼Œä¹Ÿæ˜¯æœ€ä¾¿åˆ©çš„å·¥å…·ã€‚



Traceroute çš„**åŸç†**ï¼štraceroute å‘é€çš„æ˜¯ç«¯å£å· >30000çš„ UDP åŒ…ï¼Œç»™ç›®æ ‡æ³¨è§£ TTL=1ï¼Œè·¯ç”±å™¨TTL å‡1ï¼Œç›´åˆ°0ï¼Œè·¯ç”±å™¨è¿”å›ä¸å¯è¾¾ï¼Œä¸»æœºTTLåŠ 1,å†å‘ã€‚ç›®çš„ä¸»æœºå‘é€çš„æ˜¯ç«¯å£ä¸å¯è¾¾

# TCP

## TCP æ˜¯ä»€ä¹ˆï¼Ÿ

TCP(Transmission Control Protocol)ï¼Œä¼ è¾“æ§åˆ¶åè®®ï¼Œæ˜¯ä¸€ç§é¢å‘**è¿æ¥**çš„ã€**å¯é **çš„ã€åŸºäº**å­—èŠ‚æµ**çš„**ä¼ è¾“å±‚é€šä¿¡åè®®**ã€‚ä¸»è¦ç‰¹ç‚¹å¦‚ä¸‹ï¼š

- TCP æ˜¯é¢å‘**è¿æ¥**çš„ã€‚

  > å°±å¥½åƒæ‰“ç”µè¯ä¸€æ ·ï¼Œé€šè¯å‰éœ€è¦å…ˆæ‹¨å·å»ºç«‹è¿æ¥ï¼Œé€šè¯ç»“æŸåè¦æŒ‚æœºé‡Šæ”¾è¿æ¥

- æ¯ä¸€æ¡ TCP è¿æ¥åªèƒ½æœ‰ä¸¤ä¸ªç«¯ç‚¹ï¼Œæ¯ä¸€æ¡TCPè¿æ¥åªèƒ½æ˜¯**ç‚¹å¯¹ç‚¹**çš„ï¼ˆä¸€å¯¹ä¸€ï¼‰ã€‚

- TCP æä¾›**å¯é **äº¤ä»˜çš„æœåŠ¡ã€‚é€šè¿‡TCPè¿æ¥ä¼ é€çš„æ•°æ®ï¼Œ**æ— å·®é”™ã€ä¸ä¸¢å¤±ã€ä¸é‡å¤ã€å¹¶ä¸”æŒ‰åºåˆ°è¾¾**ã€‚

- TCP æä¾›å…¨**åŒå·¥é€šä¿¡**ã€‚TCP å…è®¸é€šä¿¡åŒæ–¹çš„åº”ç”¨è¿›ç¨‹åœ¨**ä»»ä½•æ—¶å€™éƒ½èƒ½å‘é€æ•°æ®**ã€‚TCP è¿æ¥çš„ä¸¤ç«¯éƒ½è®¾æœ‰**å‘é€ç¼“å­˜å’Œæ¥æ”¶ç¼“å­˜**ï¼Œç”¨æ¥ä¸´æ—¶å­˜æ”¾åŒæ–¹é€šä¿¡çš„æ•°æ®ã€‚

- é¢å‘**å­—èŠ‚æµ**ã€‚

  > TCP ä¸­çš„â€œæµâ€ï¼ˆStreamï¼‰ï¼ŒæŒ‡çš„æ˜¯æµå…¥è¿›ç¨‹æˆ–ä»è¿›ç¨‹æµå‡ºçš„å­—èŠ‚åºåˆ—ã€‚
  >
  > â€œé¢å‘å­—èŠ‚æµâ€çš„å«ä¹‰æ˜¯ï¼š**è™½ç„¶åº”ç”¨ç¨‹åºå’Œ TCP çš„äº¤äº’æ˜¯ä¸€æ¬¡ä¸€ä¸ªæ•°æ®å—**ï¼ˆå¤§å°ä¸ç­‰ï¼‰ï¼Œä½† TCP æŠŠåº”ç”¨ç¨‹åºäº¤ä¸‹æ¥çš„æ•°æ®ä»…ä»…çœ‹æˆæ˜¯**ä¸€è¿ä¸²çš„æ— ç»“æ„çš„å­—èŠ‚æµ**ã€‚

## TCP å¯¹åº”çš„åº”ç”¨å±‚åè®®ï¼Ÿ

- **FTP** ï¼šå®šä¹‰äº†**æ–‡ä»¶ä¼ è¾“åè®®**ï¼Œä½¿ç”¨ **21 ç«¯å£**ã€‚å¸¸è¯´æŸæŸè®¡ç®—æœºå¼€äº† FTP æœåŠ¡ä¾¿æ˜¯å¯åŠ¨äº†æ–‡ä»¶ä¼ è¾“æœåŠ¡ã€‚ä¸‹è½½æ–‡ä»¶ï¼Œä¸Šä¼ ä¸»é¡µï¼Œéƒ½è¦ç”¨åˆ° FTP æœåŠ¡ã€‚
- **Telnet** ï¼šå®ƒæ˜¯ä¸€ç§**ç”¨äºè¿œç¨‹ç™»é™†çš„ç«¯å£**ï¼Œç”¨æˆ·å¯ä»¥ä»¥è‡ªå·±çš„èº«ä»½è¿œç¨‹è¿æ¥åˆ°è®¡ç®—æœºä¸Šï¼Œé€šè¿‡è¿™ç§ç«¯å£å¯ä»¥æä¾›ä¸€ç§åŸºäº DOS æ¨¡å¼ä¸‹çš„é€šä¿¡æœåŠ¡ã€‚å¦‚ä»¥å‰çš„ BBS æ˜¯çº¯å­—ç¬¦ç•Œé¢çš„ï¼Œæ”¯æŒ BBS çš„æœåŠ¡å™¨å°† **23 ç«¯å£**æ‰“å¼€ï¼Œå¯¹å¤–æä¾›æœåŠ¡ã€‚
- **é‚®ç®±**
  - SMTP ï¼šå®šä¹‰äº†ç®€å•é‚®ä»¶ä¼ é€åè®®ï¼Œç°åœ¨å¾ˆå¤šé‚®ä»¶æœåŠ¡å™¨éƒ½ç”¨çš„æ˜¯è¿™ä¸ªåè®®ï¼Œç”¨äºå‘é€é‚®ä»¶ã€‚å¦‚å¸¸è§çš„å…è´¹é‚®ä»¶æœåŠ¡ä¸­ç”¨çš„å°±æ˜¯è¿™ä¸ªé‚®ä»¶æœåŠ¡ç«¯å£ï¼Œæ‰€ä»¥åœ¨ç”µå­é‚®ä»¶è®¾ç½®-ä¸­å¸¸çœ‹åˆ°æœ‰è¿™ä¹ˆ SMTP ç«¯å£è®¾ç½®è¿™ä¸ªæ ï¼ŒæœåŠ¡å™¨å¼€æ”¾çš„æ˜¯ 25 å·ç«¯å£ã€‚
  - POP3 ï¼šå®ƒæ˜¯å’Œ SMTP å¯¹åº”ï¼ŒPOP3 ç”¨äºæ¥æ”¶é‚®ä»¶ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼ŒPOP3 åè®®æ‰€ç”¨çš„æ˜¯ 110 ç«¯å£ã€‚ä¹Ÿæ˜¯è¯´ï¼Œåªè¦ä½ æœ‰ç›¸åº”çš„ä½¿ç”¨ POP3 åè®®çš„ç¨‹åºï¼ˆä¾‹å¦‚ Foxmail æˆ– Outlookï¼‰ï¼Œå°±å¯ä»¥ä¸ä»¥ Web æ–¹å¼ç™»é™†è¿›é‚®ç®±ç•Œé¢ï¼Œç›´æ¥ç”¨é‚®ä»¶ç¨‹åºå°±å¯ä»¥æ”¶åˆ°é‚®ä»¶ï¼ˆå¦‚æ˜¯ 163 é‚®ç®±å°±æ²¡æœ‰å¿…è¦å…ˆè¿›å…¥ç½‘æ˜“ç½‘ç«™ï¼Œå†è¿›å…¥è‡ªå·±çš„é‚®ç®±æ¥æ”¶ä¿¡ï¼‰ã€‚
- HTTP ï¼šä» Web æœåŠ¡å™¨ä¼ è¾“è¶…æ–‡æœ¬åˆ°æœ¬åœ°æµè§ˆå™¨çš„ä¼ é€åè®®ã€‚

## TCP å¤´éƒ¨æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ

- [ã€Šé€šä¿—å¤§ç™½è¯æ¥ç†è§£ TCP åè®®çš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡åˆ†æ‰‹ã€‹](https://github.com/jawil/blog/issues/14) çš„ [ã€ŒTCPå¤´éƒ¨ã€](http://svip.iocoder.cn/Net/Interview/#) å°èŠ‚ã€‚
- [ã€ŠTCP åè®®çš„å­¦ä¹  ï¼ˆäºŒï¼‰TCP å¤´éƒ¨ä¿¡æ¯ã€‹](https://blog.csdn.net/qq_34501940/article/details/51073691)

![img](https://camo.githubusercontent.com/137a789143b6c6d8af61e62930b9eda514c10ad1/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f323434383735322d613636353239636164633332343032302e6a70673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430)

ä¸Šé¢å°±æ˜¯**TCPåè®®å¤´éƒ¨**çš„æ ¼å¼ï¼Œç”±äºå®ƒå¤ªé‡è¦äº†ï¼Œæ˜¯ç†è§£å…¶å®ƒå†…å®¹çš„åŸºç¡€ï¼Œä¸‹é¢å°±å°†æ¯ä¸ªå­—æ®µçš„ä¿¡æ¯éƒ½è¯¦ç»†çš„è¯´æ˜ä¸€ä¸‹ã€‚

- **æºç«¯å£å·**ï¼ˆSource Portï¼‰å’Œ**ç›®çš„ç«¯å£å·**ï¼ˆDestination Portï¼‰:åˆ†åˆ«å ç”¨16ä½ï¼Œè¡¨ç¤ºæºç«¯å£å·å’Œç›®çš„ç«¯å£å·ï¼›ç”¨äº**åŒºåˆ«ä¸»æœºä¸­çš„ä¸åŒè¿›ç¨‹**ï¼Œè€Œ**IPåœ°å€**æ˜¯ç”¨æ¥**åŒºåˆ†**ä¸åŒçš„**ä¸»æœº**çš„ï¼Œæºç«¯å£å·å’Œç›®çš„ç«¯å£å·é…åˆä¸ŠIPé¦–éƒ¨ä¸­çš„æºIPåœ°å€å’Œç›®çš„IPåœ°å€å°±èƒ½å”¯ä¸€çš„ç¡®å®šä¸€ä¸ªTCPè¿æ¥ï¼›
- **åºå·**ï¼ˆSequence Numberï¼‰:ç”¨æ¥æ ‡è¯†ä»TCPå‘ç«¯å‘TCPæ”¶ç«¯å‘é€çš„æ•°æ®å­—èŠ‚æµï¼Œå®ƒ**è¡¨ç¤ºæœ¬æŠ¥æ–‡æ®µä¸­çš„çš„ç¬¬ä¸€ä¸ªæ•°æ®å­—èŠ‚åœ¨æ•°æ®æµä¸­çš„åºå·**ï¼›ä¸»è¦ç”¨æ¥**è§£å†³ç½‘ç»œæŠ¥ä¹±åº**çš„é—®é¢˜ï¼›
  - é¢å‘å­—èŠ‚æµçš„ï¼Œæ¯ä¸ªå­—èŠ‚éƒ½æŒ‰åºå·ç¼–å·ã€‚åºå·301ï¼Œä¼ äº†100å­—èŠ‚ï¼Œæœ¬æ¬¡ä¼ é€çš„æ˜¯301-400
- **ç¡®è®¤å·**ï¼ˆAcknowledgment Numberï¼‰:32ä½ç¡®è®¤åºåˆ—å·åŒ…å«**å‘é€ç¡®è®¤çš„ä¸€ç«¯æ‰€æœŸæœ›æ”¶åˆ°çš„ä¸‹ä¸€ä¸ªåºå·**ï¼Œå› æ­¤ï¼Œç¡®è®¤åºå·åº”å½“æ˜¯ä¸Šæ¬¡å·²æˆåŠŸæ”¶åˆ°æ•°æ®**å­—èŠ‚åºå·åŠ 1**ã€‚ä¸è¿‡ï¼Œåªæœ‰å½“æ ‡å¿—ä½ä¸­çš„ACKæ ‡å¿—ï¼ˆä¸‹é¢ä»‹ç»ï¼‰ä¸º1æ—¶è¯¥ç¡®è®¤åºåˆ—å·çš„å­—æ®µæ‰æœ‰æ•ˆã€‚ä¸»è¦ç”¨æ¥**è§£å†³ä¸ä¸¢åŒ…**çš„é—®é¢˜ï¼›
- **æ•°æ®åç§»Offset**:**ç»™å‡ºé¦–éƒ¨ä¸­32 bitå­—çš„æ•°ç›®ï¼Œéœ€è¦è¿™ä¸ªå€¼æ˜¯å› ä¸ºä»»é€‰å­—æ®µçš„é•¿åº¦æ˜¯å¯å˜çš„**ã€‚è¿™ä¸ªå­—æ®µå 4bitï¼ˆæœ€å¤šèƒ½è¡¨ç¤º15ä¸ª32bitçš„çš„å­—ï¼Œå³4*15=60ä¸ªå­—èŠ‚çš„é¦–éƒ¨é•¿åº¦ï¼‰ï¼Œå› æ­¤TCPæœ€å¤šæœ‰60å­—èŠ‚çš„é¦–éƒ¨ã€‚ç„¶è€Œï¼Œæ²¡æœ‰ä»»é€‰å­—æ®µï¼Œæ­£å¸¸çš„é•¿åº¦æ˜¯20å­—èŠ‚ï¼›
- **æ ‡å¿—ä½ï¼ˆTCP Flagsï¼‰**:TCPé¦–éƒ¨ä¸­æœ‰**6ä¸ªæ ‡å¿—æ¯”ç‰¹**ï¼Œå®ƒä»¬ä¸­çš„**å¤šä¸ªå¯åŒæ—¶è¢«è®¾ç½®ä¸º1**ï¼Œä¸»è¦æ˜¯ç”¨äºæ“æ§TCPçš„çŠ¶æ€æœºçš„ï¼Œä¾æ¬¡ä¸ºURGï¼ŒACKï¼ŒPSHï¼ŒRSTï¼ŒSYNï¼ŒFINã€‚æ¯ä¸ªæ ‡å¿—ä½çš„æ„æ€å¦‚ä¸‹ï¼š

> **URG**ï¼šæ­¤æ ‡å¿—è¡¨ç¤ºTCPåŒ…çš„**ç´§æ€¥æŒ‡é’ˆåŸŸæœ‰æ•ˆ**ï¼Œç”¨æ¥**ä¿è¯TCPè¿æ¥ä¸è¢«ä¸­æ–­**ï¼Œå¹¶ä¸”ç£ä¿ƒä¸­é—´å±‚è®¾å¤‡è¦å°½å¿«å¤„ç†è¿™äº›æ•°æ®ï¼›
>
> **ACK**ï¼šæ­¤æ ‡å¿—è¡¨ç¤º**åº”ç­”åŸŸæœ‰æ•ˆ**ï¼Œå°±æ˜¯è¯´å‰é¢æ‰€è¯´çš„TCPåº”ç­”å·å°†ä¼šåŒ…å«åœ¨TCPæ•°æ®åŒ…ä¸­ï¼›æœ‰ä¸¤ä¸ªå–å€¼ï¼š0å’Œ1ï¼Œä¸º1çš„æ—¶å€™è¡¨ç¤ºåº”ç­”åŸŸæœ‰æ•ˆï¼Œåä¹‹ä¸º0ï¼›
>
> - **TCPåè®®è§„å®šï¼Œåªæœ‰ACK=1æ—¶æœ‰æ•ˆï¼Œä¹Ÿè§„å®šè¿æ¥å»ºç«‹åæ‰€æœ‰å‘é€çš„æŠ¥æ–‡çš„ACKå¿…é¡»ä¸º1**
>
> **PSH**ï¼šè¿™ä¸ªæ ‡å¿—ä½**è¡¨ç¤ºPushæ“ä½œ**ã€‚æ‰€è°“Pushæ“ä½œå°±æ˜¯æŒ‡åœ¨æ•°æ®åŒ…åˆ°è¾¾æ¥æ”¶ç«¯ä»¥åï¼Œ**ç«‹å³ä¼ é€**ç»™åº”ç”¨ç¨‹åºï¼Œè€Œ**ä¸æ˜¯åœ¨ç¼“å†²åŒºä¸­æ’é˜Ÿ**ï¼›
>
> **RST**ï¼šè¿™ä¸ªæ ‡å¿—è¡¨ç¤º**è¿æ¥å¤ä½è¯·æ±‚**ã€‚ç”¨æ¥*å¤ä½é‚£äº›äº§ç”Ÿé”™è¯¯çš„è¿æ¥ï¼Œä¹Ÿè¢«ç”¨æ¥æ‹’ç»é”™è¯¯å’Œéæ³•çš„æ•°æ®åŒ…*ï¼›
>
> **SYN**ï¼š**è¡¨ç¤ºåŒæ­¥åºå·ï¼Œç”¨æ¥å»ºç«‹è¿æ¥**ã€‚SYNæ ‡å¿—ä½å’ŒACKæ ‡å¿—ä½æ­é…ä½¿ç”¨ï¼Œ
>
> - å½“**è¯·æ±‚**è¿æ¥çš„æ—¶å€™**å‘é€**ï¼Œ`SYN=1ï¼ŒACK=0`çš„å‘é€æŠ¥æ–‡ï¼›
> - å½“**åŒæ„**è¿æ¥çš„æ—¶å€™**å›å¤**ï¼Œ`SYN=1ï¼ŒACK=1`çš„æ¥æ”¶æŠ¥æ–‡ï¼›
>
> - è¿™ä¸ªæ ‡å¿—çš„æ•°æ®åŒ…ç»å¸¸è¢«ç”¨æ¥è¿›è¡Œç«¯å£æ‰«æã€‚*æ‰«æè€…å‘é€ä¸€ä¸ªåªæœ‰SYNçš„æ•°æ®åŒ…ï¼Œå¦‚æœå¯¹æ–¹ä¸»æœºå“åº”äº†ä¸€ä¸ªæ•°æ®åŒ…å›æ¥ ï¼Œå°±è¡¨æ˜è¿™å°ä¸»æœºå­˜åœ¨è¿™ä¸ªç«¯å£*ï¼›ä½†æ˜¯ç”±äºè¿™ç§æ‰«ææ–¹å¼åªæ˜¯è¿›è¡ŒTCPä¸‰æ¬¡æ¡æ‰‹çš„ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼Œå› æ­¤è¿™ç§æ‰«*æçš„æˆåŠŸè¡¨ç¤ºè¢«æ‰«æçš„æœºå™¨ä¸å¾ˆå®‰å…¨*ï¼Œ*ä¸€å°å®‰å…¨çš„ä¸»æœºå°†ä¼šå¼ºåˆ¶è¦æ±‚ä¸€ä¸ªè¿æ¥ä¸¥æ ¼çš„è¿›è¡ŒTCPçš„ä¸‰æ¬¡æ¡æ‰‹*ï¼›
>
> **FIN**ï¼š **è¡¨ç¤ºå‘é€ç«¯å·²ç»è¾¾åˆ°æ•°æ®æœ«å°¾**ï¼Œä¹Ÿå°±æ˜¯è¯´**åŒæ–¹çš„æ•°æ®ä¼ é€å®Œæˆ**ï¼Œæ²¡æœ‰æ•°æ®å¯ä»¥ä¼ é€äº†ï¼Œå‘é€FINæ ‡å¿—ä½çš„TCPæ•°æ®åŒ…åï¼Œè¿æ¥å°†è¢«æ–­å¼€ã€‚è¿™ä¸ªæ ‡å¿—çš„æ•°æ®åŒ…ä¹Ÿ*ç»å¸¸è¢«ç”¨äºè¿›è¡Œç«¯å£æ‰«æã€‚*

- **Window**:çª—å£å¤§å°ï¼Œä¹Ÿå°±æ˜¯æœ‰åçš„**æ»‘åŠ¨çª—å£ï¼Œç”¨æ¥è¿›è¡Œæµé‡æ§åˆ¶**ï¼›

##  TCPä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ



[![TCP ä¸‰æ¬¡æ¡æ‰‹çš„å¹²è´§](http://static2.iocoder.cn/04edb57536fc9bbd3ea096cafa5d3630)](http://static2.iocoder.cn/04edb57536fc9bbd3ea096cafa5d3630)TCP ä¸‰æ¬¡æ¡æ‰‹çš„å¹²è´§

- ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼š

  - å‘é€æ•°æ®åŒ…ï¼šæ ‡å¿—ä½ï¼ˆ`SYN=1ï¼ŒACK=0`ï¼‰ï¼Œåºå·ï¼ˆ`seq=éšæœºå€¼J`ï¼‰
  - å®¢æˆ·ç«¯è¿›å…¥SYN_SENTçŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡ç«¯ç¡®è®¤ã€‚

- ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼š

  - æœåŠ¡ç«¯æ”¶åˆ°æ ‡å¿—ä½ï¼ˆ`SYN=1ï¼ŒACK=0`ï¼‰çš„æ•°æ®åŒ…ï¼ŒçŸ¥é“è¿™æ˜¯ä¸€ä¸ªè¯·æ±‚è¿æ¥çš„æŠ¥æ–‡
  - è¿”å›æ•°æ®åŒ…ï¼šæ ‡å¿—ä½ï¼ˆ`SYN=1ï¼ŒACK=1`ï¼‰ï¼Œç¡®è®¤å·ï¼ˆ`ack=J+1`ï¼‰ï¼Œåºå·ï¼ˆ`seq=éšæœºK`ï¼‰
  - Server è¿›å…¥ `SYN_RCVD` çŠ¶æ€

- ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼š

  - å®¢æˆ·ç«¯æ”¶åˆ°æ ‡å¿—ä½ï¼ˆ`SYN=1ï¼ŒACK=1`ï¼‰çš„æŠ¥æ–‡ï¼ŒçŸ¥é“è¿™æ˜¯ä¸ªè¿æ¥ç¡®è®¤æŠ¥æ–‡ã€‚
    - éªŒè¯ç¡®è®¤å·`ackæ˜¯å¦æ˜¯J+1`
    - å¦‚æœæ­£ç¡®ï¼Œåˆ™å°†æ ‡å¿—ä½ `ACK=1`  ï¼Œ`ack=K+1` ï¼Œå¹¶å°†è¯¥æ•°æ®åŒ…å‘é€ç»™ æœåŠ¡ç«¯ ã€‚æ­¤æ—¶ï¼Œ`Client` è¿›å…¥ `ESTABLISHEDï¼ˆè¿æ¥å»ºç«‹ï¼‰` çŠ¶æ€ã€‚

  - å®¢æˆ·ç«¯æ£€æŸ¥`ç¡®è®¤å·`æ˜¯å¦ä¸º`ack=K+1` ï¼Œ`ACK=1` ï¼Œ
    - å¦‚æœæ­£ç¡®åˆ™è¿æ¥å»ºç«‹æˆåŠŸã€‚æ­¤æ—¶ `Server` è¿›å…¥ `ESTABLISHED` çŠ¶æ€ï¼Œå®Œæˆä¸‰æ¬¡æ¡æ‰‹ï¼Œéšå Client ä¸ Server ä¹‹é—´å¯ä»¥å¼€å§‹ä¼ è¾“æ•°æ®äº†ã€‚

ğŸ¦… **ä¸ºä»€ä¹ˆ TCP è¿æ¥éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¸¤æ¬¡ä¸å¯ä»¥ä¹ˆï¼Œä¸ºä»€ä¹ˆï¼Ÿ**

- ä¸ºäº†é˜²æ­¢**å®¢æˆ·ç«¯å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚**æŠ¥æ–‡çªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯ï¼Œå¯¼è‡´æœåŠ¡å™¨ç«¯çš„ä¸€ç›´ç­‰å¾…è€Œæµªè´¹èµ„æºã€‚

**ğŸ¦… å®¢æˆ·ç«¯ä¸æ–­è¿›è¡Œè¯·æ±‚é“¾æ¥ä¼šæ€æ ·ï¼Ÿ**

> SYN æ”»å‡»ï¼Œè‹±æ–‡ä¸º SYN Flood ï¼Œæ˜¯ä¸€ç§å…¸å‹çš„ DoS/DDoS æ”»å‡»ã€‚

- 1ã€**å®¢æˆ·ç«¯**å‘æœåŠ¡ç«¯å‘é€**è¯·æ±‚è¿æ¥æ•°æ®åŒ…**ã€‚

- 2ã€æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€ç¡®è®¤æ•°æ®åŒ…ã€‚

- 3ã€**å®¢æˆ·ç«¯**ä¸å‘æœåŠ¡ç«¯**å‘é€ç¡®è®¤æ•°æ®åŒ…**ï¼ŒæœåŠ¡å™¨ä¸€ç›´ç­‰å¾…æ¥è‡ªå®¢æˆ·ç«¯çš„ç¡®è®¤ã€‚

ğŸš€ å¦‚ä½•æ£€æµ‹ SYN æ”»å‡»ï¼Ÿ

- æ£€æµ‹ SYN æ”»å‡»éå¸¸çš„æ–¹ä¾¿ï¼Œå½“ä½ åœ¨æœåŠ¡å™¨ä¸Šçœ‹åˆ°å¤§é‡çš„**åŠè¿æ¥çŠ¶æ€**æ—¶ï¼Œç‰¹åˆ«æ˜¯æº **IP åœ°å€æ˜¯éšæœºçš„**ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥æ–­å®šè¿™æ˜¯ä¸€æ¬¡ SYN æ”»å‡»ã€‚åœ¨ Linux/Unix ä¸Šå¯ä»¥ä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦çš„ **netstat å‘½ä»¤**æ¥æ£€æµ‹ SYN æ”»å‡»ã€‚

ğŸš€ æ€ä¹ˆè§£å†³ SYN æ”»å‡»å‘¢ï¼Ÿ

â€‹				ç­”æ¡ˆæ˜¯**åªèƒ½é¢„é˜²**ï¼Œæ²¡æœ‰å½»åº•æ ¹æ²»çš„åŠæ³•ï¼Œé™¤éä¸ä½¿ç”¨ TCP ã€‚æ–¹å¼å¦‚ä¸‹ï¼š

- 1ã€**é™æµ**ï¼šé™åˆ¶åŒæ—¶æ‰“å¼€ SYN åŠé“¾æ¥çš„æ•°ç›®

- 2ã€**è¶…æ—¶**ï¼šç¼©çŸ­ SYN åŠé“¾æ¥çš„ Timeout æ—¶é—´

- 3ã€**å…³é—­**ä¸å¿…è¦çš„æœåŠ¡ã€‚

- 4ã€**å¢åŠ **æœ€å¤§åŠè¿æ¥æ•°ã€‚

- 5ã€**è¿‡æ»¤**ç½‘å…³é˜²æŠ¤ã€‚

- 6ã€**SYN cookieæŠ€æœ¯**ï¼ˆå¯¹ TCP çš„å¢å¼ºï¼‰ã€‚

## ã€é‡è¦ã€‘ä»€ä¹ˆæ˜¯ TCP å››æ¬¡æŒ¥æ‰‹ï¼Ÿ

è¯¦ç»†æ¥è¯´ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š

[![TCP å››æ¬¡æŒ¥æ‰‹çš„å¹²è´§](http://static2.iocoder.cn/2cf7b8d1689ae6e920ef1b2c3eafb8b2)](http://static2.iocoder.cn/2cf7b8d1689ae6e920ef1b2c3eafb8b2)

![image-20200930120623902](https://gitee.com//chenchong0817/picture/raw/master/Aaron/20200930120632.png)

> å¦‚ä¸‹ä½¿ç”¨ Client å’Œ Server çš„æ–¹å¼ï¼Œä»…ä»…æ˜¯ä¸ºäº†æ–¹ä¾¿ï¼Œä¹Ÿæ˜¯å¯ä»¥ä» Server å‘ Client å‘èµ·ã€‚

1. ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼š
   - Client è®¾ç½®"`åºå·ï¼ˆSequence Numberï¼‰ï¼šseq=x`"å’Œ"`ç¡®è®¤å·ï¼ˆAcknowledgment Numberï¼‰ack=y`"ï¼Œå‘ä¸»æœº2å‘é€ä¸€ä¸ª**æ ‡å¿—ä½FIN=1**æŠ¥æ–‡æ®µï¼›è¡¨åæ•°æ®å‘é€å®Œæ¯•ã€‚
   - Client è¿›å…¥`FIN_WAIT_1`çŠ¶æ€
2. ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼š
   - Client **æ”¶åˆ°**çš„**æ ‡å¿—ä½FIN=1**æŠ¥æ–‡æ®µï¼Œ**ç«‹å³**å›ä¸€ä¸ªACK=1æŠ¥æ–‡æ®µï¼š`ack=x+1`ï¼›
   - Client æ”¶åˆ°åè¿›å…¥`FIN_WAIT_2`çŠ¶æ€ï¼›
   - Server è¿›å…¥ `CLOSE_WAIT` çŠ¶æ€
3. ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼š
   - Server å‘Client å‘é€FIN=1æŠ¥æ–‡æ®µï¼š`seq=y+1`ï¼Œè¯·æ±‚å…³é—­è¿æ¥ï¼Œ
   - Server è¿›å…¥`LAST_ACK`çŠ¶æ€ï¼›
4. ç¬¬å››æ¬¡åˆ†æ‰‹ï¼š
   - Client æ”¶åˆ°Server å‘é€çš„FINæŠ¥æ–‡æ®µï¼Œå‘Server å‘é€ACK=1æŠ¥æ–‡æ®µï¼š`seq=y+2`ï¼Œ
   - Client è¿›å…¥`TIME_WAIT`çŠ¶æ€ï¼›
   - Server æ”¶åˆ°Client çš„ACKæŠ¥æ–‡æ®µä»¥åï¼Œå°±å…³é—­è¿æ¥ï¼›
   - æ­¤æ—¶ï¼ŒClient ç­‰å¾…`2MSL`åä¾ç„¶æ²¡æœ‰æ”¶åˆ°å›å¤ï¼Œåˆ™è¯æ˜Serverç«¯å·²æ­£å¸¸å…³é—­ï¼Œé‚£å¥½ï¼Œä¸»æœº1ä¹Ÿå¯ä»¥å…³é—­è¿æ¥äº†ã€‚

ğŸ¦… **ä¸ºä»€ä¹ˆè¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ**

TCP åè®®æ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„è¿è¾“å±‚é€šä¿¡åè®®ã€‚**TCP æ˜¯å…¨åŒå·¥æ¨¡å¼**ï¼Œè¿™å°±æ„å‘³ç€ï¼š

- å½“ä¸»æœº 1 å‘å‡º `FIN` æŠ¥æ–‡æ®µæ—¶ï¼Œåªæ˜¯è¡¨ç¤ºä¸»æœº 1 å·²ç»æ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œä¸»æœº 1 å‘Šè¯‰ä¸»æœº 2 ï¼Œå®ƒçš„æ•°æ®å·²ç»å…¨éƒ¨å‘é€å®Œæ¯•äº†ï¼›**ä½†æ˜¯ï¼Œè¿™ä¸ªæ—¶å€™ä¸»æœº 1 è¿˜æ˜¯å¯ä»¥æ¥å—æ¥è‡ªä¸»æœº 2 çš„æ•°æ®ï¼›**å½“ä¸»æœº 2 è¿”å› `ACK` æŠ¥æ–‡æ®µæ—¶ï¼Œè¡¨ç¤ºå®ƒå·²ç»çŸ¥é“ä¸»æœº 1 æ²¡æœ‰æ•°æ®å‘é€äº†ï¼Œä½†æ˜¯ä¸»æœº 2 è¿˜æ˜¯å¯ä»¥å‘é€æ•°æ®åˆ°ä¸»æœº 1 çš„ã€‚

  > è‰¿è‰¿ï¼šå› ä¸ºä¸»æœº 2 æ­¤æ—¶å¯èƒ½è¿˜æœ‰æ•°æ®æƒ³è¦å‘é€ç»™ä¸»æœº 1 ï¼Œæ‰€ä»¥æŒ¥æ‰‹ä¸èƒ½åƒæ¡æ‰‹åªæœ‰ä¸‰æ¬¡ï¼Œè€Œæ˜¯å¤šäº†é‚£ä¹ˆâ€œä¸€æ¬¡â€ï¼

- å½“ä¸»æœº 2 ä¹Ÿå‘é€äº† `FIN` æŠ¥æ–‡æ®µæ—¶ï¼Œè¿™ä¸ªæ—¶å€™å°±è¡¨ç¤ºä¸»æœº 2 ä¹Ÿæ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œå°±ä¼šå‘Šè¯‰ä¸»æœº 1 ï¼Œæˆ‘ä¹Ÿæ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œä¹‹åå½¼æ­¤å°±ä¼šæ„‰å¿«çš„ä¸­æ–­è¿™æ¬¡ TCP è¿æ¥ã€‚

  > è‰¿è‰¿ï¼šæˆ‘ä»¬æŠŠå››æ¬¡æŒ¥æ‰‹ï¼Œç†è§£æˆä¸€æ¬¡å’Œå¹³çš„æŒ¥æ‰‹~

å¦‚æœè¦æ­£ç¡®çš„ç†è§£å››æ¬¡çš„åŸç†ï¼Œå°±éœ€è¦äº†è§£å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹ä¸­çš„çŠ¶æ€å˜åŒ–ã€‚

> ä¸»åŠ¨æ–¹=å‘é€æ–¹ï¼›è¢«åŠ¨æ–¹=æ¥æ”¶æ–¹ã€‚
>
> çŠ¶æ€å‰é¢çš„ï¼ˆä¸»åŠ¨æ–¹ï¼‰ï¼ˆè¢«åŠ¨æ–¹ï¼‰ï¼Œè¡¨ç¤ºè¯¥çŠ¶æ€å±äºè°ã€‚

- ï¼ˆä¸»åŠ¨æ–¹ï¼‰FIN_WAIT_1 ï¼šè¿™ä¸ªçŠ¶æ€è¦å¥½å¥½è§£é‡Šä¸€ä¸‹ï¼Œå…¶å® FIN_WAIT_1 å’Œ FIN_WAIT_2 çŠ¶æ€çš„çœŸæ­£å«ä¹‰éƒ½æ˜¯è¡¨ç¤ºç­‰å¾…å¯¹æ–¹çš„

   

  ```
  FIN
  ```

   

  æŠ¥æ–‡ã€‚è€Œè¿™ä¸¤ç§çŠ¶æ€çš„åŒºåˆ«æ˜¯ï¼š

  - FIN_WAIT_1 çŠ¶æ€å®é™…ä¸Šæ˜¯å½“ Socket åœ¨ ESTABLISHED çŠ¶æ€æ—¶ï¼Œå®ƒæƒ³ä¸»åŠ¨å…³é—­è¿æ¥ï¼Œå‘å¯¹æ–¹å‘é€äº† `FIN` æŠ¥æ–‡ï¼Œæ­¤æ—¶è¯¥ Socket å³è¿›å…¥åˆ° FIN_WAIT_1 çŠ¶æ€ã€‚
  - è€Œå½“å¯¹æ–¹å›åº” `ACK` æŠ¥æ–‡åï¼Œåˆ™è¿›å…¥åˆ° FIN_WAIT_2 çŠ¶æ€ï¼Œå½“ç„¶åœ¨å®é™…çš„æ­£å¸¸æƒ…å†µä¸‹ï¼Œæ— è®ºå¯¹æ–¹ä½•ç§æƒ…å†µä¸‹ï¼Œéƒ½åº”è¯¥é©¬ä¸Šå›åº”`ACK` æŠ¥æ–‡ã€‚æ‰€ä»¥ï¼Œ FIN_WAIT_1 çŠ¶æ€ä¸€èˆ¬æ˜¯æ¯”è¾ƒéš¾è§åˆ°çš„ï¼Œè€Œ FIN_WAIT_2 çŠ¶æ€è¿˜æœ‰æ—¶å¸¸å¸¸å¯ä»¥ç”¨ netstat çœ‹åˆ°ã€‚

- ï¼ˆä¸»åŠ¨æ–¹ï¼‰FIN_WAIT_2 ï¼šä¸Šé¢å·²ç»è¯¦ç»†è§£é‡Šäº†è¿™ç§çŠ¶æ€ï¼Œå®é™…ä¸Š FIN_WAIT_2 çŠ¶æ€ä¸‹çš„ Socketï¼Œè¡¨ç¤ºåŠè¿æ¥ï¼Œä¹Ÿå³æœ‰ä¸€æ–¹è¦æ±‚ close è¿æ¥ï¼Œä½†å¦å¤–è¿˜å‘Šè¯‰å¯¹æ–¹ï¼Œæˆ‘æš‚æ—¶è¿˜æœ‰ç‚¹æ•°æ®éœ€è¦ä¼ é€ç»™ä½ (`ACK` ä¿¡æ¯)ï¼Œç¨åå†å…³é—­è¿æ¥ã€‚

- ï¼ˆè¢«åŠ¨æ–¹ï¼‰CLOSE_WAIT ï¼šè¿™ç§çŠ¶æ€çš„å«ä¹‰å…¶å®æ˜¯è¡¨ç¤ºåœ¨ç­‰å¾…å…³é—­ã€‚æ€ä¹ˆç†è§£å‘¢ï¼Ÿå½“å¯¹æ–¹ close ä¸€ä¸ª Socket åå‘é€ `FIN` æŠ¥æ–‡ç»™è‡ªå·±ï¼Œä½ ç³»ç»Ÿæ¯«æ— ç–‘é—®åœ°ä¼šå›åº”ä¸€ä¸ª `ACK` æŠ¥æ–‡ç»™å¯¹æ–¹ï¼Œæ­¤æ—¶åˆ™è¿›å…¥åˆ° CLOSE_WAIT çŠ¶æ€ã€‚æ¥ä¸‹æ¥å‘¢ï¼Œå®é™…ä¸Šä½ çœŸæ­£éœ€è¦è€ƒè™‘çš„äº‹æƒ…æ˜¯å¯Ÿçœ‹ä½ æ˜¯å¦è¿˜æœ‰æ•°æ®å‘é€ç»™å¯¹æ–¹ï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œé‚£ä¹ˆä½ ä¹Ÿå°±å¯ä»¥ close è¿™ä¸ª Socket ï¼Œå‘é€ `FIN` æŠ¥æ–‡ç»™å¯¹æ–¹ï¼Œä¹Ÿå³å…³é—­è¿æ¥ã€‚æ‰€ä»¥ä½ åœ¨ CLOSE_WAIT çŠ¶æ€ä¸‹ï¼Œéœ€è¦å®Œæˆçš„äº‹æƒ…æ˜¯ç­‰å¾…ä½ å»å…³é—­è¿æ¥ã€‚

- ï¼ˆè¢«åŠ¨æ–¹ï¼‰LAST_ACK ï¼šè¿™ä¸ªçŠ¶æ€è¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“å¥½ç†è§£çš„ï¼Œå®ƒæ˜¯è¢«åŠ¨å…³é—­ä¸€æ–¹åœ¨å‘é€ `FIN` æŠ¥æ–‡åï¼Œæœ€åç­‰å¾…å¯¹æ–¹çš„ `ACK` æŠ¥æ–‡ã€‚å½“æ”¶åˆ° `ACK` æŠ¥æ–‡åï¼Œä¹Ÿå³å¯ä»¥è¿›å…¥åˆ° CLOSED å¯ç”¨çŠ¶æ€äº†ã€‚

- ï¼ˆä¸»åŠ¨æ–¹ï¼‰TIME_WAIT ï¼šè¡¨ç¤ºæ”¶åˆ°äº†å¯¹æ–¹çš„ `FIN` æŠ¥æ–‡ï¼Œå¹¶å‘é€å‡ºäº† `ACK` æŠ¥æ–‡ï¼Œå°±ç­‰ [2MSL](https://blog.csdn.net/xiaofei0859/article/details/6044694) åå³å¯å›åˆ° CLOSED å¯ç”¨çŠ¶æ€äº†ã€‚å¦‚æœ FIN_WAIT_1 çŠ¶æ€ä¸‹ï¼Œæ”¶åˆ°äº†å¯¹æ–¹åŒæ—¶å¸¦ `FIN` æ ‡å¿—å’Œ `ACK` æ ‡å¿—çš„æŠ¥æ–‡æ—¶ï¼Œå¯ä»¥ç›´æ¥è¿›å…¥åˆ° TIME_WAIT çŠ¶æ€ï¼Œè€Œæ— é¡»ç»è¿‡ FIN_WAIT_2 çŠ¶æ€ã€‚

  > **ä¸ºä½•ä¸€å®šè¦ç­‰ 2MSL ï¼Ÿ**
  >
  > å¦‚æœä¸ç­‰ï¼Œé‡Šæ”¾çš„ç«¯å£å¯èƒ½ä¼šé‡è¿åˆšæ–­å¼€çš„æœåŠ¡å™¨ç«¯å£ï¼Œè¿™æ ·ä¾ç„¶å­˜æ´»åœ¨ç½‘ç»œé‡Œçš„è€çš„ TCP æŠ¥æ–‡å¯èƒ½ä¸æ–° TCP è¿æ¥æŠ¥æ–‡å†²çªï¼Œé€ æˆæ•°æ®å†²çªï¼Œä¸ºé¿å…æ­¤ç§æƒ…å†µï¼Œéœ€è¦è€å¿ƒç­‰å¾…ç½‘ç»œè€çš„ TCP è¿æ¥çš„æ´»è·ƒæŠ¥æ–‡å…¨éƒ¨æ­»ç¿˜ç¿˜ï¼Œ2MSL æ—¶é—´å¯ä»¥æ»¡è¶³è¿™ä¸ªéœ€æ±‚ï¼ˆå°½ç®¡éå¸¸ä¿å®ˆï¼‰ï¼
  >
  > æ›´å¤šï¼Œå¯ä»¥çœ‹çœ‹çŸ¥ä¹ [ã€Šä¸ºä»€ä¹ˆ TCP 4 æ¬¡æŒ¥æ‰‹æ—¶ç­‰å¾…ä¸º 2MSLï¼Ÿã€‹](https://www.zhihu.com/question/67013338) çš„è®¨è®ºã€‚

- CLOSED ï¼šè¡¨ç¤ºè¿æ¥ä¸­æ–­ã€‚

å¦å¤–ï¼Œå…³äº TIME_WAIT å’Œ CLOSE_WAIT çŠ¶æ€çš„åŒºåˆ«ï¼Œèƒ–å‹å¯ä»¥åœ¨ç»†çœ‹ä¸‹ [ã€ŠTIME_WAIT å’Œ CLOSE_WAIT çŠ¶æ€åŒºåˆ«ã€‹](https://blog.csdn.net/kobejayandy/article/details/17655739) ã€‚

## ã€é‡è¦ã€‘TCP æ•°æ®å¦‚ä½•ä¼ è¾“ï¼Ÿ

å»ºç«‹è¿æ¥åï¼Œä¸¤å°ä¸»æœºå°±å¯ä»¥ç›¸äº’ä¼ è¾“æ•°æ®äº†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š[![TCP å¥—æ¥å­—çš„æ•°æ®äº¤æ¢è¿‡ç¨‹](http://static2.iocoder.cn/6ed78395a32a0fbf56afed309dc1eb71)](http://static2.iocoder.cn/6ed78395a32a0fbf56afed309dc1eb71)TCP å¥—æ¥å­—çš„æ•°æ®äº¤æ¢è¿‡ç¨‹

- ä¸Šå›¾ç»™å‡ºäº†ä¸»æœº A åˆ† 2 æ¬¡ï¼ˆåˆ† 2 ä¸ªæ•°æ®åŒ…ï¼‰å‘ä¸»æœº B ä¼ é€’ 200 å­—èŠ‚çš„è¿‡ç¨‹ã€‚

- é¦–å…ˆï¼Œä¸»æœº A é€šè¿‡ 1 ä¸ªæ•°æ®åŒ…å‘é€ 100 ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œæ•°æ®åŒ…çš„

   

  ```
  Seq
  ```

   

  å·è®¾ç½®ä¸º 1200 ã€‚ä¸»æœº B ä¸ºäº†ç¡®è®¤è¿™ä¸€ç‚¹ï¼Œå‘ä¸»æœº A å‘é€

   

  ```
  ACK
  ```

   

  åŒ…ï¼Œå¹¶å°†

   

  ```
  Ack
  ```

   

  å·è®¾ç½®ä¸º 1301 ã€‚

  - ä¸ºäº†ä¿è¯æ•°æ®å‡†ç¡®åˆ°è¾¾ï¼Œç›®æ ‡æœºå™¨åœ¨æ”¶åˆ°æ•°æ®åŒ…ï¼ˆåŒ…æ‹¬ `SYN` åŒ…ã€`FIN` åŒ…ã€æ™®é€šæ•°æ®åŒ…ç­‰ï¼‰åŒ…åå¿…é¡»ç«‹å³å›ä¼  `ACK` åŒ…ï¼Œè¿™æ ·å‘é€æ–¹æ‰èƒ½ç¡®è®¤æ•°æ®ä¼ è¾“æˆåŠŸã€‚

  - æ­¤æ—¶

     

    ```
    Ack
    ```

     

    å·ä¸º 1301 è€Œä¸æ˜¯ 1201ï¼ŒåŸå› åœ¨äº

     

    ```
    Ack
    ```

     

    å·çš„å¢é‡ä¸ºä¼ è¾“çš„æ•°æ®å­—èŠ‚æ•°ã€‚å‡è®¾æ¯æ¬¡

     

    ```
    Ack
    ```

     

    å·ä¸åŠ ä¼ è¾“çš„å­—èŠ‚æ•°ï¼Œè¿™æ ·è™½ç„¶å¯ä»¥ç¡®è®¤æ•°æ®åŒ…çš„ä¼ è¾“ï¼Œä½†æ— æ³•æ˜ç¡® 100 å­—èŠ‚å…¨éƒ¨æ­£ç¡®ä¼ é€’è¿˜æ˜¯ä¸¢å¤±äº†ä¸€éƒ¨åˆ†ï¼Œæ¯”å¦‚åªä¼ é€’äº† 80 å­—èŠ‚ã€‚å› æ­¤æŒ‰å¦‚ä¸‹çš„å…¬å¼ç¡®è®¤

     

    ```
    Ack
    ```

     

    å·ï¼š

    ```
    Ack
    ```

     

    å· =

     

    ```
    Seq
    ```

     

    å· + ä¼ é€’çš„å­—èŠ‚æ•° + 1 ã€‚

    - ä¸ä¸‰æ¬¡æ¡æ‰‹åè®®ç›¸åŒï¼Œæœ€ååŠ  1 æ˜¯ä¸ºäº†å‘Šè¯‰å¯¹æ–¹è¦ä¼ é€’çš„ `Seq` å·ã€‚

OKï¼Œè®©æˆ‘ä»¬é‡æ–°æ¥çœ‹ä¸‹ TCP çš„æ•´ä¸ªè¿‡ç¨‹ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š[TCP è¿‡ç¨‹](https://camo.githubusercontent.com/36cf7d4e1598683fe72a5e1c3e837b16840f4085/687474703a2f2f6f6f327239726e7a702e626b742e636c6f7564646e2e636f6d2f6a656c6c797468696e6b544350342e6a7067)

ğŸ¦… **TCP æ•°æ®ä¼ è¾“ä¸¢å¤±æ€ä¹ˆåŠï¼Ÿ**

> è‰¿è‰¿ï¼šè¿™ä¸ªé—®é¢˜ï¼Œä¹Ÿå¯ä»¥æ”¹æˆæé—®ï¼Œä»€ä¹ˆæ˜¯ TCP é‡ä¼ ã€‚

å› ä¸ºå„ç§åŸå› ï¼ŒTCP æ•°æ®åŒ…å¯èƒ½å­˜åœ¨ä¸¢å¤±çš„æƒ…å†µï¼ŒTCP ä¼šè¿›è¡Œæ•°æ®é‡ä¼ ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

[![TCPå¥—æ¥å­—æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯](http://static2.iocoder.cn/a36ed3dad53b9b4439bc8156bc63a2c0)](http://static2.iocoder.cn/a36ed3dad53b9b4439bc8156bc63a2c0)TCPå¥—æ¥å­—æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯

- ä¸Šå›¾è¡¨ç¤ºé€šè¿‡ `Seq` 1301 æ•°æ®åŒ…å‘ä¸»æœº B ä¼ é€’ 100 å­—èŠ‚çš„æ•°æ®ï¼Œä½†ä¸­é—´å‘ç”Ÿäº†é”™è¯¯ï¼Œä¸»æœº B æœªæ”¶åˆ°ã€‚ç»è¿‡ä¸€æ®µæ—¶é—´åï¼Œä¸»æœº A ä»æœªæ”¶åˆ°å¯¹äº `Seq` 1301 çš„ `ACK` ç¡®è®¤ï¼Œå› æ­¤å°è¯•é‡ä¼ æ•°æ®ã€‚ä¸ºäº†å®Œæˆæ•°æ®åŒ…çš„é‡ä¼ ï¼ŒTCP å¥—æ¥å­—æ¯æ¬¡å‘é€æ•°æ®åŒ…æ—¶éƒ½ä¼š**å¯åŠ¨å®šæ—¶å™¨**ï¼Œå¦‚æœåœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°ç›®æ ‡æœºå™¨ä¼ å›çš„ `ACK` åŒ…ï¼Œé‚£ä¹ˆå®šæ—¶å™¨è¶…æ—¶ï¼Œæ•°æ®åŒ…ä¼šé‡ä¼ ã€‚ä¸Šå›¾æ¼”ç¤ºçš„æ˜¯æ•°æ®åŒ…ä¸¢å¤±çš„æƒ…å†µï¼Œä¹Ÿä¼šæœ‰ `ACK` åŒ…ä¸¢å¤±çš„æƒ…å†µï¼Œä¸€æ ·ä¼šé‡ä¼ ã€‚

- é‡ä¼ è¶…æ—¶æ—¶é—´(RTOï¼ŒRetransmission Time Out)

  > è¿™ä¸ªå€¼å¤ªå¤§äº†ä¼šå¯¼è‡´ä¸å¿…è¦çš„ç­‰å¾…ï¼Œå¤ªå°ä¼šå¯¼è‡´ä¸å¿…è¦çš„é‡ä¼ ï¼Œç†è®ºä¸Šæœ€å¥½æ˜¯ç½‘ç»œ RTT æ—¶é—´ï¼Œä½†åˆå—åˆ¶äºç½‘ç»œè·ç¦»ä¸ç¬æ€æ—¶å»¶å˜åŒ–ï¼Œæ‰€ä»¥å®é™…ä¸Šä½¿ç”¨è‡ªé€‚åº”çš„åŠ¨æ€ç®—æ³•ï¼ˆä¾‹å¦‚ Jacobson ç®—æ³•å’Œ Karn ç®—æ³•ç­‰ï¼‰æ¥ç¡®å®šè¶…æ—¶æ—¶é—´ã€‚
  >
  > å¾€è¿”æ—¶é—´ï¼ˆRTTï¼ŒRound-Trip Timeï¼‰è¡¨ç¤ºä»å‘é€ç«¯å‘é€æ•°æ®å¼€å§‹ï¼Œåˆ°å‘é€ç«¯æ”¶åˆ°æ¥è‡ªæ¥æ”¶ç«¯çš„ `ACK` ç¡®è®¤åŒ…ï¼ˆæ¥æ”¶ç«¯æ”¶åˆ°æ•°æ®åä¾¿ç«‹å³ç¡®è®¤ï¼‰ï¼Œæ€»å…±ç»å†çš„æ—¶å»¶ã€‚

- é‡ä¼ æ¬¡æ•°

  > TCP æ•°æ®åŒ…é‡ä¼ æ¬¡æ•°ï¼Œæ ¹æ®ç³»ç»Ÿè®¾ç½®çš„ä¸åŒè€Œæœ‰æ‰€åŒºåˆ«ã€‚æœ‰äº›ç³»ç»Ÿï¼Œä¸€ä¸ªæ•°æ®åŒ…åªä¼šè¢«é‡ä¼  3 æ¬¡ï¼Œå¦‚æœé‡ä¼  3 æ¬¡åè¿˜æœªæ”¶åˆ°è¯¥æ•°æ®åŒ…çš„ `ACK` ç¡®è®¤ï¼Œå°±ä¸å†å°è¯•é‡ä¼ ã€‚ä½†æœ‰äº›è¦æ±‚å¾ˆé«˜çš„ä¸šåŠ¡ç³»ç»Ÿï¼Œä¼šä¸æ–­åœ°é‡ä¼ ä¸¢å¤±çš„æ•°æ®åŒ…ï¼Œä»¥å°½æœ€å¤§å¯èƒ½ä¿è¯ä¸šåŠ¡æ•°æ®çš„æ­£å¸¸äº¤äº’ã€‚
  >
  > æœ€åéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå‘é€ç«¯åªæœ‰åœ¨æ”¶åˆ°å¯¹æ–¹çš„ `ACK` ç¡®è®¤åŒ…åï¼Œæ‰ä¼šæ¸…ç©ºè¾“å‡ºç¼“å†²åŒºä¸­çš„æ•°æ®ã€‚

**psï¼šTCP æ•°æ®ä¼ è¾“çš„è¿‡ç¨‹ï¼Œå’Œ MQ Broker æŠ•é€’æ¶ˆæ¯ç»™ Consumer æ˜¯ä¸€æ ·çš„ï¼Œåªæœ‰åœ¨ Consumer Ack ç¡®è®¤æ¶ˆæ¯å·²ç»æ¶ˆè´¹ï¼Œè¯¥æ¶ˆæ¯æ‰ä¸ä¼šå†è¢«æŠ•é€’ç»™ Consumer ã€‚**

å¦å¤–ï¼Œä¹Ÿæ¨èé˜…è¯» [ã€Šç½‘ç»œåŸºæœ¬åŠŸï¼ˆä¹ï¼‰ï¼šç»†è¯´TCPé‡ä¼ ã€‹](https://wizardforcel.gitbooks.io/network-basic/content/8.html) ã€‚

## ã€é‡è¦ã€‘ä»€ä¹ˆæ˜¯ TCP æ»‘åŠ¨çª—å£ï¼Ÿ

åœ¨çœ‹ TCP æ»‘åŠ¨çª—å£çš„æ¦‚å¿µä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å®ƒå‡ºç°çš„**èƒŒæ™¯**ï¼Ÿ

> å°† TCP ä¸ UDP è¿™æ ·çš„ç®€å•ä¼ è¾“åè®®åŒºåˆ†å¼€æ¥çš„æ˜¯ï¼Œå®ƒä¼ è¾“æ•°æ®çš„è´¨é‡ã€‚TCP å¯¹äºå‘é€æ•°æ®è¿›è¡Œè·Ÿè¸ªï¼Œè¿™ç§æ•°æ®ç®¡ç†éœ€è¦åè®®æœ‰ä»¥ä¸‹ä¸¤å¤§å…³é”®åŠŸèƒ½ï¼š
>
> - å¯é æ€§ï¼šä¿è¯æ•°æ®ç¡®å®åˆ°è¾¾ç›®çš„åœ°ã€‚å¦‚æœæœªåˆ°è¾¾ï¼Œèƒ½å¤Ÿå‘ç°å¹¶é‡ä¼ ã€‚
> - æ•°æ®æµæ§ï¼šç®¡ç†æ•°æ®çš„å‘é€é€Ÿç‡ï¼Œä»¥ä½¿æ¥æ”¶è®¾å¤‡ä¸è‡´äºè¿‡è½½ã€‚
>
> è¦å®Œæˆè¿™äº›ä»»åŠ¡ï¼Œæ•´ä¸ªåè®®æ“ä½œæ˜¯å›´ç»•**æ»‘åŠ¨çª—å£** + **ç¡®è®¤æœºåˆ¶**æ¥è¿›è¡Œçš„ã€‚å› æ­¤ï¼Œç†è§£äº†æ»‘åŠ¨çª—å£ï¼Œä¹Ÿå°±æ˜¯ç†è§£äº† TCP ã€‚

é‚£ä¹ˆï¼Œåˆ°åº•ä»€ä¹ˆæ˜¯ TCP æ»‘åŠ¨çª—å£å‘¢ï¼Ÿ

> æ»‘åŠ¨çª—å£åè®®ï¼Œæ˜¯ä¼ è¾“å±‚è¿›è¡Œæµæ§çš„ä¸€ç§æªæ–½ï¼Œæ¥æ”¶æ–¹é€šè¿‡é€šå‘Šå‘é€æ–¹è‡ªå·±çš„çª—å£å¤§å°ï¼Œä»è€Œæ§åˆ¶å‘é€æ–¹çš„å‘é€é€Ÿåº¦ï¼Œä»è€Œè¾¾åˆ°é˜²æ­¢å‘é€æ–¹å‘é€é€Ÿåº¦è¿‡å¿«è€Œå¯¼è‡´è‡ªå·±è¢«æ·¹æ²¡çš„ç›®çš„ã€‚
>
> TCP çš„æ»‘åŠ¨çª—å£è§£å†³äº†ç«¯åˆ°ç«¯çš„æµé‡æ§åˆ¶é—®é¢˜ï¼Œå…è®¸æ¥å—æ–¹å¯¹ä¼ è¾“è¿›è¡Œé™åˆ¶ï¼Œç›´åˆ°å®ƒæ‹¥æœ‰è¶³å¤Ÿçš„ç¼“å†²ç©ºé—´æ¥å®¹çº³æ›´å¤šçš„æ•°æ®ã€‚

å¯èƒ½è¿™ä¹ˆæè¿°ä¹‹åï¼Œèƒ–å‹ä¼šæœ‰ç‚¹æ‡µé€¼ï¼Œé‚£ä¹ˆå»ºè®®çœ‹ä¸‹é¢ä¸‰ç¯‡æ–‡ç« ï¼Œè€å¿ƒ~

- [ã€ŠTCP æ»‘åŠ¨çª—å£æ§åˆ¶æµé‡çš„åŸç†ã€‹](https://www.cnblogs.com/luoquan/p/4886345.html)

  > æ¯”è¾ƒæ˜“æ‡‚çš„ä¸€ç¯‡æ–‡ç« ã€‚

- [ã€Šç½‘ç»œåŸºæœ¬åŠŸï¼ˆå…«ï¼‰ï¼šç»†è¯´ TCP æ»‘åŠ¨çª—å£ã€‹](https://wizardforcel.gitbooks.io/network-basic/content/7.html)

  > æ›´ä¸ºè¯¦ç»†çš„ä¸€ç¯‡æ–‡ç« ã€‚

- [ã€ŠTCP åè®®çš„æ»‘åŠ¨çª—å£å…·ä½“æ˜¯æ€æ ·æ§åˆ¶æµé‡çš„ï¼Ÿã€‹](https://www.zhihu.com/question/32255109)

  > çŸ¥ä¹ä¸Šçš„è®¨è®ºï¼Œé‡ç‚¹çœ‹ã€Œwuxinliuleiã€å’Œã€Œå®‰é™çš„æœ¨å°æ˜Šã€çš„å›ç­”ã€‚ç‰¹åˆ«æ˜¯åè€…çš„ï¼Œå›ç­”å¾ˆç”ŸåŠ¨å½¢è±¡ã€‚

## TCP åè®®å¦‚ä½•æ¥ä¿è¯ä¼ è¾“çš„å¯é æ€§ï¼Ÿ

TCP æä¾›ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„å­—èŠ‚æµæœåŠ¡ã€‚å…¶ä¸­ï¼Œé¢å‘è¿æ¥æ„å‘³ç€ä¸¤ä¸ªä½¿ç”¨ TCP çš„åº”ç”¨ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå®¢æˆ·å’Œä¸€ä¸ªæœåŠ¡å™¨ï¼‰åœ¨å½¼æ­¤äº¤æ¢æ•°æ®ä¹‹å‰å¿…é¡»å…ˆå»ºç«‹ä¸€ä¸ª TCP è¿æ¥ã€‚

- åœ¨ä¸€ä¸ª TCP è¿æ¥ä¸­ï¼Œä»…æœ‰ä¸¤æ–¹è¿›è¡Œå½¼æ­¤é€šä¿¡ã€‚
- è€Œå­—èŠ‚æµæœåŠ¡æ„å‘³ç€ä¸¤ä¸ªåº”ç”¨ç¨‹åºé€šè¿‡ TCP é“¾æ¥äº¤æ¢ 8bit å­—èŠ‚æ„æˆçš„å­—èŠ‚æµï¼ŒTCP ä¸åœ¨å­—èŠ‚æµä¸­æ’å…¥è®°å½•æ ‡è¯†ç¬¦ã€‚

å¯¹äºå¯é æ€§ï¼ŒTCP é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡Œä¿è¯ï¼š

- æ•°æ®åŒ…æ ¡éªŒï¼šç›®çš„æ˜¯æ£€æµ‹æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­çš„ä»»ä½•å˜åŒ–ï¼Œè‹¥æ ¡éªŒå‡ºåŒ…æœ‰é”™ï¼Œåˆ™ä¸¢å¼ƒæŠ¥æ–‡æ®µå¹¶ä¸”ä¸ç»™å‡ºå“åº”ï¼Œè¿™æ—¶ TCP å‘é€æ•°æ®ç«¯è¶…æ—¶åä¼šé‡å‘æ•°æ®ã€‚
- å¯¹å¤±åºæ•°æ®åŒ…é‡æ’åºï¼šæ—¢ç„¶ TCP æŠ¥æ–‡æ®µä½œä¸º IP æ•°æ®æŠ¥æ¥ä¼ è¾“ï¼Œè€Œ IP æ•°æ®æŠ¥çš„åˆ°è¾¾å¯èƒ½ä¼šå¤±åºï¼Œå› æ­¤ TC PæŠ¥æ–‡æ®µçš„åˆ°è¾¾ä¹Ÿå¯èƒ½ä¼šå¤±åºã€‚TCP å°†å¯¹å¤±åºæ•°æ®è¿›è¡Œé‡æ–°æ’åºï¼Œç„¶åæ‰äº¤ç»™åº”ç”¨å±‚ã€‚
- ä¸¢å¼ƒé‡å¤æ•°æ®ï¼šå¯¹äºé‡å¤æ•°æ®ï¼Œèƒ½å¤Ÿä¸¢å¼ƒé‡å¤æ•°æ®ã€‚
- åº”ç­”æœºåˆ¶ï¼šå½“ TCP æ”¶åˆ°å‘è‡ª TCP è¿æ¥å¦ä¸€ç«¯çš„æ•°æ®ï¼Œå®ƒå°†å‘é€ä¸€ä¸ªç¡®è®¤ã€‚è¿™ä¸ªç¡®è®¤ä¸æ˜¯ç«‹å³å‘é€ï¼Œé€šå¸¸å°†æ¨è¿Ÿå‡ åˆ†ä¹‹ä¸€ç§’ã€‚
- è¶…æ—¶é‡å‘ï¼šå½“ TCP å‘å‡ºä¸€ä¸ªæ®µåï¼Œå®ƒå¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨ï¼Œç­‰å¾…ç›®çš„ç«¯ç¡®è®¤æ”¶åˆ°è¿™ä¸ªæŠ¥æ–‡æ®µã€‚å¦‚æœä¸èƒ½åŠæ—¶æ”¶åˆ°ä¸€ä¸ªç¡®è®¤ï¼Œå°†é‡å‘è¿™ä¸ªæŠ¥æ–‡æ®µã€‚
- æµé‡æ§åˆ¶ï¼šTCP è¿æ¥çš„æ¯ä¸€æ–¹éƒ½æœ‰å›ºå®šå¤§å°çš„ç¼“å†²ç©ºé—´ã€‚TCP çš„æ¥æ”¶ç«¯åªå…è®¸å¦ä¸€ç«¯å‘é€æ¥æ”¶ç«¯ç¼“å†²åŒºæ‰€èƒ½æ¥çº³çš„æ•°æ®ï¼Œè¿™å¯ä»¥é˜²æ­¢è¾ƒå¿«ä¸»æœºè‡´ä½¿è¾ƒæ…¢ä¸»æœºçš„ç¼“å†²åŒºæº¢å‡ºï¼Œè¿™å°±æ˜¯æµé‡æ§åˆ¶ã€‚TCP ä½¿ç”¨çš„æµé‡æ§åˆ¶åè®®æ˜¯å¯å˜å¤§å°çš„**æ»‘åŠ¨çª—å£åè®®**ã€‚

## ä»€ä¹ˆæ˜¯ TCP æ‹¥å µï¼Ÿ

è®¡ç®—æœºç½‘ç»œä¸­çš„å¸¦å®½ã€äº¤æ¢ç»“ç‚¹ä¸­çš„ç¼“å­˜åŠå¤„ç†æœºç­‰éƒ½æ˜¯ç½‘ç»œçš„èµ„æºã€‚åœ¨æŸæ®µæ—¶é—´ï¼Œè‹¥å¯¹ç½‘ç»œä¸­æŸä¸€èµ„æºçš„éœ€æ±‚è¶…è¿‡äº†è¯¥èµ„æºæ‰€èƒ½æä¾›çš„å¯ç”¨éƒ¨åˆ†ï¼Œç½‘ç»œçš„æ€§èƒ½å°±ä¼šå˜åï¼Œè¿™ç§æƒ…å†µå°±å«åš**æ‹¥å¡**ã€‚

ğŸ¦… **æ€ä¹ˆè§£å†³ TCP æ‹¥å µï¼Ÿ**

é€šè¿‡æ‹¥å¡æ§åˆ¶æ¥è§£å†³ã€‚æ‹¥å µæ§åˆ¶ï¼Œå°±æ˜¯é˜²æ­¢è¿‡å¤šçš„æ•°æ®æ³¨å…¥ç½‘ç»œä¸­ï¼Œè¿™æ ·å¯ä»¥ä½¿ç½‘ç»œä¸­çš„è·¯ç”±å™¨æˆ–é“¾è·¯ä¸è‡´è¿‡è½½ã€‚æ³¨æ„ï¼Œæ‹¥å¡æ§åˆ¶å’Œæµé‡æ§åˆ¶ä¸åŒï¼Œå‰è€…æ˜¯ä¸€ä¸ª**å…¨å±€æ€§**çš„è¿‡ç¨‹ï¼Œè€Œåè€…æŒ‡**ç‚¹å¯¹ç‚¹**é€šä¿¡é‡çš„æ§åˆ¶ã€‚

æ‹¥å¡æ§åˆ¶çš„æ–¹æ³•ä¸»è¦æœ‰ä»¥ä¸‹å››ç§ï¼š

- 1ã€æ…¢å¼€å§‹ã€‚
- 2ã€æ‹¥å¡é¿å…ã€‚
- 3ã€å¿«é‡ä¼ ã€‚
- 4ã€å¿«æ¢å¤ã€‚

**1ï¼‰æ…¢å¼€å§‹**

ä¸è¦ä¸€å¼€å§‹å°±å‘é€å¤§é‡çš„æ•°æ®ï¼Œå…ˆæ¢æµ‹ä¸€ä¸‹ç½‘ç»œçš„æ‹¥å¡ç¨‹åº¦ï¼Œä¹Ÿå°±æ˜¯è¯´ç”±å°åˆ°å¤§é€æ¸å¢åŠ æ‹¥å¡çª—å£çš„å¤§å°ã€‚

**2ï¼‰æ‹¥å¡é¿å…**

æ‹¥å¡é¿å…ç®—æ³•ï¼Œè®©æ‹¥å¡çª—å£ç¼“æ…¢å¢é•¿ï¼Œå³æ¯ç»è¿‡ä¸€ä¸ªå¾€è¿”æ—¶é—´ RTT å°±æŠŠå‘é€æ–¹çš„æ‹¥å¡çª—å£ cwnd åŠ  1 ï¼Œè€Œä¸æ˜¯åŠ å€ï¼Œè¿™æ ·æ‹¥å¡çª—å£æŒ‰çº¿æ€§è§„å¾‹ç¼“æ…¢å¢é•¿ã€‚

[![æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…ç®—æ³•çš„å®ç°ä¸¾ä¾‹](http://static2.iocoder.cn/3ed1936c7ee8639606bc8b3dccc2d5bc)](http://static2.iocoder.cn/3ed1936c7ee8639606bc8b3dccc2d5bc)æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…ç®—æ³•çš„å®ç°ä¸¾ä¾‹

**3ï¼‰å¿«é‡ä¼ **

å¿«é‡ä¼ ï¼Œè¦æ±‚æ¥æ”¶æ–¹åœ¨æ”¶åˆ°ä¸€ä¸ª**å¤±åºçš„æŠ¥æ–‡æ®µ**åå°±ç«‹å³å‘å‡º**é‡å¤ç¡®è®¤**ï¼ˆä¸ºçš„æ˜¯ä½¿å‘é€æ–¹åŠæ—©çŸ¥é“æœ‰æŠ¥æ–‡æ®µæ²¡æœ‰åˆ°è¾¾å¯¹æ–¹ï¼‰ï¼Œè€Œä¸è¦ç­‰åˆ°è‡ªå·±å‘é€æ•°æ®æ—¶æå¸¦ç¡®è®¤ã€‚

å¿«é‡ä¼ ç®—æ³•è§„å®šï¼Œå‘é€æ–¹åªè¦ä¸€è¿æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤ï¼Œå°±åº”å½“ç«‹å³é‡ä¼ å¯¹æ–¹å°šæœªæ”¶åˆ°çš„æŠ¥æ–‡æ®µï¼Œè€Œä¸å¿…ç»§ç»­ç­‰å¾…è®¾ç½®çš„é‡ä¼ è®¡æ—¶å™¨æ—¶é—´åˆ°æœŸã€‚

[![å¿«é‡ä¼ çš„ç¤ºæ„å›¾](http://static2.iocoder.cn/96da7b757bb0dc2f2eaf86ac8ad20858)](http://static2.iocoder.cn/96da7b757bb0dc2f2eaf86ac8ad20858)å¿«é‡ä¼ çš„ç¤ºæ„å›¾

**4ï¼‰å¿«æ¢å¤**

å¿«é‡ä¼ é…åˆä½¿ç”¨çš„è¿˜æœ‰å¿«æ¢å¤ç®—æ³•ï¼Œå½“å‘é€æ–¹è¿ç»­æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤æ—¶ï¼Œå°±æ‰§è¡Œâ€œä¹˜æ³•å‡å°â€ç®—æ³•ï¼ŒæŠŠ ssthresh é—¨é™å‡åŠã€‚

- ä½†æ˜¯æ¥ä¸‹å»å¹¶ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼šå› ä¸ºå¦‚æœç½‘ç»œå‡ºç°æ‹¥å¡çš„è¯å°±ä¸ä¼šæ”¶åˆ°å¥½å‡ ä¸ªé‡å¤çš„ç¡®è®¤ï¼Œæ‰€ä»¥å‘é€æ–¹ç°åœ¨è®¤ä¸ºç½‘ç»œå¯èƒ½æ²¡æœ‰å‡ºç°æ‹¥å¡ã€‚
- æ‰€ä»¥æ­¤æ—¶ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼Œè€Œæ˜¯å°† cwnd è®¾ç½®ä¸º ssthresh çš„å¤§å°ï¼Œç„¶åæ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•ã€‚

[![ä»è¿ç»­æ”¶åˆ°ä¸‰ä¸ªé‡å¤çš„ç¡®è®¤è½¬å…¥æ‹¥å µé¿å…](http://static2.iocoder.cn/d5ac995144720c33399d8e518cb973a6)](http://static2.iocoder.cn/d5ac995144720c33399d8e518cb973a6)ä»è¿ç»­æ”¶åˆ°ä¸‰ä¸ªé‡å¤çš„ç¡®è®¤è½¬å…¥æ‹¥å µé¿å…

# UDP

## UDP æ˜¯ä»€ä¹ˆï¼Ÿ

UDPï¼ˆUser Data Protocolï¼Œç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼‰ï¼Œæ˜¯ä¸ TCP ç›¸å¯¹åº”çš„åè®®ã€‚å®ƒæ˜¯é¢å‘éè¿æ¥çš„åè®®ï¼Œå®ƒä¸ä¸å¯¹æ–¹å»ºç«‹è¿æ¥ï¼Œè€Œæ˜¯ç›´æ¥å°±æŠŠæ•°æ®åŒ…å‘é€è¿‡å»ã€‚

ä¸»è¦ç‰¹ç‚¹å¦‚ä¸‹ï¼š

- UDP æ˜¯æ— è¿æ¥çš„ã€‚

- UDP ä½¿ç”¨å°½æœ€å¤§åŠªåŠ›äº¤ä»˜ï¼Œå³ä¸ä¿è¯å¯é äº¤ä»˜ï¼Œå› æ­¤ä¸»æœºä¸éœ€è¦ç»´æŒå¤æ‚çš„é“¾æ¥çŠ¶æ€ï¼ˆè¿™é‡Œé¢æœ‰è®¸å¤šå‚æ•°ï¼‰ã€‚

- UDP æ˜¯é¢å‘æŠ¥æ–‡çš„ã€‚

- UDP æ²¡æœ‰æ‹¥å¡æ§åˆ¶ï¼Œå› æ­¤ç½‘ç»œå‡ºç°æ‹¥å¡ä¸ä¼šä½¿æºä¸»æœºçš„å‘é€é€Ÿç‡é™ä½ã€‚

  > å¯¹å®æ—¶åº”ç”¨å¾ˆæœ‰ç”¨ï¼Œå¦‚ ç›´æ’­ï¼Œå®æ—¶è§†é¢‘ä¼šè®®ç­‰

- UDP æ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„äº¤äº’é€šä¿¡ã€‚

- UDP çš„é¦–éƒ¨å¼€é”€å°ï¼Œåªæœ‰ 8 ä¸ªå­—èŠ‚ï¼Œæ¯” TCP çš„ 20 ä¸ªå­—èŠ‚çš„é¦–éƒ¨è¦çŸ­ã€‚

## UDP å¯¹åº”çš„åº”ç”¨å±‚åè®®ï¼Ÿ

- DNS ï¼šç”¨äºåŸŸåè§£ææœåŠ¡ï¼Œå°†åŸŸååœ°å€è½¬æ¢ä¸º IP åœ°å€ã€‚DNS ç”¨çš„æ˜¯ 53 å·ç«¯å£ã€‚
- SNMP ï¼šç®€å•ç½‘ç»œç®¡ç†åè®®ï¼Œä½¿ç”¨ 161 å·ç«¯å£ï¼Œæ˜¯ç”¨æ¥ç®¡ç†ç½‘ç»œè®¾å¤‡çš„ã€‚ç”±äºç½‘ç»œè®¾å¤‡å¾ˆå¤šï¼Œæ— è¿æ¥çš„æœåŠ¡å°±ä½“ç°å‡ºå…¶ä¼˜åŠ¿ã€‚
- TFTP(Trivial File Transfer Protocol)ï¼šç®€å•æ–‡ä»¶ä¼ è¾“åè®®ï¼Œè¯¥åè®®åœ¨ç†ŸçŸ¥ç«¯å£ 69 ä¸Šä½¿ç”¨ UDP æœåŠ¡ã€‚

## ã€é‡è¦ã€‘TCP ä¸ UDP çš„åŒºåˆ«

> è¿™ä¸ªé—®é¢˜ï¼Œä¸Šé¢åœ¨ä»‹ç» TCP å’Œ UDP éƒ½æåˆ°äº†ï¼Œå°±æ˜¯åšäº†æ•´åˆå“ˆã€‚

TCP(Transmission Control Protocol)å’Œ UDP(User Datagram Protocol) åè®®å±äºä¼ è¾“å±‚åè®®ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«åŒ…æ‹¬ï¼š

[![TCP ä¸ UDP çš„åŒºåˆ«](http://static2.iocoder.cn/047b5c455b1153e895df36e364134fcd)](http://static2.iocoder.cn/047b5c455b1153e895df36e364134fcd)TCP ä¸ UDP çš„åŒºåˆ«

- TCP æ˜¯é¢å‘è¿æ¥çš„ï¼›UDP æ˜¯æ— è¿æ¥çš„ã€‚
- TCP æ˜¯å¯é çš„ï¼›UDP æ˜¯ä¸å¯é çš„ã€‚
- TCP åªæ”¯æŒç‚¹å¯¹ç‚¹é€šä¿¡ï¼›UDP æ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹ä¸€ã€å¤šå¯¹å¤šçš„é€šä¿¡æ¨¡å¼ã€‚
- TCP æ˜¯é¢å‘å­—èŠ‚æµçš„ï¼›UDP æ˜¯é¢å‘æŠ¥æ–‡çš„ã€‚
- TCP æœ‰æ‹¥å¡æ§åˆ¶æœºåˆ¶ï¼›UDP æ²¡æœ‰æ‹¥å¡æ§åˆ¶ï¼Œé€‚åˆåª’ä½“é€šä¿¡ã€‚
- TCP é¦–éƒ¨å¼€é”€(20 ä¸ªå­—èŠ‚)ï¼Œæ¯” UDP çš„é¦–éƒ¨å¼€é”€(8 ä¸ªå­—èŠ‚)è¦å¤§ã€‚

ğŸ¦… **ä¸ºä»€ä¹ˆ TCP å«æ•°æ®æµæ¨¡å¼ï¼Ÿ UDP å«æ•°æ®æŠ¥æ¨¡å¼ï¼Ÿ**

æ‰€è°“çš„**â€œæµæ¨¡å¼â€**ï¼Œæ˜¯æŒ‡**TCP å‘é€ç«¯å‘é€å‡ æ¬¡æ•°æ®å’Œæ¥æ”¶ç«¯æ¥æ”¶å‡ æ¬¡æ•°æ®æ˜¯æ²¡æœ‰å¿…ç„¶è”ç³»çš„**ã€‚

- æ¯”å¦‚ä½ é€šè¿‡ TCP è¿æ¥ç»™å¦ä¸€ç«¯å‘é€æ•°æ®ï¼Œä½ åªè°ƒç”¨äº†ä¸€æ¬¡ write ï¼Œå‘é€äº† 100 ä¸ªå­—èŠ‚ï¼Œä½†æ˜¯å¯¹æ–¹å¯ä»¥åˆ† 10 æ¬¡æ”¶å®Œï¼Œæ¯æ¬¡ 10 ä¸ªå­—èŠ‚ï¼›ä½ ä¹Ÿå¯ä»¥è°ƒç”¨ 10 æ¬¡ write ï¼Œæ¯æ¬¡ 10 ä¸ªå­—èŠ‚ï¼Œä½†æ˜¯å¯¹æ–¹å¯ä»¥ä¸€æ¬¡å°±æ”¶å®Œã€‚
- åŸå› ï¼šè¿™æ˜¯å› ä¸º TCP æ˜¯é¢å‘è¿æ¥çš„ï¼Œä¸€ä¸ª Socket ä¸­æ”¶åˆ°çš„æ•°æ®éƒ½æ˜¯ç”±åŒä¸€å°ä¸»æœºå‘å‡ºï¼Œä¸”æœ‰åºåœ°åˆ°è¾¾ï¼Œæ‰€ä»¥æ¯æ¬¡è¯»å–å¤šå°‘æ•°æ®éƒ½å¯ä»¥ã€‚

æ‰€è°“çš„**â€œæ•°æ®æŠ¥æ¨¡å¼â€**ï¼Œæ˜¯æŒ‡ **UDP å‘é€ç«¯è°ƒç”¨äº†å‡ æ¬¡ write ï¼Œæ¥æ”¶ç«¯å¿…é¡»ç”¨ç›¸åŒæ¬¡æ•°çš„ read è¯»å®Œ**ã€‚

- UDP æ˜¯åŸºäºæŠ¥æ–‡çš„ï¼Œåœ¨æ¥æ”¶çš„æ—¶å€™ï¼Œæ¯æ¬¡æœ€å¤šåªèƒ½è¯»å–ä¸€ä¸ªæŠ¥æ–‡ï¼ŒæŠ¥æ–‡å’ŒæŠ¥æ–‡æ˜¯ä¸ä¼šåˆå¹¶çš„ï¼Œå¦‚æœç¼“å†²åŒºå°äºæŠ¥æ–‡é•¿åº¦ï¼Œåˆ™å¤šå‡ºçš„éƒ¨åˆ†ä¼šè¢«ä¸¢å¼ƒã€‚
- åŸå› ï¼šè¿™æ˜¯å› ä¸º UDP æ˜¯æ— è¿æ¥çš„ï¼Œåªè¦çŸ¥é“æ¥æ”¶ç«¯çš„ IP å’Œç«¯å£ï¼Œä»»ä½•ä¸»æœºéƒ½å¯ä»¥å‘æ¥æ”¶ç«¯å‘é€æ•°æ®ã€‚è¿™æ—¶å€™ï¼Œå¦‚æœä¸€æ¬¡èƒ½è¯»å–è¶…è¿‡ä¸€ä¸ªæŠ¥æ–‡çš„æ•°æ®ï¼Œåˆ™ä¼šä¹±å¥—ã€‚

## UDP æŠ¥æ–‡çš„æ ¼å¼

[![UDP æŠ¥æ–‡æ ¼å¼](http://static2.iocoder.cn/e80a784ed96b6c688ef8e4e409f4cd18)](http://static2.iocoder.cn/e80a784ed96b6c688ef8e4e409f4cd18)UDP æŠ¥æ–‡æ ¼å¼

- 16 ä½ * 4 = 64 ä½ = 8 å­—èŠ‚ã€‚

# DNS

## DNS æ˜¯ä»€ä¹ˆï¼Ÿ

- åŸŸåè§£æï¼Œ[www.xxx.com](http://www.xxx.com/) è½¬æ¢æˆ IP ï¼Œèƒ½å¤Ÿä½¿ç”¨æˆ·æ›´æ–¹ä¾¿çš„è®¿é—®äº’è”ç½‘ï¼Œè€Œä¸ç”¨å»è®°ä½èƒ½å¤Ÿè¢«æœºå™¨ç›´æ¥è¯»å–çš„ IP æ•°ä¸²ã€‚
- DNS åè®®è¿è¡Œåœ¨ UDP åè®®ä¹‹ä¸Šï¼Œä½¿ç”¨ç«¯å£å· 53 ã€‚

## ä¸»æœºè§£æåŸŸåçš„é¡ºåºï¼Ÿ

1. æµè§ˆå™¨ç¼“å­˜
2. æ‰¾æœ¬æœºçš„ hosts æ–‡ä»¶
3. è·¯ç”±ç¼“å­˜
4. æ‰¾ DNS æœåŠ¡å™¨(æœ¬åœ°åŸŸåã€é¡¶çº§åŸŸåã€æ ¹åŸŸå)
   - [è¿­ä»£æŸ¥è¯¢](https://blog.csdn.net/wuchuanpingstone/article/details/6720723)
   - [é€’å½’æŸ¥è¯¢](https://blog.csdn.net/wuchuanpingstone/article/details/6720723)

## DNS ä½¿ç”¨ä»€ä¹ˆåè®®ï¼Ÿ

> å‚è§ [ã€ŠDNSä½¿ç”¨çš„æ˜¯ TCP åè®®è¿˜æ˜¯ UDP åè®®ã€‹](https://benbenxiongyuan.iteye.com/blog/1088085) æ–‡ç« ã€‚

æ—¢ä½¿ç”¨ TCP åˆä½¿ç”¨ UDP ã€‚

- åŒºåŸŸä¼ é€æ—¶ä½¿ç”¨ TCP åè®®ã€‚

  > - è¾…åŸŸåæœåŠ¡å™¨ä¼šå®šæ—¶ï¼ˆä¸€èˆ¬æ—¶ 3 å°æ—¶ï¼‰å‘ä¸»åŸŸåæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ä»¥ä¾¿äº†è§£æ•°æ®æ˜¯å¦æœ‰å˜åŠ¨ã€‚å¦‚æœ‰å˜åŠ¨ï¼Œåˆ™ä¼šæ‰§è¡Œä¸€æ¬¡åŒºåŸŸä¼ é€ï¼Œè¿›è¡Œæ•°æ®åŒæ­¥ã€‚åŒºåŸŸä¼ é€å°†ä½¿ç”¨ TCP è€Œä¸æ˜¯ UDP ï¼Œå› ä¸ºæ•°æ®åŒæ­¥ä¼ é€çš„æ•°æ®é‡æ¯”ä¸€ä¸ªè¯·æ±‚å’Œåº”ç­”çš„æ•°æ®é‡è¦å¤šå¾—å¤šã€‚
  > - TCP æ˜¯ä¸€ç§å¯é çš„è¿æ¥ï¼Œä¿è¯äº†æ•°æ®çš„å‡†ç¡®æ€§ã€‚

- åŸŸåè§£ææ—¶ä½¿ç”¨ UDP åè®®ã€‚

  > - å®¢æˆ·ç«¯å‘ DNS æœåŠ¡å™¨æŸ¥è¯¢åŸŸåï¼Œä¸€èˆ¬è¿”å›çš„å†…å®¹éƒ½ä¸è¶…è¿‡ 512 å­—èŠ‚ï¼Œç”¨ UDP ä¼ è¾“å³å¯ã€‚
  >
  >   > UDP æŠ¥æ–‡çš„æœ€å¤§é•¿åº¦ä¸º 512 å­—èŠ‚ã€‚
  >
  > - ä¸ç”¨ç»è¿‡ TCP ä¸‰æ¬¡æ¡æ‰‹ï¼Œè¿™æ · DNS æœåŠ¡å™¨è´Ÿè½½æ›´ä½ï¼Œå“åº”æ›´å¿«ã€‚è™½ç„¶ä»ç†è®ºä¸Šè¯´ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥æŒ‡å®šå‘ DNS æœåŠ¡å™¨æŸ¥è¯¢çš„æ—¶å€™ä½¿ç”¨ TCP ï¼Œä½†äº‹å®ä¸Šï¼Œå¾ˆå¤š DNS æœåŠ¡å™¨è¿›è¡Œé…ç½®çš„æ—¶å€™ï¼Œä»…æ”¯æŒ UDP æŸ¥è¯¢åŒ…ã€‚

# HTTP

## HTTP æ˜¯ä»€ä¹ˆï¼Ÿ

HTTP åè®®ï¼Œæ˜¯ Hyper Text Transfer Protocolï¼ˆè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰çš„ç¼©å†™ï¼Œæ˜¯ç”¨äºä»ä¸‡ç»´ç½‘ï¼ˆWWW:World Wide Web ï¼‰æœåŠ¡å™¨ä¼ è¾“è¶…æ–‡æœ¬åˆ°æœ¬åœ°æµè§ˆå™¨çš„ä¼ é€åè®®ã€‚

ä¸»è¦ç‰¹ç‚¹å¦‚ä¸‹ï¼š

- ç®€å•å¿«é€Ÿï¼šå®¢æˆ·å‘æœåŠ¡å™¨è¯·æ±‚æœåŠ¡æ—¶ï¼Œåªéœ€ä¼ é€è¯·æ±‚æ–¹æ³•å’Œè·¯å¾„ã€‚è¯·æ±‚æ–¹æ³•å¸¸ç”¨çš„æœ‰ GETã€HEADã€POST ç­‰ç­‰ã€‚æ¯ç§æ–¹æ³•è§„å®šäº†å®¢æˆ·ä¸æœåŠ¡å™¨è”ç³»çš„ç±»å‹ä¸åŒã€‚ç”±äº HTTP åè®®ç®€å•ï¼Œä½¿å¾— HTTP æœåŠ¡å™¨çš„ç¨‹åºè§„æ¨¡å°ï¼Œå› è€Œé€šä¿¡é€Ÿåº¦å¾ˆå¿«ã€‚

- æ•°æ®æ ¼å¼çµæ´»ï¼šHTTP å…è®¸ä¼ è¾“ä»»æ„ç±»å‹çš„æ•°æ®å¯¹è±¡ã€‚æ­£åœ¨ä¼ è¾“çš„ç±»å‹ç”±Content-Type åŠ ä»¥æ ‡è®°ã€‚

- æ— è¿æ¥ï¼šæ— è¿æ¥çš„å«ä¹‰æ˜¯é™åˆ¶æ¯æ¬¡è¿æ¥åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ã€‚æœåŠ¡å™¨å¤„ç†å®Œå®¢æˆ·çš„è¯·æ±‚ï¼Œå¹¶æ”¶åˆ°å®¢æˆ·çš„åº”ç­”åï¼Œå³æ–­å¼€è¿æ¥ã€‚é‡‡ç”¨è¿™ç§æ–¹å¼å¯ä»¥èŠ‚çœä¼ è¾“æ—¶é—´ã€‚

  > ä¸»è¦æŒ‡çš„æ˜¯ä¸ä½¿ç”¨ Keep-Alive æœºåˆ¶çš„æƒ…å†µä¸‹ã€‚

- æ— çŠ¶æ€ï¼šHTTP åè®®æ˜¯æ— çŠ¶æ€åè®®ã€‚æ— çŠ¶æ€ï¼Œæ˜¯æŒ‡åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ã€‚æ— çŠ¶æ€æ„å‘³ç€å¦‚æœåç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œåˆ™å®ƒå¿…é¡»é‡ä¼ ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æ¯æ¬¡è¿æ¥ä¼ é€çš„æ•°æ®é‡å¢å¤§ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨æœåŠ¡å™¨ä¸éœ€è¦å…ˆå‰ä¿¡æ¯æ—¶å®ƒçš„åº”ç­”å°±è¾ƒå¿«ã€‚

  > æ— çŠ¶æ€ï¼Œæ‰€ä»¥æ›´å®¹æ˜“åšæœåŠ¡çš„æ‰©å®¹ï¼Œæ”¯æ’‘æ›´å¤§çš„è®¿é—®é‡ã€‚

- æ”¯æŒ B/S åŠ C/S æ¨¡å¼ã€‚

  > å¦å¤–ï¼ŒHTTP åè®®å·²ç»ä¸ä»…ä»…ä½¿ç”¨åœ¨æµè§ˆå™¨ä¸Šã€‚åœ¨å‰åç«¯åˆ†ç¦»çš„æ¶æ„ä¸­ï¼Œåˆæˆ–è€…å¾®æœåŠ¡æ¶æ„çš„å†…éƒ¨é€šä¿¡ä¸­ï¼ŒHTTP å› ä¸ºå…¶æ•°æ®æ ¼å¼çš„é€šç”¨æ€§ï¼Œå’Œè¯­è¨€æ— å…³ï¼Œè¢«å¤§è§„æ¨¡ä½¿ç”¨ã€‚

## HTTP åŸºæœ¬æ ¼å¼

> è‰¿è‰¿ï¼šè¯¦ç»†çš„ï¼Œå¯ä»¥çœ‹çœ‹ [ã€ŠçŒ«å“¥ç½‘ç»œç¼–ç¨‹ç³»åˆ—ï¼šè¯¦è§£ BAT é¢è¯•é¢˜ã€‹](https://github.com/kaiye/kaiye.github.com/issues/3) æ–‡ç« ã€‚

ğŸ¦… **HTTP è¯·æ±‚æ ¼å¼**

[![HTTP è¯·æ±‚æ ¼å¼](http://static2.iocoder.cn/e0f66085155bdcdaa170fab4507fa4f1)](http://static2.iocoder.cn/e0f66085155bdcdaa170fab4507fa4f1)HTTP è¯·æ±‚æ ¼å¼

- è¯·æ±‚è¡Œï¼šç”¨æ¥è¯´æ˜è¯·æ±‚ç±»å‹ï¼Œè¦è®¿é—®çš„èµ„æºä»¥åŠæ‰€ä½¿ç”¨çš„ HTTP ç‰ˆæœ¬ã€‚
- è¯·æ±‚å¤´éƒ¨ï¼šç´§æ¥ç€è¯·æ±‚è¡Œï¼ˆå³ç¬¬ä¸€è¡Œï¼‰ä¹‹åçš„éƒ¨åˆ†ï¼Œç”¨æ¥è¯´æ˜æœåŠ¡å™¨è¦ä½¿ç”¨çš„é™„åŠ ä¿¡æ¯ä»ç¬¬äºŒè¡Œèµ·ä¸ºè¯·æ±‚å¤´éƒ¨ã€‚
  - HOST ï¼Œå°†æŒ‡å‡ºè¯·æ±‚çš„ç›®çš„åœ°ã€‚
  - User-Agent ï¼ŒæœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯è„šæœ¬éƒ½èƒ½è®¿é—®å®ƒ,å®ƒæ˜¯æµè§ˆå™¨ç±»å‹æ£€æµ‹é€»è¾‘çš„é‡è¦åŸºç¡€ã€‚è¯¥ä¿¡æ¯ç”±ä½ çš„æµè§ˆå™¨æ¥å®šä¹‰ï¼Œå¹¶ä¸”åœ¨æ¯ä¸ªè¯·æ±‚ä¸­è‡ªåŠ¨å‘é€ç­‰ç­‰
  - â€¦
- ç©ºè¡Œï¼šè¯·æ±‚å¤´éƒ¨åé¢çš„ç©ºè¡Œæ˜¯å¿…é¡»çš„ã€‚
- è¯·æ±‚æ•°æ®ï¼šä¹Ÿå«ä¸»ä½“ï¼Œå¯ä»¥æ·»åŠ ä»»æ„çš„å…¶ä»–æ•°æ®ã€‚

ğŸ¦… **HTTP å“åº”æ ¼å¼**

[![HTTP å“åº”æ ¼å¼](http://static2.iocoder.cn/da1ada597b5feedcd7d6c17d1989629d)](http://static2.iocoder.cn/da1ada597b5feedcd7d6c17d1989629d)HTTP å“åº”æ ¼å¼

- çŠ¶æ€è¡Œï¼šç”± HTTP åè®®ç‰ˆæœ¬å·ã€çŠ¶æ€ç ã€çŠ¶æ€æ¶ˆæ¯ä¸‰éƒ¨åˆ†ç»„æˆã€‚
- æ¶ˆæ¯æŠ¥å¤´ï¼šç”¨æ¥è¯´æ˜å®¢æˆ·ç«¯è¦ä½¿ç”¨çš„ä¸€äº›é™„åŠ ä¿¡æ¯ã€‚
- ç©ºè¡Œï¼šæ¶ˆæ¯æŠ¥å¤´åé¢çš„ç©ºè¡Œæ˜¯å¿…é¡»çš„ã€‚
- å“åº”æ­£æ–‡ï¼šæœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯çš„æ–‡æœ¬ä¿¡æ¯ã€‚

ğŸ¦… **URI å’Œ URL çš„åŒºåˆ«ï¼Ÿ**

è§ [ã€ŠURI å’Œ URL çš„åŒºåˆ«ã€‹](https://www.jianshu.com/p/ba15d066f777) æ–‡ç« ã€‚

## HTTP åè®®åŒ…æ‹¬å“ªäº›è¯·æ±‚ï¼Ÿ

- GET: å¯¹æœåŠ¡å™¨èµ„æºçš„ç®€å•è¯·æ±‚ã€‚
- POST: ç”¨äºå‘é€åŒ…å«ç”¨æˆ·æäº¤æ•°æ®çš„è¯·æ±‚ã€‚
- HEADï¼šç±»ä¼¼äº GET è¯·æ±‚ï¼Œä¸è¿‡è¿”å›çš„å“åº”ä¸­æ²¡æœ‰å…·ä½“å†…å®¹ï¼Œç”¨äºè·å–æŠ¥å¤´ã€‚
- PUTï¼šä¼ è¯´ä¸­è¯·æ±‚æ–‡æ¡£çš„ä¸€ä¸ªç‰ˆæœ¬ã€‚
- DELETEï¼šå‘å‡ºä¸€ä¸ªåˆ é™¤æŒ‡å®šæ–‡æ¡£çš„è¯·æ±‚ã€‚
- TRACEï¼šå‘é€ä¸€ä¸ªè¯·æ±‚å‰¯æœ¬ï¼Œä»¥è·Ÿè¸ªå…¶å¤„ç†è¿›ç¨‹ã€‚
- OPTIONSï¼šè¿”å›æ‰€æœ‰å¯ç”¨çš„æ–¹æ³•ï¼Œæ£€æŸ¥æœåŠ¡å™¨æ”¯æŒå“ªäº›æ–¹æ³•ã€‚
- CONNECTï¼šç”¨äº SSL éš§é“çš„åŸºäºä»£ç†çš„è¯·æ±‚ã€‚

ğŸ¦… **GET å’Œ POST çš„åŒºåˆ«ï¼Ÿ**

| è¯·æ±‚æ–¹å¼ | æ•°æ®ä½ç½®            | æ˜æ–‡å¯†æ–‡ | æ•°æ®å®‰å…¨ | é•¿åº¦é™åˆ¶          | åº”ç”¨åœºæ™¯ |
| :------- | :------------------ | :------- | :------- | :---------------- | :------- |
| GET      | HTTP è¯·æ±‚çš„ path ä¸­ | æ˜æ–‡     | ä¸å®‰å…¨   | é•¿åº¦è¾ƒå°ï¼Œä¸€èˆ¬ 2k | æŸ¥è¯¢æ•°æ® |
| POST     | HTTP è¯·æ±‚ body ä¸­   | å¯æ˜å¯å¯† | å®‰å…¨     | æ”¯æŒè¾ƒå¤§æ•°æ®ä¼ è¾“  | ä¿®æ”¹æ•°æ® |

- GET è¯·æ±‚å¯è¢«ç¼“å­˜ï¼›POST è¯·æ±‚ä¸ä¼šè¢«ç¼“å­˜ã€‚

- GET è¯·æ±‚å¯è¢«æ”¶è—ä¸ºä¹¦ç­¾ï¼›POST ä¸èƒ½è¢«æ”¶è—ä¸ºä¹¦ç­¾ã€‚

- ã€éå¸¸æœ‰è¶£ã€‘å‚è§ [ã€Š99%çš„äººç†è§£é”™ HTTP ä¸­ GET ä¸ POST çš„åŒºåˆ«ã€‹](https://www.oschina.net/news/77354/http-get-post-different)

  > - å¯¹äº GET æ–¹å¼çš„è¯·æ±‚ï¼Œæµè§ˆå™¨ä¼šæŠŠ HTTP header å’Œ data ä¸€å¹¶å‘é€å‡ºå»ï¼ŒæœåŠ¡å™¨å“åº” 200ï¼ˆè¿”å›æ•°æ®ï¼‰ã€‚
  > - è€Œå¯¹äº POSTï¼Œæµè§ˆå™¨å…ˆå‘é€ header ï¼ŒæœåŠ¡å™¨å“åº” 100 continue ï¼Œæµè§ˆå™¨å†å‘é€ data ï¼ŒæœåŠ¡å™¨å“åº” 200 okï¼ˆè¿”å›æ•°æ®ï¼‰ã€‚
  >
  > ä¹Ÿå°±æ˜¯è¯´ï¼ŒGET åªéœ€è¦æ±½è½¦è·‘ä¸€è¶Ÿå°±æŠŠè´§é€åˆ°äº†ï¼Œè€Œ POS Tå¾—è·‘ä¸¤è¶Ÿï¼Œç¬¬ä¸€è¶Ÿï¼Œå…ˆå»å’ŒæœåŠ¡å™¨æ‰“ä¸ªæ‹›å‘¼â€œå—¨ï¼Œæˆ‘ç­‰ä¸‹è¦é€ä¸€æ‰¹è´§æ¥ï¼Œä½ ä»¬æ‰“å¼€é—¨è¿æ¥æˆ‘â€ï¼Œç„¶åå†å›å¤´æŠŠè´§é€è¿‡å»ã€‚
  >
  > psï¼šä¸è¿‡è¦æ³¨æ„ï¼ŒPOST å…·ä½“å‘å‡ æ¬¡ï¼Œä¹Ÿå’Œæµè§ˆå™¨çš„å®ç°æœ‰å…³ç³»ã€‚ä¾‹å¦‚ï¼šFirefox åªå‘ä¸€æ¬¡ã€‚
  > ps2ï¼šæ®ç ”ç©¶ï¼Œåœ¨ç½‘ç»œç¯å¢ƒå¥½çš„æƒ…å†µä¸‹ï¼Œå‘ä¸€æ¬¡åŒ…çš„æ—¶é—´å’Œå‘ä¸¤æ¬¡åŒ…çš„æ—¶é—´å·®åˆ«åŸºæœ¬å¯ä»¥æ— è§†ã€‚è€Œåœ¨ç½‘ç»œç¯å¢ƒå·®çš„æƒ…å†µä¸‹ï¼Œä¸¤æ¬¡åŒ…çš„ TCP åœ¨éªŒè¯æ•°æ®åŒ…å®Œæ•´æ€§ä¸Šï¼Œæœ‰éå¸¸å¤§çš„ä¼˜ç‚¹ã€‚

## HTTP æœ‰å“ªäº›çŠ¶æ€ç ï¼Ÿ

- 1Ã—Ã— : è¯·æ±‚å¤„ç†ä¸­ï¼Œè¯·æ±‚å·²è¢«æ¥å—ï¼Œæ­£åœ¨å¤„ç†
- 2Ã—Ã— : è¯·æ±‚æˆåŠŸï¼Œè¯·æ±‚è¢«æˆåŠŸå¤„ç†
  - 200 OK // å®¢æˆ·ç«¯è¯·æ±‚æˆåŠŸ
- 3Ã—Ã— : é‡å®šå‘ï¼Œè¦å®Œæˆè¯·æ±‚å¿…é¡»è¿›è¡Œè¿›ä¸€æ­¥å¤„ç†
  - 301 Moved Permanently // æ°¸ä¹…é‡å®šå‘,ä½¿ç”¨åŸŸåè·³è½¬
  - 302 Found // ä¸´æ—¶é‡å®šå‘,æœªç™»é™†çš„ç”¨æˆ·è®¿é—®ç”¨æˆ·ä¸­å¿ƒé‡å®šå‘åˆ°ç™»å½•é¡µé¢
- 4Ã—Ã— : å®¢æˆ·ç«¯é”™è¯¯ï¼Œè¯·æ±‚ä¸åˆæ³•
  - 400 Bad Request // å®¢æˆ·ç«¯è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯ï¼Œä¸èƒ½è¢«æœåŠ¡å™¨æ‰€ç†è§£
  - 401 Unauthorized // è¯·æ±‚æœªç»æˆæƒï¼Œè¿™ä¸ªçŠ¶æ€ä»£ç å¿…é¡»å’Œ WWW-Authenticate æŠ¥å¤´åŸŸä¸€èµ·ä½¿ç”¨
  - 403 Forbidden // æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æä¾›æœåŠ¡
  - 404 Not Found // è¯·æ±‚èµ„æºä¸å­˜åœ¨ï¼Œegï¼šè¾“å…¥äº†é”™è¯¯çš„ URL
- 5Ã—Ã— : æœåŠ¡å™¨ç«¯é”™è¯¯ï¼ŒæœåŠ¡å™¨ä¸èƒ½å¤„ç†åˆæ³•è¯·æ±‚
  - 500 Internal Server Error // æœåŠ¡å™¨å‘ç”Ÿä¸å¯é¢„æœŸçš„é”™è¯¯
  - 503 Server Unavailable // æœåŠ¡å™¨å½“å‰ä¸èƒ½å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä¸€æ®µæ—¶é—´åå¯èƒ½æ¢å¤æ­£å¸¸

å®Œæ•´çš„çŠ¶æ€ç åˆ—è¡¨ï¼Œå¯ä»¥çœ‹çœ‹ [ã€ŠHTTP çŠ¶æ€ç ã€‹](https://zh.wikipedia.org/zh-hans/HTTPçŠ¶æ€ç ) æ–‡ç« ã€‚

ğŸ¦… **forward å’Œ redirect çš„åŒºåˆ«ï¼Ÿ**

- ç›´æ¥è½¬å‘æ–¹å¼ï¼ˆForwardï¼‰ï¼Œå®¢æˆ·ç«¯å’Œæµè§ˆå™¨åªå‘å‡ºä¸€æ¬¡è¯·æ±‚ï¼ŒServletã€HTMLã€JSP æˆ–å…¶å®ƒä¿¡æ¯èµ„æºï¼Œç”±ç¬¬äºŒä¸ªä¿¡æ¯èµ„æºå“åº”è¯¥è¯·æ±‚ï¼Œåœ¨è¯·æ±‚å¯¹è±¡ request ä¸­ï¼Œä¿å­˜çš„å¯¹è±¡å¯¹äºæ¯ä¸ªä¿¡æ¯èµ„æºæ˜¯å…±äº«çš„ã€‚
- é—´æ¥è½¬å‘æ–¹å¼ï¼ˆRedirectï¼‰ï¼Œå®é™…æ˜¯ä¸¤æ¬¡ HTTP è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯åœ¨å“åº”ç¬¬ä¸€æ¬¡è¯·æ±‚çš„æ—¶å€™ï¼Œè®©æµè§ˆå™¨å†å‘å¦å¤–ä¸€ä¸ª URL å‘å‡ºè¯·æ±‚ï¼Œä»è€Œè¾¾åˆ°è½¬å‘çš„ç›®çš„ã€‚

è¯¦ç»†çš„ï¼Œè¯·çœ‹ [ã€Šè¯·æ±‚è½¬å‘ï¼ˆForwardï¼‰å’Œé‡å®šå‘ï¼ˆRedirectï¼‰çš„åŒºåˆ«ã€‹](https://www.cnblogs.com/Qian123/p/5345527.html) ã€‚

ğŸ¦… **HTTP è¿”å›ç ä¸­ 301 ä¸ 302 çš„åŒºåˆ«ï¼Ÿ**

301ï¼Œ302 éƒ½æ˜¯ HTTP çŠ¶æ€çš„ç¼–ç ï¼Œéƒ½ä»£è¡¨ç€æŸä¸ª URL å‘ç”Ÿäº†è½¬ç§»ï¼Œä¸åŒä¹‹å¤„åœ¨äºï¼š

- 301 redirect: 301 ä»£è¡¨æ°¸ä¹…æ€§è½¬ç§»(Permanently Moved)ã€‚
- 302 redirect: 302 ä»£è¡¨æš‚æ—¶æ€§è½¬ç§»(Temporarily Moved)ã€‚

è¯¦ç»†çš„ï¼Œè¯·çœ‹ [ã€ŠHTTP è¿”å›ç ä¸­ 301 ä¸ 302 çš„åŒºåˆ«ã€‹](https://blog.csdn.net/qmhball/article/details/7838989) æ–‡ç« ã€‚

## HTTPã€TCPã€Socket çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ

- TCP/IP ä»£è¡¨ä¼ è¾“æ§åˆ¶åè®®/ç½‘é™…åè®®ï¼ŒæŒ‡çš„æ˜¯ä¸€ç³»åˆ—åè®®æ—ã€‚
- HTTP æœ¬èº«å°±æ˜¯ä¸€ä¸ªåè®®ï¼Œæ˜¯ä» Web æœåŠ¡å™¨ä¼ è¾“è¶…æ–‡æœ¬åˆ°æœ¬åœ°æµè§ˆå™¨çš„ä¼ é€åè®®ã€‚
- Socket æ˜¯ TCP/IP ç½‘ç»œçš„ API ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªé—¨é¢æ¨¡å¼ï¼Œå®ƒæŠŠå¤æ‚çš„ TCP/IP åè®®æ—éšè—åœ¨ Socket æ¥å£åé¢ã€‚å¯¹ç”¨æˆ·æ¥è¯´ï¼Œä¸€ç»„ç®€å•çš„æ¥å£å°±æ˜¯å…¨éƒ¨ï¼Œè®© Socket å»ç»„ç»‡æ•°æ®ï¼Œä»¥ç¬¦åˆæŒ‡å®šçš„åè®®ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼š

- éœ€è¦ IP åè®®æ¥è¿æ¥ç½‘ç»œ
- TCP æ˜¯ä¸€ç§å…è®¸æˆ‘ä»¬å®‰å…¨ä¼ è¾“æ•°æ®çš„æœºåˆ¶ï¼Œä½¿ç”¨ TCP åè®®æ¥ä¼ è¾“æ•°æ®çš„ HTTP æ˜¯ Web æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä½¿ç”¨çš„ç‰¹æ®Šåè®®ã€‚
- HTTP åŸºäº TCP åè®®ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ Socket å»å»ºç«‹ä¸€ä¸ª TCP è¿æ¥ã€‚

## Cookies å’Œ Session çš„åŒºåˆ«

- Session åœ¨æœåŠ¡å™¨ç«¯ï¼ŒCookie åœ¨å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ã€‚

  > Session é»˜è®¤è¢«å­˜åœ¨åœ¨æœåŠ¡å™¨çš„ä¸€ä¸ªæ–‡ä»¶é‡Œï¼ˆä¸æ˜¯å†…å­˜ï¼‰ã€‚

- Session çš„è¿è¡Œä¾èµ– sessionid ï¼Œè€Œ sessionid æ˜¯å­˜åœ¨ Cookie ä¸­çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæµè§ˆå™¨ç¦ç”¨äº† Cookie ï¼ŒåŒæ—¶ session ä¹Ÿä¼šå¤±æ•ˆã€‚ä½†æ˜¯ï¼Œå¯ä»¥é€šè¿‡å…¶å®ƒæ–¹å¼å®ç°ï¼Œæ¯”å¦‚åœ¨ url å‚æ•°ä¸­ä¼ é€’ sessionid ã€‚

- Session å¯ä»¥æ”¾åœ¨æ–‡ä»¶ã€æ•°æ®åº“ã€æˆ–å†…å­˜ä¸­éƒ½å¯ä»¥ã€‚

- ã€å…³é”®ã€‘**ç”¨æˆ·éªŒè¯è¿™ç§åœºåˆä¸€èˆ¬ä¼šç”¨ Session** ã€‚

## ã€é‡è¦ã€‘ä¸€æ¬¡å®Œæ•´çš„ HTTP è¯·æ±‚æ‰€ç»å†çš„æ­¥éª¤

> è¿™é‡Œçš„å®¢æˆ·ç«¯ï¼Œæ›´å¤šæŒ‡çš„æ˜¯æµè§ˆå™¨ã€‚

- 1ã€DNS è§£æ(é€šè¿‡è®¿é—®çš„åŸŸåæ‰¾å‡ºå…¶ IP åœ°å€ï¼Œé€’å½’æœç´¢)ã€‚

- 2ã€HTTP è¯·æ±‚ï¼Œå½“è¾“å…¥ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œå»ºç«‹ä¸€ä¸ª Socket è¿æ¥å‘èµ· TCPçš„ 3 æ¬¡æ¡æ‰‹ã€‚

  > å¦‚æœæ˜¯ HTTPS è¯·æ±‚ï¼Œä¼šç•¥å¾®æœ‰ä¸åŒã€‚ç­‰åˆ° HTTPS å°èŠ‚ï¼Œæˆ‘ä»¬åœ¨æ¥è®²ã€‚

- 3.1ã€å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚å‘½ä»¤ï¼ˆä¸€èˆ¬æ˜¯ GET æˆ– POST è¯·æ±‚ï¼‰ã€‚

  > è¿™ä¸ªæ˜¯è¡¥å……å†…å®¹ï¼Œé¢è¯•ä¸€èˆ¬ä¸ç”¨å›ç­”ã€‚
  >
  > å®¢æˆ·ç«¯çš„ç½‘ç»œå±‚ä¸ç”¨å…³å¿ƒåº”ç”¨å±‚æˆ–è€…ä¼ è¾“å±‚çš„ä¸œè¥¿ï¼Œä¸»è¦åšçš„æ˜¯é€šè¿‡æŸ¥æ‰¾è·¯ç”±è¡¨ç¡®å®šå¦‚ä½•åˆ°è¾¾æœåŠ¡å™¨ï¼ŒæœŸé—´å¯èƒ½ç»è¿‡å¤šä¸ªè·¯ç”±å™¨ï¼Œè¿™äº›éƒ½æ˜¯ç”±è·¯ç”±å™¨æ¥å®Œæˆçš„å·¥ä½œï¼Œæˆ‘ä¸ä½œè¿‡å¤šçš„æè¿°ï¼Œæ— éå°±æ˜¯é€šè¿‡æŸ¥æ‰¾è·¯ç”±è¡¨å†³å®šé€šè¿‡é‚£ä¸ªè·¯å¾„åˆ°è¾¾æœåŠ¡å™¨ã€‚
  >
  > å®¢æˆ·ç«¯çš„é“¾è·¯å±‚ï¼ŒåŒ…é€šè¿‡é“¾è·¯å±‚å‘é€åˆ°è·¯ç”±å™¨ï¼Œé€šè¿‡é‚»å±…åè®®æŸ¥æ‰¾ç»™å®š IP åœ°å€çš„ MAC åœ°å€ï¼Œç„¶åå‘é€ ARP è¯·æ±‚æŸ¥æ‰¾ç›®çš„åœ°å€ï¼Œå¦‚æœå¾—åˆ°å›åº”åå°±å¯ä»¥ä½¿ç”¨ ARP çš„è¯·æ±‚åº”ç­”äº¤æ¢çš„ IP æ•°æ®åŒ…ç°åœ¨å°±å¯ä»¥ä¼ è¾“äº†ï¼Œç„¶åå‘é€ IP æ•°æ®åŒ…åˆ°è¾¾æœåŠ¡å™¨çš„åœ°å€ã€‚

- 3.2ã€å®¢æˆ·ç«¯å‘é€è¯·æ±‚å¤´ä¿¡æ¯å’Œæ•°æ®ã€‚

- 4.1ã€æœåŠ¡å™¨å‘é€åº”ç­”å¤´ä¿¡æ¯ã€‚

- 4.2ã€æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å‘é€æ•°æ®ã€‚

- 5ã€æœåŠ¡å™¨å…³é—­ TCP è¿æ¥ï¼ˆ4æ¬¡æŒ¥æ‰‹ï¼‰ã€‚

  > è¿™é‡Œæ˜¯å¦å…³é—­ TCP è¿æ¥ï¼Œä¹Ÿæ ¹æ® HTTP Keep-Alive æœºåˆ¶æœ‰å…³ã€‚
  >
  > åŒæ—¶ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥ä¸»åŠ¨å‘èµ·å…³é—­ TCP è¿æ¥ã€‚

- 6ã€å®¢æˆ·ç«¯æ ¹æ®è¿”å›çš„ HTMLã€CSSã€JS è¿›è¡Œæ¸²æŸ“ã€‚

å¦‚ä¸‹æ˜¯ã€Šå›¾è§£HTTPã€‹æä¾›çš„å›¾ç‰‡ï¼š[![HTTP è¯·æ±‚æ‰€ç»å†çš„æ­¥éª¤](http://static2.iocoder.cn/be5603b1bb6ff46b640909b5b8976827)](http://static2.iocoder.cn/be5603b1bb6ff46b640909b5b8976827)HTTP è¯·æ±‚æ‰€ç»å†çš„æ­¥éª¤

## HTTP1.0 å’Œ HTTP1.1 æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

ä¸»è¦æ˜¯å¦‚ä¸‹ 8 ç‚¹ï¼š

- 1ã€å¯æ‰©å±•æ€§

- 2ã€ç¼“å­˜

- 3ã€å¸¦å®½ä¼˜åŒ–

  > å¸¦æ¥äº†[åˆ†å—ä¼ è¾“](https://zh.wikipedia.org/wiki/åˆ†å—ä¼ è¾“ç¼–ç ) ã€‚å¯èƒ½çš„è¯ï¼Œé¢è¯•ä¹Ÿä¼šé—®ã€‚

- ã€æœ€é‡è¦ã€‘4ã€é•¿è¿æ¥

- 5ã€æ¶ˆæ¯ä¼ é€’

- 6ã€Host å¤´åŸŸ

- 7ã€é”™è¯¯æç¤º

- 8ã€å†…å®¹åå•†

è¯¦ç»†çš„æ¯ä¸€ç‚¹çš„è¯´æ˜ï¼Œå¯ä»¥çœ‹ [ã€ŠHTTP1.0 ä¸ HTTP1.1 çš„åŒºåˆ«ã€‹](https://blog.csdn.net/ForgotAboutGirl/article/details/6936982) æ–‡ç« ï¼Œç‰¹åˆ«æ˜¯ç¬¬ 4 ç‚¹ã€é•¿è¿æ¥ã€‘ã€‚

> HTTP1.1 æ”¯æŒé•¿è¿æ¥ï¼ˆPersistentConnectionï¼‰å’Œè¯·æ±‚çš„æµæ°´çº¿ï¼ˆPipeliningï¼‰ã€‚
>
> - é•¿è¿æ¥ï¼ˆPersistentConnectionï¼‰ï¼šå¤„ç†åœ¨ä¸€ä¸ª TCP è¿æ¥ä¸Šå¯ä»¥ä¼ é€å¤šä¸ª HTTP è¯·æ±‚å’Œå“åº”ï¼Œå‡å°‘äº†å»ºç«‹å’Œå…³é—­è¿æ¥çš„æ¶ˆè€—å’Œå»¶è¿Ÿã€‚åœ¨ HTTP1.1ä¸­ é»˜è®¤å¼€å¯`Connectionï¼škeep-alive` ï¼Œä¸€å®šç¨‹åº¦ä¸Šå¼¥è¡¥äº† HTTP1.0 æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ›å»ºè¿æ¥çš„ç¼ºç‚¹ã€‚
> - è¯·æ±‚çš„æµæ°´çº¿ï¼ˆPipeliningï¼‰ï¼šHTTP1.1 è¿˜å…è®¸å®¢æˆ·ç«¯ä¸ç”¨ç­‰å¾…ä¸Šä¸€æ¬¡è¯·æ±‚ç»“æœè¿”å›ï¼Œå°±å¯ä»¥å‘å‡ºä¸‹ä¸€æ¬¡è¯·æ±‚ï¼Œä½†æœåŠ¡å™¨ç«¯å¿…é¡»æŒ‰ç…§æ¥æ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚çš„å…ˆåé¡ºåºä¾æ¬¡å›é€å“åº”ç»“æœï¼Œä»¥ä¿è¯å®¢æˆ·ç«¯èƒ½å¤ŸåŒºåˆ†å‡ºæ¯æ¬¡è¯·æ±‚çš„å“åº”å†…å®¹ï¼Œè¿™æ ·ä¹Ÿæ˜¾è‘—åœ°å‡å°‘äº†æ•´ä¸ªä¸‹è½½è¿‡ç¨‹æ‰€éœ€è¦çš„æ—¶é—´ã€‚
>
> æ¨èï¼Œåœ¨çœ‹çœ‹ [ã€ŠHTTP Keep-Alive æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•å·¥ä½œï¼Ÿã€‹](http://www.nowamagic.net/academy/detail/23350305) æ–‡ç« ã€‚
>
> å…³äºè¿™ä¸€ç‚¹ï¼Œå¯èƒ½æ¼”å˜çš„é—®é¢˜æœ‰ï¼š
>
> - HTTP çš„é•¿è¿æ¥æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ
> - HTTP Keep-Alive æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ
> - HTTP Keep-Alive æœºåˆ¶å’Œ TCP Keep-Alive æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

## SPDY æ˜¯ä»€ä¹ˆï¼Ÿ

> è‰¿è‰¿ï¼šå…³äºè¿™ä¸ªé—®é¢˜ï¼Œäº†è§£å°±å¥½ã€‚
>
> HTTP Working-Group æœ€ç»ˆå†³å®šä»¥ SPDY/2 ä¸ºåŸºç¡€ï¼Œå¼€å‘ HTTP/2 ã€‚

2012 å¹´ï¼ŒGoogle å¦‚ä¸€å£°æƒŠé›·æå‡ºäº† SPDY çš„æ–¹æ¡ˆï¼Œä¼˜åŒ–äº† HTTP1.X çš„è¯·æ±‚å»¶è¿Ÿï¼Œè§£å†³äº† HTTP1.X çš„å®‰å…¨æ€§ï¼Œå…·ä½“å¦‚ä¸‹ï¼š

- 1ã€é™ä½å»¶è¿Ÿ

  > é’ˆå¯¹ HTTP é«˜å»¶è¿Ÿçš„é—®é¢˜ï¼ŒSPDY ä¼˜é›…çš„é‡‡å–äº†å¤šè·¯å¤ç”¨ï¼ˆmultiplexingï¼‰ã€‚å¤šè·¯å¤ç”¨é€šè¿‡å¤šä¸ªè¯·æ±‚ Stream å…±äº«ä¸€ä¸ª Tcpè¿ æ¥çš„æ–¹å¼ï¼Œè§£å†³äº† HOL blocking çš„é—®é¢˜ï¼Œé™ä½äº†å»¶è¿ŸåŒæ—¶æé«˜äº†å¸¦å®½çš„åˆ©ç”¨ç‡ã€‚

- 2ã€è¯·æ±‚ä¼˜å…ˆçº§ï¼ˆrequest prioritizationï¼‰

  > å¤šè·¯å¤ç”¨å¸¦æ¥ä¸€ä¸ªæ–°çš„é—®é¢˜æ˜¯ï¼Œåœ¨è¿æ¥å…±äº«çš„åŸºç¡€ä¹‹ä¸Šæœ‰å¯èƒ½ä¼šå¯¼è‡´å…³é”®è¯·æ±‚è¢«é˜»å¡ã€‚SPDY å…è®¸ç»™æ¯ä¸ª request è®¾ç½®ä¼˜å…ˆçº§ï¼Œè¿™æ ·é‡è¦çš„è¯·æ±‚å°±ä¼šä¼˜å…ˆå¾—åˆ°å“åº”ã€‚
  >
  > æ¯”å¦‚æµè§ˆå™¨åŠ è½½é¦–é¡µï¼Œé¦–é¡µçš„ html å†…å®¹åº”è¯¥ä¼˜å…ˆå±•ç¤ºï¼Œä¹‹åæ‰æ˜¯å„ç§é™æ€èµ„æºæ–‡ä»¶ï¼Œè„šæœ¬æ–‡ä»¶ç­‰åŠ è½½ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ç”¨æˆ·èƒ½ç¬¬ä¸€æ—¶é—´çœ‹åˆ°ç½‘é¡µå†…å®¹ã€‚

- 3ã€header å‹ç¼©

  > å‰é¢æåˆ° HTTP1.x çš„ header å¾ˆå¤šæ—¶å€™éƒ½æ˜¯é‡å¤å¤šä½™çš„ã€‚é€‰æ‹©åˆé€‚çš„å‹ç¼©ç®—æ³•å¯ä»¥å‡å°åŒ…çš„å¤§å°å’Œæ•°é‡ã€‚

- 4ã€åŸºäº HTTPS çš„åŠ å¯†åè®®ä¼ è¾“

  > å¤§å¤§æé«˜äº†ä¼ è¾“æ•°æ®çš„å®‰å…¨æ€§ã€‚

- 5ã€æœåŠ¡ç«¯æ¨é€ï¼ˆserver pushï¼‰

  > é‡‡ç”¨äº† SPDY çš„ç½‘é¡µï¼Œä¾‹å¦‚æˆ‘çš„ç½‘é¡µæœ‰ä¸€ä¸ª `sytle.css` çš„è¯·æ±‚ï¼Œåœ¨å®¢æˆ·ç«¯æ”¶åˆ° `sytle.css` æ•°æ®çš„åŒæ—¶ï¼ŒæœåŠ¡ç«¯ä¼šå°† `sytle.js` çš„æ–‡ä»¶æ¨é€ç»™å®¢æˆ·ç«¯ã€‚å½“å®¢æˆ·ç«¯å†æ¬¡å°è¯•è·å– `sytle.js` æ—¶å°±å¯ä»¥ç›´æ¥ä»ç¼“å­˜ä¸­è·å–åˆ°ï¼Œä¸ç”¨å†å‘è¯·æ±‚äº†ã€‚
  >
  > ğŸ™‚ å’Œæˆ‘ä»¬ç†è§£çš„æœåŠ¡ç«¯æ¨é€ï¼Œæœ‰ç‚¹ï¼ˆéå¸¸ï¼‰ä¸ä¸€æ ·å“ˆã€‚

ğŸš€ SPDY æ„æˆå›¾å¦‚ä¸‹ï¼š[![SPDY æ„æˆå›¾](http://static2.iocoder.cn/82cf7ea112281d126f23db03a502c249)](http://static2.iocoder.cn/82cf7ea112281d126f23db03a502c249)SPDY æ„æˆå›¾

- SPDY ä½äº HTTP ä¹‹ä¸‹ï¼ŒTCP å’Œ SSL ä¹‹ä¸Šï¼Œè¿™æ ·å¯ä»¥è½»æ¾å…¼å®¹è€ç‰ˆæœ¬çš„ HTTP åè®®(å°† HTTP1.x çš„å†…å®¹å°è£…æˆä¸€ç§æ–°çš„ frame æ ¼å¼)ï¼ŒåŒæ—¶å¯ä»¥ä½¿ç”¨å·²æœ‰çš„ SSL åŠŸèƒ½ã€‚

# HTTPS

æ¨èå…ˆçœ‹ä¸‹ [ã€Šä¹ä¸ªé—®é¢˜ä»å…¥é—¨åˆ°ç†Ÿæ‚‰ HTTPSã€‹](http://juejin.im/post/58c5268a61ff4b005d99652a) æ–‡ç« ï¼Œå†™çš„å¾ˆæœ‰è¶£~

å¦å¤–ï¼Œä¹Ÿçœ‹çœ‹ [ã€ŠSSL/TLS åŒå‘è®¤è¯(ä¸€) â€“ SSL/TLSå·¥ä½œåŸç†ã€‹](https://blog.csdn.net/ustccw/article/details/76691248) æ–‡ç« ï¼Œå†™çš„æ›´æŠ€æœ¯å‘~

ä¸‹é¢çš„é¢è¯•é¢˜çš„ç­”æ¡ˆï¼Œæˆ‘ä»¬ä¼šåŸºäºä¸Šè¿°æ–‡ç« æ¥æ•´ç†ã€‚

## HTTPS æ˜¯ä»€ä¹ˆï¼Ÿ

HTTPS ï¼Œå®é™…å°±æ˜¯åœ¨ TCP å±‚ä¸ HTTP å±‚ä¹‹é—´åŠ å…¥äº† SSL/TLS æ¥ä¸ºä¸Šå±‚çš„å®‰å…¨ä¿é©¾æŠ¤èˆªï¼Œä¸»è¦ç”¨åˆ°å¯¹ç§°åŠ å¯†ã€éå¯¹ç§°åŠ å¯†ã€è¯ä¹¦ï¼Œç­‰æŠ€æœ¯è¿›è¡Œå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨çš„æ•°æ®åŠ å¯†ä¼ è¾“ï¼Œæœ€ç»ˆè¾¾åˆ°ä¿è¯æ•´ä¸ªé€šä¿¡çš„å®‰å…¨æ€§ã€‚

[![img](http://static2.iocoder.cn/a9e8780d6b899cf5709579fc9c451fd9)](http://static2.iocoder.cn/a9e8780d6b899cf5709579fc9c451fd9)

ä¸€å¥è¯æ¦‚æ‹¬ï¼š**HTTP + åŠ å¯† + è®¤è¯ + å®Œæ•´æ€§ä¿æŠ¤ = HTTPS** ã€‚

ğŸ¦… **ä»€ä¹ˆæ˜¯ SSL å‘¢ï¼Ÿä»€ä¹ˆæ˜¯ TLS å‘¢ï¼Ÿ**

å®˜æ–¹å®šä¹‰ï¼ŒSSL æ˜¯å®‰å…¨å¥—æ¥å±‚(secure sockets layer)ï¼›TLS æ˜¯ SSL çš„ç»§ä»»è€…ï¼Œå«ä¼ è¾“å±‚å®‰å…¨(transport layer security)ã€‚

å®ƒä»¬å­˜åœ¨çš„å”¯ä¸€ç›®çš„å°±æ˜¯ä¿è¯ä¸Šå±‚é€šè®¯å®‰å…¨çš„ä¸€å¥—æœºåˆ¶ã€‚å®ƒçš„å‘å±•ä¾æ¬¡ç»å†äº†ä¸‹é¢å‡ ä¸ªæ—¶æœŸï¼Œåƒæ‰‹æœºè½¯ä»¶å‡çº§ä¸€æ ·ï¼Œæ¯æ¬¡æ›´æ–°éƒ½æ·»åŠ æˆ–å»é™¤åŠŸèƒ½ï¼Œæ¯”å¦‚å¼•è¿›æ–°çš„åŠ å¯†ç®—æ³•ï¼Œä¿®æ”¹æ¡æ‰‹æ–¹å¼ç­‰ã€‚

- SSL1.0: å·²åºŸé™¤
- SSL2.0: RFC6176 ï¼Œå·²åºŸé™¤
- SSL3.0: RFC6101 ï¼ŒåŸºæœ¬åºŸé™¤
- **TLS1.0**: RFC2246 ï¼Œç›®å‰å¤§éƒ½é‡‡ç”¨æ­¤ç§æ–¹å¼
- TLS1.1: RFC4346
- TLS1.2: RFC5246 ï¼Œæ²¡æœ‰å¹¿æ³›ä½¿ç”¨
- TLS1.3: IETF æ­£åœ¨é…é…¿ä¸­

> è‰¿è‰¿ï¼šä¸ºäº†ä¸‹é¢æè¿°æ–¹ä¾¿ï¼Œç»Ÿä¸€å…ˆå« SSL ã€‚

ğŸ¦… **SSL/TLS åè®®ä½œç”¨ï¼Ÿ**

1. è®¤è¯ç”¨æˆ·å’ŒæœåŠ¡å™¨ï¼Œç¡®ä¿æ•°æ®å‘é€åˆ°æ­£ç¡®çš„å®¢æˆ·æœºå’ŒæœåŠ¡å™¨ã€‚

   > å®¢æˆ·ç«¯å¿…é¡»é¿å…ä¸­é—´äººæ”»å‡»ï¼Œå³é™¤äº†çœŸæ­£çš„æœåŠ¡å™¨ï¼Œä»»ä½•ç¬¬ä¸‰æ–¹éƒ½æ— æ³•å†’å……æœåŠ¡å™¨ã€‚

2. åŠ å¯†æ•°æ®ä»¥é˜²æ­¢æ•°æ®ä¸­é€”è¢«çªƒå–ã€‚

3. ç»´æŠ¤æ•°æ®çš„å®Œæ•´æ€§ï¼Œç¡®ä¿æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸è¢«æ”¹å˜ã€‚

## HTTP å’Œ HTTPS çš„åŒºåˆ«ï¼Ÿ

- ç«¯å£ä¸åŒï¼šHTTP ä¸ HTTPS ä½¿ç”¨ä¸åŒçš„è¿æ¥æ–¹å¼ï¼Œç”¨çš„ç«¯å£ä¹Ÿä¸ä¸€æ ·ï¼Œå‰è€…æ˜¯ 80ï¼Œåè€…æ˜¯ 443ã€‚

  > è‰¿è‰¿ï¼šä¸ªäººçš„æƒ³æ³•ï¼Œå®é™… HTTPS ä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨ 80 ç«¯å£ï¼Œä½†æ˜¯è€ƒè™‘ç»§ç»­ä¿æŒ HTTP çš„å…¼å®¹ï¼Œåªå¥½é€€è€Œæ±‚å…¶æ¬¡ï¼Œä½¿ç”¨ 443 ç«¯å£ã€‚

- èµ„æºæ¶ˆè€—ï¼šå’Œ HTTP é€šä¿¡ç›¸æ¯”ï¼ŒHTTPS é€šä¿¡ä¼šç”±äºåŠ è§£å¯†å¤„ç†æ¶ˆè€—æ›´å¤šçš„ CPU å’Œå†…å­˜èµ„æºã€‚

- å¼€é”€ï¼šHTTPS é€šä¿¡éœ€è¦è¯ä¹¦ï¼Œè€Œè¯ä¹¦ä¸€èˆ¬éœ€è¦å‘è®¤è¯æœºæ„ç”³è¯·å…è´¹æˆ–è€…ä»˜è´¹è´­ä¹°ã€‚

  > HTTPS å¯ä»¥æœ‰æ•ˆçš„é˜²æ­¢è¿è¥å•†åŠ«æŒï¼Œè§£å†³äº†é˜²åŠ«æŒçš„ä¸€ä¸ªå¤§é—®é¢˜ã€‚

## SSL åŠ å¯†æ–¹å¼æ˜¯ä»€ä¹ˆï¼Ÿ

> - å¯¹ç§°å¯†é’¥åŠ å¯†ï¼Œæ˜¯æŒ‡åŠ å¯†å’Œè§£å¯†ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥çš„æ–¹å¼ï¼Œè¿™ç§æ–¹å¼å­˜åœ¨çš„æœ€å¤§é—®é¢˜å°±æ˜¯å¯†é’¥å‘é€é—®é¢˜ï¼Œå³å¦‚ä½•å®‰å…¨åœ°å°†å¯†é’¥å‘ç»™å¯¹æ–¹ã€‚
> - éå¯¹ç§°åŠ å¯†ï¼ŒæŒ‡ä½¿ç”¨ä¸€å¯¹éå¯¹ç§°å¯†é’¥ï¼Œå³å…¬é’¥å’Œç§é’¥ï¼Œå…¬é’¥å¯ä»¥éšæ„å‘å¸ƒï¼Œä½†ç§é’¥åªæœ‰è‡ªå·±çŸ¥é“ã€‚å‘é€å¯†æ–‡çš„ä¸€æ–¹ä½¿ç”¨å¯¹æ–¹çš„å…¬é’¥è¿›è¡ŒåŠ å¯†å¤„ç†ï¼Œå¯¹æ–¹æ¥æ”¶åˆ°åŠ å¯†ä¿¡æ¯åï¼Œä½¿ç”¨è‡ªå·±çš„ç§é’¥è¿›è¡Œè§£å¯†ã€‚

SSL åè®®ï¼Œå³ç”¨åˆ°äº†å¯¹ç§°åŠ å¯†ä¹Ÿç”¨åˆ°äº†éå¯¹ç§°åŠ å¯†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š[![SSL åŠ å¯†è¿‡ç¨‹](http://static2.iocoder.cn/images/Net/2020_03_01/01.jpeg)](http://static2.iocoder.cn/images/Net/2020_03_01/01.jpeg)SSL åŠ å¯†è¿‡ç¨‹

> TODO è¿™ä¸ªé…å›¾æœ‰é—®é¢˜ã€‚åŸå›¾æˆ‘åœ¨ç¿»ï¼Œè²Œä¼¼ä¸å°å¿ƒè¢«æˆ‘åˆ é™¤äº†ã€‚ã€‚ã€‚ã€‚

- åœ¨å»ºç«‹ä¼ è¾“é“¾è·¯æ—¶ï¼ŒSSL é¦–å…ˆå¯¹å¯¹ç§°åŠ å¯†çš„å¯†é’¥ä½¿ç”¨å…¬é’¥è¿›è¡Œéå¯¹ç§°åŠ å¯†ã€‚

  > è‰¿è‰¿ï¼šæ³¨æ„å“Ÿï¼Œè¿™é‡Œ Server è¿”å›ç»™ Client çš„ä¸æ˜¯å…¬é’¥( `server.pub` )ï¼Œè€Œæ˜¯ `server.crt` ã€‚Client éœ€è¦ä½¿ç”¨ `ca.key` ä» `server.crt` ä¸­è§£å¯†å‡ºå…¬é’¥( `server.pub` ) ã€‚

- é“¾è·¯å»ºç«‹å¥½ä¹‹åï¼ŒSSL å¯¹ä¼ è¾“å†…å®¹ä½¿ç”¨å…¬é’¥( `server.pub` )å¯¹ç§°åŠ å¯†ã€‚

ğŸ¦… **ä¸ºä»€ä¹ˆå…¬é’¥ä¼ è¾“çš„æ­¥éª¤è¿™ä¹ˆå¤æ‚å‘¢ï¼Ÿ**

ç­”æ¡ˆè¯·çœ‹ [ã€Šä¹ä¸ªé—®é¢˜ä»å…¥é—¨åˆ°ç†Ÿæ‚‰ HTTPSã€‹](http://juejin.im/post/58c5268a61ff4b005d99652a) æ–‡ç« çš„å¦‚ä¸‹é—®é¢˜ï¼š

- Q5: é‚£å…¬é’¥æ€ä¹ˆä¼ è¾“
- Q6: ä½ åœ¨é€—æˆ‘ä¹ˆã€‚ã€‚ã€‚ã€‚
- Q7: æ€ä¹ˆçŸ¥é“è¯ä¹¦æœ‰æ²¡æœ‰è¢«ç¯¡æ”¹ï¼Ÿ
- Q8: è¿™æ ·å¯ä»¥é˜²æ­¢ç¬¬ä¸‰æ–¹å†’å……æœåŠ¡å™¨ä¹ˆ

ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡ CA æ¥ä¿è¯ã€‚è‡³äº `server.crt` è¯ä¹¦æ˜¯æ€ä¹ˆç”³è¯·çš„å‘¢ï¼Ÿè¯·çœ‹ [ã€ŠSSL/TLS åŒå‘è®¤è¯(ä¸€) â€“ SSL/TLSå·¥ä½œåŸç†ã€‹](https://blog.csdn.net/ustccw/article/details/76691248) æ–‡ç« çš„ [ã€ŒCA çš„è¯ä¹¦ ca.crt å’Œ SSL Server çš„è¯ä¹¦ server.crt æ˜¯ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ ã€](http://svip.iocoder.cn/Net/Interview/#) é—®é¢˜çš„è§£ç­”ã€‚

> è‰¿è‰¿ï¼šçœ‹è¿™å—ï¼Œæˆ‘å·²ç»è¦è¢«ç»•æ™•äº†ï¼ï¼ï¼è€å¿ƒ~èƒ–å‹ï¼Œç†è§£åä¼šå¾ˆçˆ½ã€‚

## ä»€ä¹ˆæ˜¯å•å‘è®¤è¯ã€åŒå‘è®¤è¯ï¼Ÿ

- å•å‘è®¤è¯ï¼ŒæŒ‡çš„æ˜¯åªæœ‰ä¸€ä¸ªå¯¹è±¡æ ¡éªŒå¯¹ç«¯çš„è¯ä¹¦åˆæ³•æ€§ã€‚

  > é€šå¸¸éƒ½æ˜¯ Client æ¥æ ¡éªŒæœåŠ¡å™¨çš„åˆæ³•æ€§ã€‚é‚£ä¹ˆ Client éœ€è¦ä¸€ä¸ª`ca.crt` ï¼ŒæœåŠ¡å™¨éœ€è¦ `server.crt` å’Œ `server.key` ã€‚

- åŒå‘è®¤è¯ï¼ŒæŒ‡çš„æ˜¯ç›¸äº’æ ¡éªŒï¼ŒServer éœ€è¦æ ¡éªŒæ¯ä¸ª Client ï¼ŒClient ä¹Ÿéœ€è¦æ ¡éªŒæœåŠ¡å™¨ã€‚

  > - Server éœ€è¦ `server.key`ã€`server.crt`ã€`ca.crt` ã€‚
  > - Client éœ€è¦ `client.key`ã€`client.crt`ã€`ca.crt` ã€‚

ğŸ¦… **1ï¼‰å•å‘è®¤è¯çš„è¿‡ç¨‹ï¼Ÿ**

[![å•å‘è®¤è¯](http://static2.iocoder.cn/bdf6be06c37bcc026ed906f392661e3b)](http://static2.iocoder.cn/bdf6be06c37bcc026ed906f392661e3b)å•å‘è®¤è¯

- 1ã€å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€ SSL åè®®ç‰ˆæœ¬å·ã€åŠ å¯†ç®—æ³•ç§ç±»ã€éšæœºæ•°ç­‰ä¿¡æ¯ã€‚

- 2ã€æœåŠ¡ç«¯ç»™å®¢æˆ·ç«¯è¿”å› SSL åè®®ç‰ˆæœ¬å·ã€åŠ å¯†ç®—æ³•ç§ç±»ã€éšæœºæ•°ç­‰ä¿¡æ¯ï¼ŒåŒæ—¶ä¹Ÿè¿”å›æœåŠ¡å™¨ç«¯çš„è¯ä¹¦ï¼Œå³å…¬é’¥è¯ä¹¦ã€‚

- 3ã€å®¢æˆ·ç«¯ä½¿ç”¨æœåŠ¡ç«¯è¿”å›çš„ä¿¡æ¯éªŒè¯æœåŠ¡å™¨çš„åˆæ³•æ€§ï¼ŒåŒ…æ‹¬ï¼š

  - è¯ä¹¦æ˜¯å¦è¿‡æœŸã€‚

  - å‘å‹æœåŠ¡å™¨è¯ä¹¦çš„ CA æ˜¯å¦å¯é ã€‚

  - è¿”å›çš„å…¬é’¥æ˜¯å¦èƒ½æ­£ç¡®è§£å¼€è¿”å›è¯ä¹¦ä¸­çš„æ•°å­—ç­¾åã€‚

  - æœåŠ¡å™¨è¯ä¹¦ä¸Šçš„åŸŸåæ˜¯å¦å’ŒæœåŠ¡å™¨çš„å®é™…åŸŸåç›¸åŒ¹é…

    > éªŒè¯é€šè¿‡åï¼Œå°†ç»§ç»­è¿›è¡Œé€šä¿¡ï¼›å¦åˆ™ï¼Œç»ˆæ­¢é€šä¿¡ã€‚

  - 4ã€å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€è‡ªå·±æ‰€èƒ½æ”¯æŒçš„å¯¹ç§°åŠ å¯†æ–¹æ¡ˆï¼Œä¾›æœåŠ¡å™¨ç«¯è¿›è¡Œé€‰æ‹©ã€‚
  - 5ã€æœåŠ¡å™¨ç«¯åœ¨å®¢æˆ·ç«¯æä¾›çš„åŠ å¯†æ–¹æ¡ˆä¸­é€‰æ‹©åŠ å¯†ç¨‹åº¦æœ€é«˜çš„åŠ å¯†æ–¹å¼ã€‚

- 6ã€æœåŠ¡å™¨å°†é€‰æ‹©å¥½çš„åŠ å¯†æ–¹æ¡ˆé€šè¿‡æ˜æ–‡æ–¹å¼è¿”å›ç»™å®¢æˆ·ç«¯ã€‚

- 7ã€å®¢æˆ·ç«¯æ¥æ”¶åˆ°æœåŠ¡ç«¯è¿”å›çš„åŠ å¯†æ–¹å¼åï¼Œä½¿ç”¨è¯¥åŠ å¯†æ–¹å¼ç”Ÿæˆäº§ç”Ÿéšæœºç ï¼Œç”¨ä½œé€šä¿¡è¿‡ç¨‹ä¸­å¯¹ç§°åŠ å¯†çš„å¯†é’¥ï¼Œä½¿ç”¨æœåŠ¡ç«¯è¿”å›çš„å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼Œå°†åŠ å¯†åçš„éšæœºç å‘é€è‡³æœåŠ¡å™¨ã€‚

- 8ã€æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯è¿”å›çš„åŠ å¯†ä¿¡æ¯åï¼Œä½¿ç”¨è‡ªå·±çš„ç§é’¥è¿›è¡Œè§£å¯†ï¼Œè·å–å¯¹ç§°åŠ å¯†å¯†é’¥ã€‚

  > **åœ¨æ¥ä¸‹æ¥çš„ä¼šè¯ä¸­ï¼ŒæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å°†ä¼šä½¿ç”¨è¯¥å¯†ç è¿›è¡Œå¯¹ç§°åŠ å¯†ï¼Œä¿è¯é€šä¿¡è¿‡ç¨‹ä¸­ä¿¡æ¯çš„å®‰å…¨**ã€‚

ğŸ¦… **2ï¼‰åŒå‘è®¤è¯çš„è¿‡ç¨‹ï¼Ÿ**

åŒå‘è®¤è¯å’Œå•å‘è®¤è¯åŸç†åŸºæœ¬å·®ä¸å¤šï¼Œåªæ˜¯é™¤äº†å®¢æˆ·ç«¯éœ€è¦è®¤è¯æœåŠ¡ç«¯ä»¥å¤–ï¼Œå¢åŠ äº†æœåŠ¡ç«¯å¯¹å®¢æˆ·ç«¯çš„è®¤è¯ï¼Œå…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š

[![åŒå‘è®¤è¯](http://static2.iocoder.cn/61ed2a8b189fc549a9c7407c2ebedb64)](http://static2.iocoder.cn/61ed2a8b189fc549a9c7407c2ebedb64)åŒå‘è®¤è¯

- 1ã€å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€ SSL åè®®ç‰ˆæœ¬å·ã€åŠ å¯†ç®—æ³•ç§ç±»ã€éšæœºæ•°ç­‰ä¿¡æ¯ã€‚

- 2ã€æœåŠ¡ç«¯ç»™å®¢æˆ·ç«¯è¿”å› SSL åè®®ç‰ˆæœ¬å·ã€åŠ å¯†ç®—æ³•ç§ç±»ã€éšæœºæ•°ç­‰ä¿¡æ¯ï¼ŒåŒæ—¶ä¹Ÿè¿”å›æœåŠ¡å™¨ç«¯çš„è¯ä¹¦ï¼Œå³å…¬é’¥è¯ä¹¦ã€‚

- 3ã€å®¢æˆ·ç«¯ä½¿ç”¨æœåŠ¡ç«¯è¿”å›çš„ä¿¡æ¯éªŒè¯æœåŠ¡å™¨çš„åˆæ³•æ€§ï¼ŒåŒ…æ‹¬ï¼š

  - è¯ä¹¦æ˜¯å¦è¿‡æœŸã€‚

  - å‘å‹æœåŠ¡å™¨è¯ä¹¦çš„ CA æ˜¯å¦å¯é ã€‚

  - è¿”å›çš„å…¬é’¥æ˜¯å¦èƒ½æ­£ç¡®è§£å¼€è¿”å›è¯ä¹¦ä¸­çš„æ•°å­—ç­¾åã€‚

  - æœåŠ¡å™¨è¯ä¹¦ä¸Šçš„åŸŸåæ˜¯å¦å’ŒæœåŠ¡å™¨çš„å®é™…åŸŸåç›¸åŒ¹é…

    > éªŒè¯é€šè¿‡åï¼Œå°†ç»§ç»­è¿›è¡Œé€šä¿¡ï¼›å¦åˆ™ï¼Œç»ˆæ­¢é€šä¿¡ã€‚

  - **ã€æ–°å¢ã€‘4ã€æœåŠ¡ç«¯è¦æ±‚å®¢æˆ·ç«¯å‘é€å®¢æˆ·ç«¯çš„è¯ä¹¦ï¼Œå®¢æˆ·ç«¯ä¼šå°†è‡ªå·±çš„è¯ä¹¦å‘é€è‡³æœåŠ¡ç«¯ã€‚**
  - **ã€æ–°å¢ã€‘5ã€éªŒè¯å®¢æˆ·ç«¯çš„è¯ä¹¦ï¼Œé€šè¿‡éªŒè¯åï¼Œä¼šè·å¾—å®¢æˆ·ç«¯çš„å…¬é’¥ã€‚**
  - 6ã€å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€è‡ªå·±æ‰€èƒ½æ”¯æŒçš„å¯¹ç§°åŠ å¯†æ–¹æ¡ˆï¼Œä¾›æœåŠ¡å™¨ç«¯è¿›è¡Œé€‰æ‹©ã€‚
  - 7ã€æœåŠ¡å™¨ç«¯åœ¨å®¢æˆ·ç«¯æä¾›çš„åŠ å¯†æ–¹æ¡ˆä¸­é€‰æ‹©åŠ å¯†ç¨‹åº¦æœ€é«˜çš„åŠ å¯†æ–¹å¼ã€‚

- 8ã€æœåŠ¡å™¨å°†é€‰æ‹©å¥½çš„åŠ å¯†æ–¹æ¡ˆé€šè¿‡æ˜æ–‡æ–¹å¼è¿”å›ç»™å®¢æˆ·ç«¯ã€‚

- 9ã€å®¢æˆ·ç«¯æ¥æ”¶åˆ°æœåŠ¡ç«¯è¿”å›çš„åŠ å¯†æ–¹å¼åï¼Œä½¿ç”¨è¯¥åŠ å¯†æ–¹å¼ç”Ÿæˆäº§ç”Ÿéšæœºç ï¼Œç”¨ä½œé€šä¿¡è¿‡ç¨‹ä¸­å¯¹ç§°åŠ å¯†çš„å¯†é’¥ï¼Œä½¿ç”¨æœåŠ¡ç«¯è¿”å›çš„å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼Œå°†åŠ å¯†åçš„éšæœºç å‘é€è‡³æœåŠ¡å™¨ã€‚

- 10ã€æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯è¿”å›çš„åŠ å¯†ä¿¡æ¯åï¼Œä½¿ç”¨è‡ªå·±çš„ç§é’¥è¿›è¡Œè§£å¯†ï¼Œè·å–å¯¹ç§°åŠ å¯†å¯†é’¥ã€‚

  > **åœ¨æ¥ä¸‹æ¥çš„ä¼šè¯ä¸­ï¼ŒæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å°†ä¼šä½¿ç”¨è¯¥å¯†ç è¿›è¡Œå¯¹ç§°åŠ å¯†ï¼Œä¿è¯é€šä¿¡è¿‡ç¨‹ä¸­ä¿¡æ¯çš„å®‰å…¨**ã€‚

ğŸ¦… **å¦‚ä½•é€‰æ‹©å•å‘è®¤è¯è¿˜æ˜¯åŒå‘è®¤è¯**

- ä¸€èˆ¬ä¸€ä¸ªç«™ç‚¹å¾ˆå¤šç”¨æˆ·è®¿é—®å°±ç”¨å•å‘è®¤è¯ã€‚

- ä¼ä¸šæ¥å£å¯¹æ¥å°±ç”¨åŒå‘è®¤è¯ã€‚

  > å¦‚æœæƒ³è¦æé«˜ APP çš„å®‰å…¨çº§åˆ«ï¼Œä¹Ÿå¯ä»¥è€ƒè™‘åŒå‘è®¤è¯ã€‚å› ä¸ºï¼ŒAPP å¤©ç„¶æ–¹ä¾¿æ”¾å…¥å®¢æˆ·ç«¯è¯ä¹¦ï¼Œä»è€Œæé«˜å®‰å…¨çº§åˆ«ã€‚

## ä¸ºä»€ä¹ˆæŠ“åŒ…å·¥å…·è¿˜èƒ½æŠ“åˆ° HTTPS æ•°æ®åŒ…å¹¶è§£å¯†æˆåŠŸå‘¢

ä¸æ˜¯è¯´HTTPSåœ¨ç½‘ç»œä¸­ä¼ è¾“çš„æ˜¯å¯†æ–‡å—ï¼Ÿè¿™ä¸ªé—®é¢˜å°±æ˜¯**ä¸­é—´è€…æ”»å‡»**ï¼ˆman in zhe middleï¼‰ã€‚

[![ä¸­é—´è€…æ”»å‡»åŸç†å›¾](http://static2.iocoder.cn/0332b5d6001f7446a04a5d54b9b93d7e)](http://static2.iocoder.cn/0332b5d6001f7446a04a5d54b9b93d7e)ä¸­é—´è€…æ”»å‡»åŸç†å›¾

- è§£å†³åŠæ³•ï¼Œå°±æ˜¯ HTTPS å•å‘éªŒè¯ã€‚åœ¨å®¢æˆ·ç«¯ä¸­å†…ç½®æœåŠ¡å™¨å…¬é’¥ï¼Œåœ¨ç¬¬ä¸‰æ­¥æœåŠ¡å™¨è¿”å›çš„å…¬é’¥ï¼Œé™¤äº†éªŒè¯å…¬é’¥çš„æœ‰æ•ˆæ€§ä¹‹å¤–ï¼Œå†æ¯”å¯¹å…¬é’¥æ˜¯ä¸æ˜¯å’Œå†…ç½®çš„å…¬é’¥ä¸€æ ·ï¼Œä¸ä¸€æ ·è¯´æ˜è¢«ä¸­é—´è€…æ”»å‡»äº†ï¼Œå°±æ–­å¼€é“¾æ¥ä¸åœ¨è¯·æ±‚äº†ã€‚
- è¿™ä¸ªåŸç†çš„å‰ææ˜¯æœåŠ¡å™¨çš„ç§é’¥æ²¡æœ‰æ³„éœ²ï¼Œå®¢æˆ·ç«¯çš„ä»£ç ä¸ä¼šè¢«ç ´è§£ï¼Œé“é«˜ä¸€å°ºé­”é«˜ä¸€ä¸ˆã€‚ä¿¡æ¯å®‰å…¨å°±æ˜¯åœ¨åˆç†çš„èŒƒå›´å†…ï¼Œé€‰æ‹©æ¯”è¾ƒåˆé€‚çš„åŠ å¯†æ–¹æ³•ï¼Œæ²¡æœ‰ç»å¯¹è®ºï¼Œåªæœ‰ç›¸å¯¹è®ºã€‚åœ¨æŸä¸ªèŒƒå›´å†…æ¯”è¾ƒå®‰å…¨ã€‚

## HTTPS æ¡æ‰‹ä¼šå½±å“æ€§èƒ½ä¹ˆï¼Ÿ

TCP æœ‰ä¸‰æ¬¡æ¡æ‰‹ï¼Œå†åŠ ä¸Š HTTPS çš„å››æ¬¡æ¡æ‰‹ï¼Œå½±å“è‚¯å®šæœ‰ï¼Œä½†æ˜¯å¯ä»¥æ¥å—ã€‚

- é¦–å…ˆï¼ŒHTTPS è‚¯å®šä¼šæ›´æ…¢ä¸€ç‚¹ï¼Œæ—¶é—´ä¸»è¦èŠ±è´¹åœ¨ä¸¤ç»„ SSL ä¹‹é—´çš„è€—æ—¶å’Œè¯ä¹¦çš„è¯»å–éªŒè¯ä¸Šï¼Œå¯¹ç§°ç®—æ³•çš„åŠ è§£å¯†æ—¶é—´å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚
- è€Œä¸”å¦‚æœä¸æ˜¯é¦–æ¬¡æ¡æ‰‹ï¼Œåç»­çš„è¯·æ±‚å¹¶ä¸éœ€è¦å®Œæ•´çš„æ¡æ‰‹è¿‡ç¨‹ã€‚å®¢æˆ·ç«¯å¯ä»¥æŠŠä¸Šæ¬¡çš„åŠ å¯†æƒ…å†µç›´æ¥å‘é€ç»™æœåŠ¡å™¨ä»è€Œå¿«é€Ÿæ¢å¤ï¼Œå…·ä½“ç»†èŠ‚å¯ä»¥å‚è€ƒ [ã€Šå›¾è§£ SSL/TLS åè®®ã€‹](http://www.ruanyifeng.com/blog/2014/09/illustration-ssl.html) ã€‚
- é™¤æ­¤ä»¥å¤–ï¼ŒSSL æ¡æ‰‹çš„æ—¶é—´å¹¶ä¸æ˜¯åªèƒ½ç”¨æ¥ä¼ é€’åŠ å¯†ä¿¡æ¯ï¼Œè¿˜å¯ä»¥æ‰¿æ‹…èµ·å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ²Ÿé€š HTTP2 å…¼å®¹æƒ…å†µçš„ä»»åŠ¡ã€‚å› æ­¤ä» HTTPS åˆ‡æ¢åˆ° HTTP2.0 ä¸ä¼šæœ‰ä»»ä½•æ€§èƒ½ä¸Šçš„å¼€é”€ï¼Œåå€’æ˜¯å¾—ç›Šäº HTTP2.0 çš„å¤šè·¯å¤ç”¨ç­‰æŠ€æœ¯ï¼Œåç»­å¯ä»¥èŠ‚çº¦å¤§é‡æ—¶é—´ã€‚
- å¦‚æœæŠŠ HTTPS2.0 å½“åšç›®æ ‡ï¼Œé‚£ä¹ˆ HTTPS çš„æ€§èƒ½æŸè€—å°±æ›´å°äº†ï¼Œè¿œè¿œæ¯”ä¸ä¸Šå®ƒå¸¦æ¥çš„å®‰å…¨æ€§æå‡ã€‚

# HTTP2

[![HTTP2 å’Œ HTTP1.1 çš„åŒºåˆ«](http://static2.iocoder.cn/482a127d8fd07940d8f255610c716792)](http://static2.iocoder.cn/482a127d8fd07940d8f255610c716792)HTTP2 å’Œ HTTP1.1 çš„åŒºåˆ«

## ä»€ä¹ˆæ˜¯ HTTP2.0 ï¼Ÿ

HTTP2.0 ï¼Œå¯ä»¥è¯´æ˜¯SPDYçš„å‡çº§ç‰ˆï¼ˆå…¶å®åŸæœ¬ä¹Ÿæ˜¯åŸºäºSPDYè®¾è®¡çš„ï¼‰ï¼Œä½†æ˜¯ï¼ŒHTTP2.0 è·Ÿ SPDY ä»æœ‰ä¸åŒçš„åœ°æ–¹ï¼Œå¦‚ä¸‹ï¼š

- HTTP2.0 æ”¯æŒæ˜æ–‡ HTTP ä¼ è¾“ï¼Œè€Œ SPDY å¼ºåˆ¶ä½¿ç”¨ HTTPS ã€‚
- HTTP2.0 æ¶ˆæ¯å¤´çš„å‹ç¼©ç®—æ³•é‡‡ç”¨ [HPACK](https://link.jianshu.com/?t=http://http2.github.io/http2-spec/compression.html)ï¼Œè€Œé SPDY é‡‡ç”¨çš„ [DEFLATE](https://link.jianshu.com/?t=http://zh.wikipedia.org/wiki/DEFLATE) ã€‚

## HTTP2.0 å’Œ HTTP1.X ç›¸æ¯”çš„æ–°ç‰¹æ€§ï¼Ÿ

- 1ã€æ–°çš„äºŒè¿›åˆ¶æ ¼å¼ï¼ˆBinary Formatï¼‰

  > HTTP1.x çš„è§£ææ˜¯åŸºäºæ–‡æœ¬ã€‚åŸºäºæ–‡æœ¬åè®®çš„æ ¼å¼è§£æå­˜åœ¨å¤©ç„¶ç¼ºé™·ï¼Œæ–‡æœ¬çš„è¡¨ç°å½¢å¼æœ‰å¤šæ ·æ€§ï¼Œè¦åšåˆ°å¥å£®æ€§è€ƒè™‘çš„åœºæ™¯å¿…ç„¶å¾ˆå¤šï¼ŒäºŒè¿›åˆ¶åˆ™ä¸åŒï¼Œåªè®¤ 0 å’Œ 1 çš„ç»„åˆã€‚åŸºäºè¿™ç§è€ƒè™‘ HTTP2.0 çš„åè®®è§£æå†³å®šé‡‡ç”¨äºŒè¿›åˆ¶æ ¼å¼ï¼Œå®ç°æ–¹ä¾¿ä¸”å¥å£®ã€‚

- åŒ SPDY å¯¹ HTTP1.1 çš„æ”¹è¿›ã€‚

  - 2ã€é™ä½å»¶è¿Ÿ
  - 3ã€å¤šè·¯å¤ç”¨ï¼ˆMultiPlexingï¼‰
  - 4ã€header å‹ç¼©
  - 5ã€æœåŠ¡ç«¯æ¨é€ï¼ˆserver pushï¼‰

## Nginx æ€ä¹ˆåš HTTP2.0 çš„å‡çº§æ”¹é€ ï¼Ÿ

- 1ã€è™½ç„¶ HTTP2.0 å…¶å®å¯ä»¥æ”¯æŒé HTTPS çš„ï¼Œä½†æ˜¯ç°åœ¨ä¸»æµçš„æµè§ˆå™¨åƒ Chromeï¼ŒFirefox è¡¨ç¤ºè¿˜æ˜¯åªæ”¯æŒåŸºäº TLS éƒ¨ç½²çš„ HTTP2.0åè®®ï¼Œæ‰€ä»¥è¦æƒ³å‡çº§æˆ HTTP2.0 è¿˜æ˜¯å…ˆå‡çº§ HTTPS ä¸ºå¥½ã€‚
- 2ã€å½“ä½ çš„ç½‘ç«™å·²ç»å‡çº§ HTTPS ä¹‹åï¼Œé‚£ä¹ˆå‡çº§ HTTP2.0 å°±ç®€å•å¾ˆå¤šï¼Œå¦‚æœä½ ä½¿ç”¨ NGINX ï¼Œåªè¦åœ¨é…ç½®æ–‡ä»¶ä¸­å¯åŠ¨ç›¸åº”çš„åè®®å°±å¯ä»¥äº†ï¼Œå¯ä»¥å‚è€ƒ [NGINXç™½çš®ä¹¦](https://link.jianshu.com/?t=https://www.nginx.com/wp-content/uploads/2015/09/NGINX_HTTP2_White_Paper_v4.pdf)ï¼Œ[NGINXé…ç½®HTTP2.0å®˜æ–¹æŒ‡å—](https://link.jianshu.com/?t=https://www.nginx.com/blog/nginx-1-9-5/) ã€‚
- 3ã€ä½¿ç”¨äº† HTTP2.0 é‚£ä¹ˆï¼ŒåŸæœ¬çš„ HTTP1.x æ€ä¹ˆåŠï¼Ÿè¿™ä¸ªé—®é¢˜å…¶å®ä¸ç”¨æ‹…å¿ƒï¼ŒHTTP2.0 å®Œå…¨å…¼å®¹ HTTP1.x çš„è¯­ä¹‰ï¼Œå¯¹äºä¸æ”¯æŒ HTTP2.0 çš„æµè§ˆå™¨ï¼ŒNGINX ä¼šè‡ªåŠ¨å‘ä¸‹å…¼å®¹çš„ã€‚

åœ¨æˆ‘ä»¬å†…éƒ¨çš„å¾®æœåŠ¡ API æ¥å£ï¼Œä¹Ÿå¯ä»¥åš HTTP2 çš„æ”¹é€ ï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹æ–‡ç« ï¼š

> è‰¿è‰¿ï¼šé€‰è¯»ï¼Œä½œä¸ºçŸ¥è¯†çš„æ‰©å……

- [ã€ŠSpring Cloud ä½¿ç”¨ HTTP2ã€‹](https://www.jianshu.com/p/ed3f8f983764)
- [ã€Šå†è¯´ SpringBoot2.0 ä¸ HTTP/2ã€‹](https://www.jianshu.com/p/7ddcdd3847d6)

## HTTP2.0 çš„å¤šè·¯å¤ç”¨å’Œ HTTP1.X ä¸­çš„é•¿è¿æ¥å¤ç”¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

- HTTP/1.0ï¼šä¸€æ¬¡è¯·æ±‚-å“åº”ï¼Œå»ºç«‹ä¸€ä¸ªè¿æ¥ï¼Œç”¨å®Œå…³é—­ï¼›æ¯ä¸€ä¸ªè¯·æ±‚éƒ½è¦å»ºç«‹ä¸€ä¸ªè¿æ¥ã€‚
- HTTP/1.1ï¼šPipeling è§£å†³æ–¹å¼ä¸ºï¼Œè‹¥å¹²ä¸ªè¯·æ±‚æ’é˜Ÿä¸²è¡ŒåŒ–å•çº¿ç¨‹å¤„ç†ï¼Œåé¢çš„è¯·æ±‚ç­‰å¾…å‰é¢è¯·æ±‚çš„è¿”å›æ‰èƒ½è·å¾—æ‰§è¡Œæœºä¼šã€‚ä¸€æ—¦æœ‰æŸè¯·æ±‚è¶…æ—¶ç­‰ï¼Œåç»­è¯·æ±‚åªèƒ½è¢«é˜»å¡ï¼Œæ¯«æ— åŠæ³•ï¼Œä¹Ÿå°±æ˜¯äººä»¬å¸¸è¯´çš„çº¿å¤´é˜»å¡ã€‚
- HTTP/2ï¼šå¤šä¸ªè¯·æ±‚å¯åŒæ—¶åœ¨ä¸€ä¸ªè¿æ¥ä¸Šå¹¶è¡Œæ‰§è¡Œã€‚æŸä¸ªè¯·æ±‚ä»»åŠ¡è€—æ—¶ä¸¥é‡ï¼Œä¸ä¼šå½±å“åˆ°å…¶å®ƒè¿æ¥çš„æ­£å¸¸æ‰§è¡Œã€‚

å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š[![HTTP/1.1 å¯¹æ¯” HTTP/2](http://static2.iocoder.cn/7268e2a2553c6612396b7de03667d348)](http://static2.iocoder.cn/7268e2a2553c6612396b7de03667d348)HTTP/1.1 å¯¹æ¯” HTTP/2

ğŸ¦… **HTTP2.0 å¤šè·¯å¤ç”¨æœ‰å¤šå¥½ï¼Ÿ**

> è‰¿è‰¿ï¼šæœ€è¿‘é‡æ–°çœ‹äº† TCP ï¼Œå‘ç°å†çœ‹è¿™ä¸ªé—®é¢˜ï¼ŒçœŸçš„æ˜¯æœ‰è¶£ï¼

HTTP æ€§èƒ½ä¼˜åŒ–çš„å…³é”®å¹¶ä¸åœ¨äºé«˜å¸¦å®½ï¼Œè€Œæ˜¯ä½å»¶è¿Ÿã€‚TCP è¿æ¥ä¼šéšç€æ—¶é—´è¿›è¡Œè‡ªæˆ‘ã€Œè°ƒè°ã€ï¼Œèµ·åˆä¼šé™åˆ¶è¿æ¥çš„æœ€å¤§é€Ÿåº¦ï¼Œå¦‚æœæ•°æ®æˆåŠŸä¼ è¾“ï¼Œä¼šéšç€æ—¶é—´çš„æ¨ç§»æé«˜ä¼ è¾“çš„é€Ÿåº¦ã€‚è¿™ç§è°ƒè°åˆ™è¢«ç§°ä¸º TCP æ…¢å¯åŠ¨ã€‚ç”±äºè¿™ç§åŸå› ï¼Œè®©åŸæœ¬å°±å…·æœ‰çªå‘æ€§å’ŒçŸ­æ—¶æ€§çš„ HTTP è¿æ¥å˜çš„ååˆ†ä½æ•ˆã€‚

HTTP/2 é€šè¿‡è®©æ‰€æœ‰æ•°æ®æµå…±ç”¨åŒä¸€ä¸ªè¿æ¥ï¼Œå¯ä»¥æ›´æœ‰æ•ˆåœ°ä½¿ç”¨ TCP è¿æ¥ï¼Œè®©é«˜å¸¦å®½ä¹Ÿèƒ½çœŸæ­£çš„æœåŠ¡äº HTTP çš„æ€§èƒ½æå‡ã€‚

## æœåŠ¡å™¨æ¨é€åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ

æœåŠ¡ç«¯æ¨é€èƒ½æŠŠå®¢æˆ·ç«¯æ‰€éœ€è¦çš„èµ„æºä¼´éšç€ `index.html` ä¸€èµ·å‘é€åˆ°å®¢æˆ·ç«¯ï¼Œçœå»äº†å®¢æˆ·ç«¯é‡å¤è¯·æ±‚çš„æ­¥éª¤ã€‚æ­£å› ä¸ºæ²¡æœ‰å‘èµ·è¯·æ±‚ï¼Œå»ºç«‹è¿æ¥ç­‰æ“ä½œï¼Œæ‰€ä»¥é™æ€èµ„æºé€šè¿‡æœåŠ¡ç«¯æ¨é€çš„æ–¹å¼å¯ä»¥æå¤§åœ°æå‡é€Ÿåº¦ã€‚å…·ä½“å¦‚ä¸‹ï¼š

- æ™®é€šçš„å®¢æˆ·ç«¯è¯·æ±‚è¿‡ç¨‹ï¼š[![æ™®é€šçš„å®¢æˆ·ç«¯è¯·æ±‚è¿‡ç¨‹](http://static2.iocoder.cn/9eecd5ec56714731d0e38c6ef9c468d1)](http://static2.iocoder.cn/9eecd5ec56714731d0e38c6ef9c468d1)æ™®é€šçš„å®¢æˆ·ç«¯è¯·æ±‚è¿‡ç¨‹
- æœåŠ¡ç«¯æ¨é€çš„è¿‡ç¨‹ï¼š[![æœåŠ¡ç«¯æ¨é€çš„è¿‡ç¨‹](http://static2.iocoder.cn/c30ec0b3743d1f9751d3ba511f94578b)](http://static2.iocoder.cn/c30ec0b3743d1f9751d3ba511f94578b)æœåŠ¡ç«¯æ¨é€çš„è¿‡ç¨‹

## ä¸ºä»€ä¹ˆéœ€è¦å¤´éƒ¨(header)å‹ç¼©ï¼Ÿ

å‡å®šä¸€ä¸ªé¡µé¢æœ‰ 100 ä¸ªèµ„æºéœ€è¦åŠ è½½ï¼ˆè¿™ä¸ªæ•°é‡å¯¹äºä»Šå¤©çš„ Web è€Œè¨€è¿˜æ˜¯æŒºä¿å®ˆçš„ï¼‰ï¼Œè€Œæ¯ä¸€æ¬¡è¯·æ±‚éƒ½æœ‰ 1kb çš„æ¶ˆæ¯å¤´ï¼ˆè¿™åŒæ ·ä¹Ÿå¹¶ä¸å°‘è§ï¼Œå› ä¸º Cookie å’Œå¼•ç”¨ç­‰ä¸œè¥¿çš„å­˜åœ¨ï¼‰ï¼Œåˆ™è‡³å°‘éœ€è¦å¤šæ¶ˆè€— 100kb æ¥è·å–è¿™äº›æ¶ˆæ¯å¤´ã€‚HTTP2.0 å¯ä»¥ç»´æŠ¤ä¸€ä¸ªå­—å…¸ï¼Œå·®é‡æ›´æ–° HTTP å¤´éƒ¨ï¼Œå¤§å¤§é™ä½å› å¤´éƒ¨ä¼ è¾“äº§ç”Ÿçš„æµé‡ã€‚

å…·ä½“å‚è€ƒï¼š[ã€ŠHTTP/2 å¤´éƒ¨å‹ç¼©æŠ€æœ¯ä»‹ç»ã€‹](https://link.jianshu.com/?t=https://imququ.com/post/header-compression-in-http2.html) æ–‡ç« ã€‚

- ç»´æŠ¤ä¸€ä»½ç›¸åŒçš„é™æ€å­—å…¸ï¼ˆStatic Tableï¼‰ï¼ŒåŒ…å«å¸¸è§çš„å¤´éƒ¨åç§°ï¼Œä»¥åŠç‰¹åˆ«å¸¸è§çš„å¤´éƒ¨åç§°ä¸å€¼çš„ç»„åˆã€‚
- ç»´æŠ¤ä¸€ä»½ç›¸åŒçš„åŠ¨æ€å­—å…¸ï¼ˆDynamic Tableï¼‰ï¼Œå¯ä»¥åŠ¨æ€åœ°æ·»åŠ å†…å®¹ã€‚
- æ”¯æŒåŸºäºé™æ€å“ˆå¤«æ›¼ç è¡¨çš„å“ˆå¤«æ›¼ç¼–ç ï¼ˆHuffman Codingï¼‰ã€‚

# å½©è›‹

æ„Ÿè§‰ï¼Œå¤§å­¦ä¸¢æ‰çš„ç½‘ç»œçŸ¥è¯†ï¼Œåˆä¸€æ¬¡å›åˆ°æˆ‘çš„è„‘å­ä¸­äº†ã€‚å¥½å¼€å¿ƒï¼Œåˆå¯ä»¥é—å¿˜ä¸€è½®å•¦ï¼Œå“ˆå“ˆå“ˆå“ˆã€‚

å‚è€ƒä¸æ¨èå¦‚ä¸‹æ–‡ç« ï¼š

- [ã€ŠHttps å•å‘è®¤è¯å’ŒåŒå‘è®¤è¯ã€‹](https://blog.csdn.net/duanbokan/article/details/50847612)
- [ã€Šã€ç½‘ç»œåè®®ã€‘ping çš„å·¥ä½œåŸç†ã€‹](https://blog.csdn.net/Maybe_ch/article/details/82598782)
- [ã€ŠHTTP1.0ã€HTTP1.1 å’Œ HTTP2.0 çš„åŒºåˆ«ã€‹](https://www.jianshu.com/p/be29d679cbff)
- [ã€Šè®¡ç®—æœºç½‘ç»œå¸¸è§é¢è¯•é¢˜ã€‹](https://segmentfault.com/a/1190000010819141)
- [ã€Šæ€»ç»“çš„ç½‘ç»œé¢è¯•é¢˜ã€‹](https://www.jianshu.com/p/a1f5daf7ada5)
- [ã€Šé¢è¯•/ç¬”è¯•ç¬¬ä¸€å¼¹ â€”â€” è®¡ç®—æœºç½‘ç»œé¢è¯•é—®é¢˜é›†é”¦ã€‹](https://blog.csdn.net/justloveyou_/article/details/78303617)
- [ã€Šé€šä¿—å¤§ç™½è¯æ¥ç†è§£ TCP åè®®çš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹ã€‹](https://github.com/jawil/blog/issues/14)
- [ã€ŠTCP æ•°æ®çš„ä¼ è¾“è¿‡ç¨‹ã€‹](https://www.jianshu.com/p/b71ec62b6eb5)
- [ã€Šæå®šè®¡ç®—æœºç½‘ç»œé¢è¯•ï¼Œçœ‹è¿™ç¯‡å°±å¤Ÿäº†ï¼ˆè¡¥å……ç‰ˆï¼‰ã€‹](https://juejin.im/post/5b7be0b2e51d4538db34a51e)

**æ–‡ç« ç›®å½•**

1. ç½‘ç»œä½“ç³»ç»“æ„
   1. [ç®€è¿° OSI ä¸ƒå±‚ä½“ç³»ç»“æ„](http://svip.iocoder.cn/Net/Interview/#ç®€è¿°-OSI-ä¸ƒå±‚ä½“ç³»ç»“æ„)
   2. [ç®€è¿° TCP/IP å››å±‚ä½“ç³»ç»“æ„](http://svip.iocoder.cn/Net/Interview/#ç®€è¿°-TCP-IP-å››å±‚ä½“ç³»ç»“æ„)
   3. [çŸ¥é“å„ä¸ªå±‚ä½¿ç”¨çš„æ˜¯å“ªä¸ªæ•°æ®äº¤æ¢è®¾å¤‡ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#çŸ¥é“å„ä¸ªå±‚ä½¿ç”¨çš„æ˜¯å“ªä¸ªæ•°æ®äº¤æ¢è®¾å¤‡ï¼Ÿ)
2. IP
   1. [IP åœ°å€çš„åˆ†ç±»ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#IP-åœ°å€çš„åˆ†ç±»ï¼Ÿ)
   2. [ç½‘ç»œå±‚çš„ ARP åè®®å·¥ä½œåŸç†ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#ç½‘ç»œå±‚çš„-ARP-åè®®å·¥ä½œåŸç†ï¼Ÿ)
   3. [å¦‚ä½•åˆ’åˆ†å­ç½‘ã€è¶…ç½‘ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#å¦‚ä½•åˆ’åˆ†å­ç½‘ã€è¶…ç½‘ï¼Ÿ)
   4. [ä»€ä¹ˆæ˜¯å•æ’­ã€ç»„æ’­(å¤šæ’­)ã€å¹¿æ’­ã€ä»»æ’­ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#ä»€ä¹ˆæ˜¯å•æ’­ã€ç»„æ’­-å¤šæ’­-ã€å¹¿æ’­ã€ä»»æ’­ï¼Ÿ)
   5. [åŒºåˆ« IPv4 å’Œ IPv6 ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#åŒºåˆ«-IPv4-å’Œ-IPv6-ï¼Ÿ)
3. ICMP
   1. [ICMP åè®®çš„ä¸»è¦åŠŸèƒ½ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#ICMP-åè®®çš„ä¸»è¦åŠŸèƒ½ï¼Ÿ)
   2. [ç®€è¿°ä¸€ä¸‹ ping çš„åŸç†ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#ç®€è¿°ä¸€ä¸‹-ping-çš„åŸç†ï¼Ÿ)
   3. [ä»€ä¹ˆæ˜¯ Traceroute ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#ä»€ä¹ˆæ˜¯-Traceroute-ï¼Ÿ)
4. TCP
   1. [TCP æ˜¯ä»€ä¹ˆï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#TCP-æ˜¯ä»€ä¹ˆï¼Ÿ)
   2. [TCP å¯¹åº”çš„åº”ç”¨å±‚åè®®ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#TCP-å¯¹åº”çš„åº”ç”¨å±‚åè®®ï¼Ÿ)
   3. [TCP å¤´éƒ¨æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#TCP-å¤´éƒ¨æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ)
   4. [ã€é‡è¦ã€‘ä»€ä¹ˆæ˜¯ TCP ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#ã€é‡è¦ã€‘ä»€ä¹ˆæ˜¯-TCP-ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ)
   5. [ã€é‡è¦ã€‘ä»€ä¹ˆæ˜¯ TCP å››æ¬¡æŒ¥æ‰‹ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#ã€é‡è¦ã€‘ä»€ä¹ˆæ˜¯-TCP-å››æ¬¡æŒ¥æ‰‹ï¼Ÿ)
   6. [ã€é‡è¦ã€‘TCP æ•°æ®å¦‚ä½•ä¼ è¾“ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#ã€é‡è¦ã€‘TCP-æ•°æ®å¦‚ä½•ä¼ è¾“ï¼Ÿ)
   7. [ã€é‡è¦ã€‘ä»€ä¹ˆæ˜¯ TCP æ»‘åŠ¨çª—å£ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#ã€é‡è¦ã€‘ä»€ä¹ˆæ˜¯-TCP-æ»‘åŠ¨çª—å£ï¼Ÿ)
   8. [TCP åè®®å¦‚ä½•æ¥ä¿è¯ä¼ è¾“çš„å¯é æ€§ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#TCP-åè®®å¦‚ä½•æ¥ä¿è¯ä¼ è¾“çš„å¯é æ€§ï¼Ÿ)
   9. [ä»€ä¹ˆæ˜¯ TCP æ‹¥å µï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#ä»€ä¹ˆæ˜¯-TCP-æ‹¥å µï¼Ÿ)
5. UDP
   1. [UDP æ˜¯ä»€ä¹ˆï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#UDP-æ˜¯ä»€ä¹ˆï¼Ÿ)
   2. [UDP å¯¹åº”çš„åº”ç”¨å±‚åè®®ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#UDP-å¯¹åº”çš„åº”ç”¨å±‚åè®®ï¼Ÿ)
   3. [ã€é‡è¦ã€‘TCP ä¸ UDP çš„åŒºåˆ«](http://svip.iocoder.cn/Net/Interview/#ã€é‡è¦ã€‘TCP-ä¸-UDP-çš„åŒºåˆ«)
   4. [UDP æŠ¥æ–‡çš„æ ¼å¼](http://svip.iocoder.cn/Net/Interview/#UDP-æŠ¥æ–‡çš„æ ¼å¼)
6. DNS
   1. [DNS æ˜¯ä»€ä¹ˆï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#DNS-æ˜¯ä»€ä¹ˆï¼Ÿ)
   2. [ä¸»æœºè§£æåŸŸåçš„é¡ºåºï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#ä¸»æœºè§£æåŸŸåçš„é¡ºåºï¼Ÿ)
   3. [DNS ä½¿ç”¨ä»€ä¹ˆåè®®ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#DNS-ä½¿ç”¨ä»€ä¹ˆåè®®ï¼Ÿ)
7. HTTP
   1. [HTTP æ˜¯ä»€ä¹ˆï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#HTTP-æ˜¯ä»€ä¹ˆï¼Ÿ)
   2. [HTTP åŸºæœ¬æ ¼å¼](http://svip.iocoder.cn/Net/Interview/#HTTP-åŸºæœ¬æ ¼å¼)
   3. [HTTP åè®®åŒ…æ‹¬å“ªäº›è¯·æ±‚ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#HTTP-åè®®åŒ…æ‹¬å“ªäº›è¯·æ±‚ï¼Ÿ)
   4. [HTTP æœ‰å“ªäº›çŠ¶æ€ç ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#HTTP-æœ‰å“ªäº›çŠ¶æ€ç ï¼Ÿ)
   5. [HTTPã€TCPã€Socket çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#HTTPã€TCPã€Socket-çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ)
   6. [Cookies å’Œ Session çš„åŒºåˆ«](http://svip.iocoder.cn/Net/Interview/#Cookies-å’Œ-Session-çš„åŒºåˆ«)
   7. [ã€é‡è¦ã€‘ä¸€æ¬¡å®Œæ•´çš„ HTTP è¯·æ±‚æ‰€ç»å†çš„æ­¥éª¤](http://svip.iocoder.cn/Net/Interview/#ã€é‡è¦ã€‘ä¸€æ¬¡å®Œæ•´çš„-HTTP-è¯·æ±‚æ‰€ç»å†çš„æ­¥éª¤)
   8. [HTTP1.0 å’Œ HTTP1.1 æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#HTTP1-0-å’Œ-HTTP1-1-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ)
   9. [SPDY æ˜¯ä»€ä¹ˆï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#SPDY-æ˜¯ä»€ä¹ˆï¼Ÿ)
8. HTTPS
   1. [HTTPS æ˜¯ä»€ä¹ˆï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#HTTPS-æ˜¯ä»€ä¹ˆï¼Ÿ)
   2. [HTTP å’Œ HTTPS çš„åŒºåˆ«ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#HTTP-å’Œ-HTTPS-çš„åŒºåˆ«ï¼Ÿ)
   3. [SSL åŠ å¯†æ–¹å¼æ˜¯ä»€ä¹ˆï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#SSL-åŠ å¯†æ–¹å¼æ˜¯ä»€ä¹ˆï¼Ÿ)
   4. [ä»€ä¹ˆæ˜¯å•å‘è®¤è¯ã€åŒå‘è®¤è¯ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#ä»€ä¹ˆæ˜¯å•å‘è®¤è¯ã€åŒå‘è®¤è¯ï¼Ÿ)
   5. [ä¸ºä»€ä¹ˆæŠ“åŒ…å·¥å…·è¿˜èƒ½æŠ“åˆ° HTTPS æ•°æ®åŒ…å¹¶è§£å¯†æˆåŠŸå‘¢](http://svip.iocoder.cn/Net/Interview/#ä¸ºä»€ä¹ˆæŠ“åŒ…å·¥å…·è¿˜èƒ½æŠ“åˆ°-HTTPS-æ•°æ®åŒ…å¹¶è§£å¯†æˆåŠŸå‘¢)
   6. [HTTPS æ¡æ‰‹ä¼šå½±å“æ€§èƒ½ä¹ˆï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#HTTPS-æ¡æ‰‹ä¼šå½±å“æ€§èƒ½ä¹ˆï¼Ÿ)
9. HTTP2
   1. [ä»€ä¹ˆæ˜¯ HTTP2.0 ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#ä»€ä¹ˆæ˜¯-HTTP2-0-ï¼Ÿ)
   2. [HTTP2.0 å’Œ HTTP1.X ç›¸æ¯”çš„æ–°ç‰¹æ€§ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#HTTP2-0-å’Œ-HTTP1-X-ç›¸æ¯”çš„æ–°ç‰¹æ€§ï¼Ÿ)
   3. [Nginx æ€ä¹ˆåš HTTP2.0 çš„å‡çº§æ”¹é€ ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#Nginx-æ€ä¹ˆåš-HTTP2-0-çš„å‡çº§æ”¹é€ ï¼Ÿ)
   4. [HTTP2.0 çš„å¤šè·¯å¤ç”¨å’Œ HTTP1.X ä¸­çš„é•¿è¿æ¥å¤ç”¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#HTTP2-0-çš„å¤šè·¯å¤ç”¨å’Œ-HTTP1-X-ä¸­çš„é•¿è¿æ¥å¤ç”¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ)
   5. [æœåŠ¡å™¨æ¨é€åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#æœåŠ¡å™¨æ¨é€åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ)
   6. [ä¸ºä»€ä¹ˆéœ€è¦å¤´éƒ¨(header)å‹ç¼©ï¼Ÿ](http://svip.iocoder.cn/Net/Interview/#ä¸ºä»€ä¹ˆéœ€è¦å¤´éƒ¨-header-å‹ç¼©ï¼Ÿ)
10. [å½©è›‹](http://svip.iocoder.cn/Net/Interview/#å½©è›‹)

Â© 2014 - 2020 èŠ‹é“æºç  | 

æ€»è®¿å®¢æ•° 800142 æ¬¡ && æ€»è®¿é—®é‡ 3927608 æ¬¡

[å›åˆ°é¦–é¡µ](http://svip.iocoder.cn/index)