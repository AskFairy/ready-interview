## Java的类加载机制

### 什么是类的加载

Java天生可以**动态扩展**的语言特性就是依赖**运行期动态加载和动态连接**这个特点实现的

类的加载指的是将类的**.class文件中的二进制数据读入到内存**中，将其放在**运行时数据区**的方法区内，然后在**堆**区创建一个`java.lang.Class`对象，用来封装类在方法区内的数据结构。并最终形成可以被虚拟机**直接使用的Java类型**。

![img](http://favorites.ren/assets/images/2017/jvm/jvm-1.png)

- JVM规范允许类加载器**预加载**

### 类的生命周期

<img src="https://gitee.com//chenchong0817/picture/raw/master/Aaron/20201002191949.png" alt="image-20201002191947495" style="zoom:50%;" />

- 加载、验证、准备、初始化和卸载这五个阶段的**开始**顺序是确定的
- **解析阶段则不一定**：它在**某些情况下可以在初始化阶段之后再开始**， 这是为了支持Java语言的**运行时绑定特性**（也称为动态绑定或晚期绑定）。

1. 加载：
   1. 通过一个**类的全限定名**来**获取定义此类的二进制字节流**。 
   2. 将这个字节流所代表的**静态存储结构转化为方法区的运行时数据结构**。 
   3. 在**堆**中生成一个代表这个类的`java.lang.Class`对象，**作为方法区这个类的各种数据的访问入口**。 